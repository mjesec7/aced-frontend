import{_ as Y,c as l,a as r,t as u,e as p,f as m,n as d,F as q,h as Z,j as K,W,i as G,B as f,C as J,o as Q,l as X,q as $,U as ee,s as c}from"./index-DO_Kfwe8.js";const te={name:"TopicOverview",data(){return{topic:null,lessons:[],userProgress:[],loading:!0,lessonsLoading:!1,progressLoading:!1,userPlan:"free",filter:"all",error:null,retryCount:0,showDebugInfo:!1,debugInfo:null,lastApiResponse:null,componentKey:0,lastUpdateTime:Date.now(),eventCleanupFunctions:[],globalEventHandlers:{},statusChangeTimeout:null,lastStatusSync:Date.now(),statusSyncInterval:null,userStatusOverride:null,paymentCheckInterval:null,lastPaymentCheck:Date.now(),storeUnsubscribe:null}},computed:{filteredLessons(){return this.filter==="all"?this.lessons:this.filter==="completed"?this.lessons.filter(e=>{var t;return(t=e.progress)==null?void 0:t.completed}):this.lessons.filter(e=>e.type===this.filter)},freeCount(){return this.lessons.filter(e=>e.type!=="premium").length},premiumCount(){return this.lessons.filter(e=>e.type==="premium").length},completedCount(){return this.lessons.filter(e=>{var t;return(t=e.progress)==null?void 0:t.completed}).length},overallProgress(){return this.lessons.length?this.lessons.reduce((t,s)=>{var i;return t+(((i=s.progress)==null?void 0:i.progressPercent)||0)},0)/this.lessons.length:0},currentUser(){return f.currentUser},isDevelopment(){return!1},enhancedUserPlan(){var a,o,h,g;const e=(o=(a=this.$store)==null?void 0:a.getters)==null?void 0:o["user/userStatus"],t=localStorage.getItem("userStatus"),s=this.userPlan,i=this.userStatusOverride;return(g=(h=this.$store)==null?void 0:h.getters)==null||g["user/forceUpdateCounter"],this.lastUpdateTime,this.lastStatusSync,i||e||t||s||"free"},isPremiumUser(){const e=this.enhancedUserPlan;return["premium","start","pro"].includes(e)},reactiveAvailableCount(){return this.lessons.filter(e=>e&&(e.type!=="premium"||this.isPremiumUser)).length},userStatusLabel(){const e=this.enhancedUserPlan;return{pro:"Pro",start:"Pro",premium:"Pro",free:"Free"}[e]||"Free"}},watch:{enhancedUserPlan:{handler(e,t){e!==t&&this.triggerReactivityUpdate()},immediate:!0},'$store.getters["user/userStatus"]':{handler(e,t){e!==t&&(this.userPlan=e||"free",this.triggerReactivityUpdate())},immediate:!0},currentUser:{handler(e,t){e&&e!==t?this.loadUserProgressForLessons():!e&&t&&this.clearUserProgress()},immediate:!0}},async mounted(){try{await this.initializeComponent(),this.setupEventListeners(),this.setupPeriodicChecks()}catch{this.loading=!1}},methods:{navigateToProfile(){try{this.$router.push({name:"CataloguePage"})}catch{this.$router.push("/profile/catalogue")}},async initializeComponent(){try{this.loading=!0,this.error=null,this.retryCount=0,this.topic=null,this.lessons=[],await this.waitForAuth(),await this.loadUserPlan(),await this.loadTopicData(),this.currentUser&&this.lessons.length>0&&await this.loadUserProgressForLessons()}catch(e){this.error=this.handleError(e,"component initialization"),this.loading=!1,this.topic=null,this.lessons=[],this.isDevelopment&&(this.debugInfo={error:e.message,stack:e.stack,routeParams:this.$route.params,timestamp:new Date().toISOString()})}finally{this.loading=!1}},async loadUserProgressForLessons(){if(!(!this.currentUser||!this.lessons.length))try{this.progressLoading=!0;const e=this.currentUser.uid;try{const i=await $(e);if(i.success&&Array.isArray(i.data)){this.mapProgressToLessons(i.data);return}}catch{}const t=this.lessons.map(async i=>{try{const n=await ee(e,i._id||i.id);return{lessonId:i._id||i.id,progress:n.success?n.data:null}}catch{return{lessonId:i._id||i.id,progress:null}}});(await Promise.all(t)).forEach(({lessonId:i,progress:n})=>{const a=this.lessons.find(o=>(o._id||o.id)===i);a&&n&&(a.progress=this.normalizeProgressData(n))})}catch{}finally{this.progressLoading=!1}},mapProgressToLessons(e){Array.isArray(e)&&this.lessons.forEach(t=>{const s=t._id||t.id,i=e.find(n=>n.lessonId===s||n.lesson&&(n.lesson._id===s||n.lesson.id===s));i&&(t.progress=this.normalizeProgressData(i))})},normalizeProgressData(e){return e?{progressPercent:e.progressPercent||e.progress||0,completed:e.completed||!1,stars:e.stars||0,duration:e.duration||e.durationSeconds||0,mistakes:e.mistakes||0,points:e.points||0,lastAccessed:e.lastAccessed||e.updatedAt,completedSteps:e.completedSteps||[],_raw:this.isDevelopment?e:void 0}:null},clearUserProgress(){this.lessons.forEach(e=>{e.progress&&delete e.progress})},formatDuration(e){if(!e||e<60)return`${e||0}s`;const t=Math.floor(e/60),s=e%60;return s===0?`${t}m`:`${t}m ${s}s`},triggerReactivityUpdate(){this.lastUpdateTime=Date.now(),this.componentKey++},setupEventListeners(){typeof window<"u"&&(this.globalEventHandlers.subscriptionChange=e=>{this.userPlan=e.detail.newPlan||"free",this.triggerReactivityUpdate()},window.addEventListener("userSubscriptionChanged",this.globalEventHandlers.subscriptionChange),this.globalEventHandlers.storageChange=e=>{e.key==="userStatus"&&e.newValue!==this.userPlan&&(this.userPlan=e.newValue||"free",this.triggerReactivityUpdate())},window.addEventListener("storage",this.globalEventHandlers.storageChange))},setupPeriodicChecks(){this.paymentCheckInterval=setInterval(()=>{this.checkPaymentStatus()},3e4),this.statusSyncInterval=setInterval(()=>{this.loadUserPlan()},12e4)},async waitForAuth(){if(!f.currentUser)return new Promise(e=>{const t=f.onAuthStateChanged(s=>{t(),e()});setTimeout(()=>{t(),e()},3e3)})},async loadTopicData(){const e=this.$route.params.id;if(!e){this.error="Topic ID not specified in URL",this.loading=!1;return}try{this.loading=!0,this.error=null;const t=await X(e);this.lastApiResponse=t;let s=null,i="unknown";if(t){if(t.success===!0&&t.data)s=t.data,i="success_wrapper";else if(t.exists===!0&&t.data)s=t.data,i="exists_wrapper";else if(t._id||t.id||t.name||t.topicName)s=t,i="direct_object";else if(t.data&&(t.data._id||t.data.id||t.data.name||t.data.topicName))s=t.data,i="nested_data";else if(t.success===!1||t.error){const n=t.message||t.error||"API returned an error for topic data.";throw new Error(`API Error: ${n}`)}}if(!s||!s._id&&!s.id)throw this.isDevelopment&&(this.debugInfo={message:"No valid topic data found in response",response:t,topicId:e,responseFormat:i,timestamp:new Date().toISOString()}),new Error("Invalid topic data received from server. Please try again.");this.topic=this.normalizeTopicData(s),await this.loadLessonsForTopic(this.topic._id||this.topic.id)}catch(t){this.error=this.handleError(t,"loading topic"),this.topic=null,this.lessons=[],this.isDevelopment&&(this.debugInfo={error:t.message,response:this.lastApiResponse,topicId:e,stack:t.stack,timestamp:new Date().toISOString()})}finally{this.loading=!1}},async loadLessonsForTopic(e){if(!e){this.lessons=[];return}try{this.lessonsLoading=!0;const t=await Q(e);let s=[],i="unknown";t&&(t.success===!0&&Array.isArray(t.data)?(s=t.data,i="success_data_array"):t.success===!0&&Array.isArray(t.lessons)?(s=t.lessons,i="success_lessons_array"):Array.isArray(t.data)?(s=t.data,i="nested_data_array"):Array.isArray(t.lessons)?(s=t.lessons,i="nested_lessons_array"):Array.isArray(t)?(s=t,i="direct_array"):t.success===!1&&(s=[],i="error_response")),this.lessons=s.map((n,a)=>this.normalizeLessonData(n,e,a)).filter(n=>n!==null)}catch(t){this.lessons=[],this.isDevelopment&&(this.debugInfo={...this.debugInfo,lessonLoadError:t.message,lessonLoadStack:t.stack,lessonsApiResponse:this.lastApiResponse})}finally{this.lessonsLoading=!1}},normalizeTopicData(e){var s;if(!e)return null;const t={_id:e._id||e.id,id:e.id||e._id,name:this.extractName(e),topicName:this.extractName(e),description:this.extractDescription(e),topicDescription:this.extractDescription(e),subject:e.subject||"General",level:e.level||1,type:e.type||"free",createdAt:e.createdAt,updatedAt:e.updatedAt,metadata:e.metadata||{},isActive:e.isActive!==void 0?e.isActive:!0,isDraft:e.isDraft||!1,_raw:this.isDevelopment?e:void 0};return!t._id&&!t.id?null:((!t.name||t.name==="Untitled")&&(t.name=`Topic ${((s=t._id)==null?void 0:s.substring(0,8))||""}`),t)},normalizeLessonData(e,t,s){var n;if(!e)return null;const i={_id:e._id||e.id||`lesson_fallback_${t}_${s}`,id:e.id||e._id||`lesson_fallback_${t}_${s}`,lessonName:this.extractLessonName(e),title:this.extractLessonName(e),name:this.extractLessonName(e),description:this.extractLessonDescription(e),desc:this.extractLessonDescription(e),type:e.type||"free",topicId:e.topicId||t,topic:e.topic||((n=this.topic)==null?void 0:n.name)||"Unknown Topic",steps:Array.isArray(e.steps)?e.steps:[],metadata:e.metadata||{estimatedDuration:30},homework:e.homework||{totalExercises:0},isActive:e.isActive!==void 0?e.isActive:!0,isDraft:e.isDraft||!1,progress:null,_raw:this.isDevelopment?e:void 0};return(!i.lessonName||i.lessonName==="Untitled")&&(i.lessonName=`Lesson ${s+1} (${i._id.substring(0,8)})`),i},async loadUserPlan(){var e,t,s;try{const i=(t=(e=this.$store)==null?void 0:e.getters)==null?void 0:t["user/userStatus"];if(i&&["premium","start","pro","free"].includes(i)){this.userPlan=i;return}const n=localStorage.getItem("userStatus");if(n&&["premium","start","pro","free"].includes(n)){this.userPlan=n,i||this.$store.commit("user/SET_USER_STATUS",n);return}if(f.currentUser){const a=f.currentUser.uid;try{const o=await J(a);if(o&&o.success){const h=o.status||((s=o.data)==null?void 0:s.subscriptionPlan)||"free";this.userPlan=h,localStorage.setItem("userStatus",h),this.$store.commit("user/SET_USER_STATUS",h);return}}catch{}}this.userPlan="free",localStorage.setItem("userStatus","free"),this.$store.commit("user/SET_USER_STATUS","free")}catch{this.userPlan="free"}},extractName(e){if(!e)return"Untitled";if(typeof e.name=="string"&&e.name.trim())return e.name.trim();if(typeof e.name=="object"&&e.name!==null){const s=e.name[this.lang]||e.name.en||e.name.ru||e.name.uz;if(s&&typeof s=="string"&&s.trim())return s.trim();const i=Object.values(e.name);for(const n of i)if(n&&typeof n=="string"&&n.trim())return n.trim()}const t=["topicName","title","displayName","topic"];for(const s of t){if(typeof e[s]=="string"&&e[s].trim())return e[s].trim();if(typeof e[s]=="object"&&e[s]!==null){const i=e[s][this.lang]||e[s].en||e[s].ru||e[s].uz;if(i&&typeof i=="string"&&i.trim())return i.trim()}}return"Untitled"},extractDescription(e){if(!e)return"No description";if(typeof e.description=="string"&&e.description.trim())return e.description.trim();if(typeof e.description=="object"&&e.description!==null){const s=e.description[this.lang]||e.description.en||e.description.ru||e.description.uz;if(s&&typeof s=="string"&&s.trim())return s.trim();const i=Object.values(e.description);for(const n of i)if(n&&typeof n=="string"&&n.trim())return n.trim()}const t=["topicDescription","desc","summary","info"];for(const s of t){if(typeof e[s]=="string"&&e[s].trim())return e[s].trim();if(typeof e[s]=="object"&&e[s]!==null){const i=e[s][this.lang]||e[s].en||e[s].ru||e[s].uz;if(i&&typeof i=="string"&&i.trim())return i.trim()}}return"No description for this topic."},extractLessonName(e){if(!e)return"Untitled";const t=["lessonName","title","name"];for(const s of t){if(typeof e[s]=="string"&&e[s].trim())return e[s].trim();if(typeof e[s]=="object"&&e[s]!==null){const i=e[s][this.lang]||e[s].en||e[s].ru||e[s].uz;if(i&&typeof i=="string"&&i.trim())return i.trim()}}if(typeof e.topic=="string"&&e.topic.trim())return e.topic.trim();if(typeof e.topic=="object"&&e.topic!==null){const s=e.topic[this.lang]||e.topic.en||e.topic.ru||e.topic.uz;if(s&&typeof s=="string"&&s.trim())return s.trim()}return"Untitled"},extractLessonDescription(e){if(!e)return"";const t=["description","desc","summary","info"];for(const s of t){if(typeof e[s]=="string"&&e[s].trim())return e[s].trim();if(typeof e[s]=="object"&&e[s]!==null){const i=e[s][this.lang]||e[s].en||e[s].ru||e[s].uz;if(i&&typeof i=="string"&&i.trim())return i.trim()}}return""},getUserSubscription(){return this.enhancedUserPlan},handleError(e,t="operation"){var i,n;let s=`An error occurred during ${t}. Please try again.`;if(e.response)switch(e.response.status){case 400:s=`Bad request: ${((i=e.response.data)==null?void 0:i.message)||"check your data."}`;break;case 401:s="You need to log in. Please refresh the page or log in again.";break;case 403:s="Access denied. You do not have permission for this operation.";break;case 404:s="Resource not found. It may have been deleted or moved.";break;case 429:s="Too many requests. Please wait a moment and try again.";break;case 500:case 502:case 503:case 504:s="Server error. We are already working to fix the problem. Please try again later.";break;default:s=`Server error (${e.response.status}): ${((n=e.response.data)==null?void 0:n.message)||"unknown error."}`;break}else e.request?s="Network error. Check your internet connection.":e.message&&(e.message.includes("timeout")?s="Request timeout exceeded. Please try again later.":e.message.includes("Topic ID not specified")?s="Topic ID not provided. Check the page URL.":e.message.includes("Invalid topic data received")?s="Invalid topic data received from server. Contact support.":s=e.message);return this.isDevelopment,s},async retryLoad(){if(this.retryCount++,this.retryCount>3){this.error="Maximum number of retries exceeded. Please refresh the page.",this.loading=!1;return}const e=Math.pow(2,this.retryCount-1)*1e3;await new Promise(t=>setTimeout(t,e)),await this.initializeComponent()},getTopicName(e){return e?this.extractName(e):"Untitled"},getTopicDescription(e){return e?this.extractDescription(e):"No description for this topic."},getLessonName(e){return e?this.extractLessonName(e):"Untitled"},getLessonDescription(e){return e?this.extractLessonDescription(e):""},startLesson(e){try{if(!e||!e._id&&!e.id){this.error="Error: invalid lesson or missing ID.";return}if((e.type==="premium"||e.type==="pro")&&!this.isPremiumUser){this.handleSubscription();return}const t=e._id||e.id;this.$router.push({name:"LessonPage",params:{id:t}})}catch{this.error="Error starting lesson"}},startFirstLesson(){try{const e=this.lessons.find(t=>t&&(t.type!=="premium"&&t.type!=="pro"||this.isPremiumUser));e?this.startLesson(e):this.handleSubscription()}catch{this.error="Error starting first lesson"}},handleSubscription(){var e,t;try{this.$router.push({name:"PaymePayment",params:{plan:"start"},query:{returnTo:this.$route.fullPath,from:"topic",topicId:((e=this.topic)==null?void 0:e._id)||((t=this.topic)==null?void 0:t.id)}}).catch(s=>{window.location.href="/payment/start"})}catch{window.location.href="/payment/start"}},async checkPaymentStatus(){this.lastPaymentCheck=Date.now();try{if(!f.currentUser||!this.$store)return;typeof this.$store.dispatch=="function"&&await this.$store.dispatch("user/checkPendingPayments")}catch{}},hasTopicAccess(e){if(!e)return!1;const t=e.type||"free",s=this.enhancedUserPlan;return t==="free"?!0:t==="premium"?["premium","start","pro"].includes(s):t==="pro"?s==="pro":!1},cleanup(){this.statusChangeTimeout&&(clearTimeout(this.statusChangeTimeout),this.statusChangeTimeout=null),this.paymentCheckInterval&&(clearInterval(this.paymentCheckInterval),this.paymentCheckInterval=null),this.statusSyncInterval&&(clearInterval(this.statusSyncInterval),this.statusSyncInterval=null),typeof window<"u"&&(this.globalEventHandlers.subscriptionChange&&window.removeEventListener("userSubscriptionChanged",this.globalEventHandlers.subscriptionChange),this.globalEventHandlers.storageChange&&window.removeEventListener("storage",this.globalEventHandlers.storageChange)),this.eventCleanupFunctions.forEach(e=>{try{e()}catch{}}),this.eventCleanupFunctions=[],this.storeUnsubscribe&&(this.storeUnsubscribe(),this.storeUnsubscribe=null),this.globalEventHandlers={}}},async created(){try{await this.checkPaymentStatus()}catch{}},beforeUnmount(){this.cleanup()},errorCaptured(e,t,s){return this.isDevelopment&&(this.debugInfo={...this.debugInfo,templateError:e.message,errorInfo:s,timestamp:new Date().toISOString()}),!1}},se={class:"topic-overview"},re={key:0,class:"loading-container"},ie={class:"loading-text"},oe={key:1,class:"error-container"},ne={class:"error-title"},ae={class:"error-message"},le={key:0,class:"debug-info"},ce={key:2,class:"topic-content"},ue={class:"nav-header"},de={class:"topic-header"},pe={class:"topic-hero"},he={class:"topic-info"},me={class:"topic-title"},fe={class:"topic-description"},ge={class:"topic-stats"},ye={class:"stat-card"},ve={class:"stat-number"},be={class:"stat-card"},_e={class:"stat-number"},ke={class:"stat-card"},Pe={class:"stat-number"},Ce={class:"stat-card"},Se={class:"stat-number"},Ue={class:"lessons-section"},Te={class:"section-header"},Ie={class:"lesson-filters"},Ae={key:0,class:"no-lessons"},we={class:"no-lessons-text"},xe={key:1,class:"lessons-grid"},De=["onClick"],Ee={class:"lesson-number"},Le={key:0,class:"lesson-progress-indicator"},Ne={class:"progress-ring",width:"40",height:"40"},He=["stroke","stroke-dasharray","stroke-dashoffset"],ze={class:"progress-text"},Fe={key:0},Re={key:1},Me={class:"lesson-content"},Ve={class:"lesson-title"},Be={class:"lesson-description"},je={key:0,class:"lesson-progress"},Oe={class:"progress-info"},qe={class:"progress-label"},Ze={class:"progress-percentage"},Ye={class:"progress-bar"},Ke={key:0,class:"lesson-stars"},We={class:"lesson-meta"},Ge={key:0,class:"meta-item"},Je={key:1,class:"meta-item"},Qe={key:2,class:"meta-item"},Xe={key:3,class:"meta-item time-spent"},$e={class:"lesson-action"},et=["disabled","onClick"],tt={key:0},st={key:1},rt={key:2},it={key:3},ot={key:1,class:"lock-overlay"},nt={class:"action-section"},at={class:"action-content"},lt={class:"action-description"},ct={class:"action-buttons"};function ut(e,t,s,i,n,a){return c(),l("div",se,[n.loading?(c(),l("div",re,[t[9]||(t[9]=r("div",{class:"loading-spinner"},null,-1)),r("p",ie,u(e.$t("loadingStates.course")),1)])):!n.topic||n.error?(c(),l("div",oe,[t[11]||(t[11]=r("div",{class:"error-icon"},"âŒ",-1)),r("h3",ne,u(n.topic?"An error occurred":"Topic not found"),1),r("p",ae,u(n.topic?n.error:"The topic may have been deleted or you do not have access to it"),1),r("button",{onClick:t[0]||(t[0]=(...o)=>a.navigateToProfile&&a.navigateToProfile(...o)),class:"btn btn-back"}," â¬…ï¸ Back to catalog "),a.isDevelopment&&n.debugInfo?(c(),l("div",le,[t[10]||(t[10]=r("h4",null,"Debug Info (Dev Mode Only):",-1)),r("pre",null,u(JSON.stringify(n.debugInfo,null,2)),1)])):p("",!0)])):(c(),l("div",ce,[r("div",ue,[r("button",{onClick:t[1]||(t[1]=(...o)=>a.navigateToProfile&&a.navigateToProfile(...o)),class:"back-button"},t[12]||(t[12]=[r("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),m(" Back to catalog ")]))]),r("div",de,[r("div",pe,[t[13]||(t[13]=r("div",{class:"topic-icon"},"ðŸ“˜",-1)),r("div",he,[r("h1",me,u(a.getTopicName(n.topic)),1),r("p",fe,u(a.getTopicDescription(n.topic)),1)])]),r("div",ge,[r("div",ye,[r("div",ve,u(n.lessons.length),1),t[14]||(t[14]=r("div",{class:"stat-label"},"Total lessons",-1))]),r("div",be,[r("div",_e,u(a.freeCount),1),t[15]||(t[15]=r("div",{class:"stat-label"},"Free",-1))]),r("div",ke,[r("div",Pe,u(a.premiumCount),1),t[16]||(t[16]=r("div",{class:"stat-label"},"Premium",-1))]),r("div",Ce,[r("div",Se,u(Math.round(a.overallProgress))+"%",1),t[17]||(t[17]=r("div",{class:"stat-label"},"Progress",-1))])])]),r("div",Ue,[r("div",Te,[t[18]||(t[18]=r("h2",{class:"section-title"},[r("span",{class:"section-icon"},"ðŸ“š"),m(" Course lessons ")],-1)),r("div",Ie,[r("button",{class:d(["filter-btn",{active:n.filter==="all"}]),onClick:t[2]||(t[2]=o=>n.filter="all")}," All ("+u(n.lessons.length)+") ",3),r("button",{class:d(["filter-btn",{active:n.filter==="free"}]),onClick:t[3]||(t[3]=o=>n.filter="free")}," Free ("+u(a.freeCount)+") ",3),r("button",{class:d(["filter-btn",{active:n.filter==="premium"}]),onClick:t[4]||(t[4]=o=>n.filter="premium")}," Premium ("+u(a.premiumCount)+") ",3),r("button",{class:d(["filter-btn",{active:n.filter==="completed"}]),onClick:t[5]||(t[5]=o=>n.filter="completed")}," Completed ("+u(a.completedCount)+") ",3)])]),a.filteredLessons.length===0?(c(),l("div",Ae,[t[19]||(t[19]=r("div",{class:"no-lessons-icon"},"ðŸ“­",-1)),t[20]||(t[20]=r("h3",{class:"no-lessons-title"},"No lessons found",-1)),r("p",we,u(n.filter!=="all"?"Try changing the filter":"There are no lessons in this topic yet"),1)])):(c(),l("div",xe,[(c(!0),l(q,null,Z(a.filteredLessons,(o,h)=>{var g,v,b,_,k,P,C,S,U,T,I,A,w,x,D,E,L,N,H,z,F,R,M,V,B,j;return c(),l("div",{key:o._id,class:d(["lesson-card",{locked:o.type==="premium"&&!a.isPremiumUser,premium:o.type==="premium",completed:(g=o.progress)==null?void 0:g.completed,"in-progress":((v=o.progress)==null?void 0:v.progressPercent)>0&&!((b=o.progress)!=null&&b.completed)}]),onClick:y=>a.startLesson(o)},[r("div",Ee,u(h+1),1),((_=o.progress)==null?void 0:_.progressPercent)>0?(c(),l("div",Le,[r("div",{class:d(["progress-circle",{completed:(k=o.progress)==null?void 0:k.completed}])},[(c(),l("svg",Ne,[t[21]||(t[21]=r("circle",{class:"progress-ring-circle-bg",stroke:"#e5e7eb","stroke-width":"3",fill:"transparent",r:"16",cx:"20",cy:"20"},null,-1)),r("circle",{class:"progress-ring-circle",stroke:(P=o.progress)!=null&&P.completed?"#10b981":"#3b82f6","stroke-width":"3",fill:"transparent",r:"16",cx:"20",cy:"20","stroke-dasharray":`${2*Math.PI*16}`,"stroke-dashoffset":`${2*Math.PI*16*(1-(((C=o.progress)==null?void 0:C.progressPercent)||0)/100)}`},null,8,He)])),r("div",ze,u((S=o.progress)!=null&&S.completed?"âœ“":Math.round(((U=o.progress)==null?void 0:U.progressPercent)||0)+"%"),1)],2)])):p("",!0),r("div",{class:d(["lesson-badge",o.type])},[o.type==="premium"?(c(),l("span",Fe,t[22]||(t[22]=[r("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M6 10V8C6 5.79086 7.79086 4 10 4H14C16.2091 4 18 5.79086 18 8V10H20V20H4V10H6ZM8 10H16V8C16 6.89543 15.1046 6 14 6H10C8.89543 6 8 6.89543 8 8V10Z"})],-1),m(" Premium ")]))):(c(),l("span",Re,t[23]||(t[23]=[r("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"})],-1),m(" Free ")])))],2),r("div",Me,[r("h3",Ve,u(a.getLessonName(o)),1),r("p",Be,u(a.getLessonDescription(o)),1),o.progress||a.currentUser?(c(),l("div",je,[r("div",Oe,[r("span",qe,u((T=o.progress)!=null&&T.completed?"Completed":((I=o.progress)==null?void 0:I.progressPercent)>0?"In progress":"Not started"),1),r("span",Ze,u(Math.round(((A=o.progress)==null?void 0:A.progressPercent)||0))+"% ",1)]),r("div",Ye,[r("div",{class:d(["progress-fill",{completed:(w=o.progress)==null?void 0:w.completed,"in-progress":((x=o.progress)==null?void 0:x.progressPercent)>0&&!((D=o.progress)!=null&&D.completed)}]),style:K({width:(((E=o.progress)==null?void 0:E.progressPercent)||0)+"%"})},null,6)]),((L=o.progress)==null?void 0:L.stars)>0?(c(),l("div",Ke,[(c(),l(q,null,Z(3,y=>{var O;return r("span",{key:y,class:d(["star",{filled:y<=(((O=o.progress)==null?void 0:O.stars)||0)}])}," â­ ",2)}),64))])):p("",!0)])):p("",!0),r("div",We,[(N=o.steps)!=null&&N.length?(c(),l("span",Ge,[t[24]||(t[24]=r("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M9 11H15M9 15H15M17 21H7C5.89543 21 5 20.1046 5 19V5C5 3.89543 5.89543 3 7 3H12.5858C12.851 3 13.1054 3.10536 13.2929 3.29289L19.7071 9.70711C19.8946 9.89464 20 10.149 20 10.4142V19C20 20.1046 19.1046 21 18 21H17Z"})],-1)),m(" "+u(o.steps.length)+" steps ",1)])):p("",!0),(H=o.metadata)!=null&&H.estimatedDuration?(c(),l("span",Je,[t[25]||(t[25]=r("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("circle",{cx:"12",cy:"12",r:"10"}),r("polyline",{points:"12,6 12,12 16,14"})],-1)),m(" "+u(o.metadata.estimatedDuration)+" min ",1)])):p("",!0),((z=o.homework)==null?void 0:z.totalExercises)>0?(c(),l("span",Qe,[t[26]||(t[26]=W('<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-65365d0c><path d="M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z" data-v-65365d0c></path><polyline points="14,2 14,8 20,8" data-v-65365d0c></polyline><line x1="16" y1="13" x2="8" y2="13" data-v-65365d0c></line><line x1="16" y1="17" x2="8" y2="17" data-v-65365d0c></line><polyline points="10,9 9,9 8,9" data-v-65365d0c></polyline></svg>',1)),m(" "+u(o.homework.totalExercises)+" exercises ",1)])):p("",!0),(F=o.progress)!=null&&F.duration?(c(),l("span",Xe,[t[27]||(t[27]=r("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("circle",{cx:"12",cy:"12",r:"10"}),r("polyline",{points:"12,6 12,12 16,14"})],-1)),m(" "+u(a.formatDuration(o.progress.duration))+" spent ",1)])):p("",!0)])]),r("div",$e,[r("button",{class:d(["action-btn",{locked:o.type==="premium"&&!a.isPremiumUser,premium:o.type==="premium"&&!a.isPremiumUser,completed:(R=o.progress)==null?void 0:R.completed,continue:((M=o.progress)==null?void 0:M.progressPercent)>0&&!((V=o.progress)!=null&&V.completed)}]),disabled:o.type==="premium"&&!a.isPremiumUser,onClick:G(y=>a.startLesson(o),["stop"])},[o.type==="premium"&&!a.isPremiumUser?(c(),l("span",tt," ðŸ”’ Subscription required ")):(B=o.progress)!=null&&B.completed?(c(),l("span",st," âœ… Take again ")):((j=o.progress)==null?void 0:j.progressPercent)>0?(c(),l("span",rt," â–¶ï¸ Continue lesson ")):(c(),l("span",it," ðŸš€ Start lesson "))],10,et)]),o.type==="premium"&&!a.isPremiumUser?(c(),l("div",ot,t[28]||(t[28]=[r("div",{class:"lock-icon"},[r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor"},[r("path",{d:"M6 10V8C6 5.79086 7.79086 4 10 4H14C16.2091 4 18 5.79086 18 8V10H20V20H4V10H6ZM8 10H16V8C16 6.89543 15.1046 6 14 6H10C8.89543 6 8 6.89543 8 8V10Z"})])],-1)]))):p("",!0)],10,De)}),128))]))]),r("div",nt,[r("div",at,[t[29]||(t[29]=r("h3",{class:"action-title"},"Ready to start learning?",-1)),r("p",lt,u(a.reactiveAvailableCount>0?`You have access to ${a.reactiveAvailableCount} out of ${n.lessons.length} lessons`:"Subscribe to access all lessons"),1),r("div",ct,[a.reactiveAvailableCount>0?(c(),l("button",{key:0,onClick:t[6]||(t[6]=(...o)=>a.startFirstLesson&&a.startFirstLesson(...o)),class:"btn btn-primary btn-start"}," ðŸš€ Start first lesson ")):(c(),l("button",{key:1,onClick:t[7]||(t[7]=(...o)=>a.handleSubscription&&a.handleSubscription(...o)),class:"btn btn-premium btn-start"}," â­ Subscribe ")),r("button",{onClick:t[8]||(t[8]=(...o)=>a.navigateToProfile&&a.navigateToProfile(...o)),class:"btn btn-secondary"}," ðŸ“š Other courses ")])])])]))])}const pt=Y(te,[["render",ut],["__scopeId","data-v-65365d0c"]]);export{pt as default};
