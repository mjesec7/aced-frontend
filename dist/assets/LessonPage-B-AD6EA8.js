import{x as gt,y as O,z as ke,A as f,B as wt,C as Is,D as Dt,E as Pt,G as Bt,H as As,I as Nt,J as Ot,K as Ht,L as Qt,M as Yt,N as nt,O as mt,Q as Ts,R as Ms,S as Ls,U as Es,_ as Ie,c as i,a as e,e as B,j as xe,t as d,n as J,i as qe,F as de,h as ve,s as r,f as Se,V as be,W as et,d as $e,b as Me,w as Pe,T as Re,X as Ds,Y as Te,Z as Ps,$ as Ws,g as Xe,v as tt,a0 as jt,a1 as js,a2 as zs,a3 as qs,a4 as Lt,a5 as Rs,r as yt,a6 as lt}from"./index-zh0RWoIj.js";function Vs(){const s=gt({isVisible:!1,currentIndex:0,words:[],isCompleted:!1,showingList:!1}),t=gt({isFlipping:!1,showDefinition:!1}),n=gt({startTime:null,endTime:null,totalTime:0,wordTimes:{},isActive:!1}),a=O(()=>{const p=c();return p.length&&p[s.currentIndex]||null}),g=O(()=>{const p=c();return p.length?Math.round((s.currentIndex+1)/p.length*100):0}),o=O(()=>{const p=c();return s.currentIndex>=p.length-1}),v=(p,D)=>{if(!p||typeof p!="object")return"";let F="";switch(D){case"term":F=p.term||p.word||p.title||p.name||"";break;case"definition":F=p.definition||p.translation||p.meaning||p.desc||p.description||"";break;case"example":F=p.example||p.examples||p.usage||p.sample||"";break;case"pronunciation":F=p.pronunciation||p.phonetic||p.ipa||"";break;case"partOfSpeech":F=p.partOfSpeech||p.pos||p.type||p.category||"";break;default:F=p[D]||""}return String(F).trim()},c=()=>s.words.filter(p=>{if(!p||typeof p!="object")return!1;const D=v(p,"term"),F=v(p,"definition");return!!(D&&F)}),l=p=>{const D=[];if(!p)return{patterns:D,recommendation:"No step provided",bestPattern:null};if(Array.isArray(p.data)){const A=p.data.filter(z=>v(z,"term")&&v(z,"definition")).length;D.push({type:"step.data (array)",data:p.data,count:p.data.length,valid:A})}if(p.data&&Array.isArray(p.data.vocabulary)){const A=p.data.vocabulary.filter(z=>v(z,"term")&&v(z,"definition")).length;D.push({type:"step.data.vocabulary",data:p.data.vocabulary,count:p.data.vocabulary.length,valid:A})}if(p.data&&Array.isArray(p.data.words)){const A=p.data.words.filter(z=>v(z,"term")&&v(z,"definition")).length;D.push({type:"step.data.words",data:p.data.words,count:p.data.words.length,valid:A})}if(p.vocabulary&&Array.isArray(p.vocabulary)){const A=p.vocabulary.filter(z=>v(z,"term")&&v(z,"definition")).length;D.push({type:"step.vocabulary",data:p.vocabulary,count:p.vocabulary.length,valid:A})}if(p.data&&typeof p.data=="object"&&!Array.isArray(p.data)){const A=v(p.data,"term"),z=v(p.data,"definition");A&&z&&D.push({type:"step.data (single item)",data:[p.data],count:1,valid:1})}v(p,"term")&&v(p,"definition")&&D.push({type:"step (direct)",data:[p],count:1,valid:1}),p.data&&typeof p.data=="object"&&!Array.isArray(p.data)&&Object.entries(p.data).forEach(([A,z])=>{if(Array.isArray(z)&&z.length>0){const Z=z.filter(pe=>v(pe,"term")&&v(pe,"definition")).length;Z>0&&D.push({type:`step.data.${A}`,data:z,count:z.length,valid:Z})}});const F=D.filter(A=>A.valid>0).sort((A,z)=>z.valid-A.valid)[0],oe=F?`Use ${F.type} (${F.valid}/${F.count} valid items)`:"No valid vocabulary data found";return{patterns:D,recommendation:oe,bestPattern:F}},_=p=>{if(!p||p.type!=="vocabulary")return!1;try{const{patterns:D,recommendation:F,bestPattern:oe}=l(p);let A=[];oe?A=oe.data:A=[{id:"fallback_1",term:"Algorithm",definition:"A step-by-step procedure for solving a problem or completing a task.",example:"The sorting algorithm efficiently organized the data.",pronunciation:"al-guh-ri-thuhm",partOfSpeech:"noun",difficulty:"medium",learned:!1},{id:"fallback_2",term:"Variable",definition:"A storage location with an associated name that contains data.",example:"The variable stores the user's input value.",pronunciation:"vair-ee-uh-buhl",partOfSpeech:"noun",difficulty:"easy",learned:!1},{id:"fallback_3",term:"Function",definition:"A reusable block of code that performs a specific task.",example:"The function calculates the area of a rectangle.",pronunciation:"fuhngk-shuhn",partOfSpeech:"noun",difficulty:"medium",learned:!1}];const z=A.map((Z,pe)=>{if(!Z||typeof Z!="object")return null;const Ae=v(Z,"term"),We=v(Z,"definition");return!Ae||!We?null:{id:Z.id||Z._id||`vocab_${pe}_${Date.now()}`,term:Ae,definition:We,example:v(Z,"example"),pronunciation:v(Z,"pronunciation"),partOfSpeech:v(Z,"partOfSpeech"),difficulty:Z.difficulty||"medium",learned:!!Z.learned,originalIndex:pe,category:Z.category||"general",tags:Z.tags||[],createdAt:Z.createdAt||new Date().toISOString(),lastStudied:Z.lastStudied||null}}).filter(Boolean);return z.length===0?!1:(s.isVisible=!0,s.currentIndex=0,s.words=z,s.isCompleted=!1,s.showingList=!1,t.isFlipping=!1,t.showDefinition=!1,$(),U("vocabulary_started",{wordCount:z.length,source:oe?"detected":"fallback",patternUsed:(oe==null?void 0:oe.type)||"fallback"}),!0)}catch{return!1}},w=()=>{t.isFlipping||t.showDefinition||a.value&&(t.isFlipping=!0,setTimeout(()=>{t.showDefinition=!0,t.isFlipping=!1,U("definition_viewed",{word:v(a.value,"term"),wordIndex:s.currentIndex})},200))},P=()=>{t.isFlipping||!t.showDefinition||(t.isFlipping=!0,setTimeout(()=>{t.showDefinition=!1,t.isFlipping=!1},200))},k=()=>{const p=c();if(s.currentIndex>=p.length-1){m();return}t.isFlipping=!1,t.showDefinition=!1,setTimeout(()=>{s.currentIndex++,se(`Word ${s.currentIndex+1} of ${p.length}: ${v(a.value,"term")}`)},100)},b=()=>{s.currentIndex<=0||(t.isFlipping=!1,t.showDefinition=!1,setTimeout(()=>{s.currentIndex--,se(`Word ${s.currentIndex+1} of ${c().length}: ${v(a.value,"term")}`)},100))},C=p=>{const D=c();p<0||p>=D.length||p===s.currentIndex||(t.isFlipping=!1,t.showDefinition=!1,setTimeout(()=>{s.currentIndex=p,se(`Jumped to word ${p+1}: ${v(a.value,"term")}`)},50))},x=()=>{if(!a.value)return;const p=a.value,D=p.learned;p.learned=!p.learned,p.lastStudied=new Date().toISOString();const F=c(),oe=F.filter(A=>A.learned).length;se(p.learned?`Word marked as learned. ${oe} of ${F.length} words completed.`:`Word unmarked. ${oe} of ${F.length} words completed.`),U("word_learned_toggled",{word:v(p,"term"),wasLearned:D,nowLearned:p.learned,totalLearned:oe,totalWords:F.length}),p.learned&&!D&&setTimeout(()=>{k()},800),setTimeout(ie,100)},m=()=>{const p=c(),D=p.filter(oe=>oe.learned).length,F=p.length>0?D/p.length*100:0;s.isCompleted=!0,W(),se(`Vocabulary completed! You learned ${D} out of ${p.length} words.`),U("vocabulary_completed",{totalWords:p.length,learnedWords:D,completionRate:F,studyTime:n.totalTime}),setTimeout(()=>{T()},2500)},T=()=>{s.showingList=!0,setTimeout(()=>{s.isVisible=!1,s.showingList=!1,U("vocabulary_modal_closed",{reason:"completed"})},1500)},L=()=>{const p=c(),D=p.filter(F=>F.learned).length;W(),s.isVisible=!1,U("vocabulary_skipped",{skipAt:s.currentIndex,totalWords:p.length,learnedWords:D})},E=()=>{W(),s.isVisible=!1,U("vocabulary_modal_closed",{reason:"user_closed",currentIndex:s.currentIndex,wordsLearned:c().filter(p=>p.learned).length})},M=()=>{const p=c();s.currentIndex=0,s.isCompleted=!1,s.showingList=!1,p.forEach(D=>{D.learned=!1,D.lastStudied=null}),t.isFlipping=!1,t.showDefinition=!1,$(),U("vocabulary_restarted",{totalWords:p.length})},$=()=>{n.startTime=Date.now(),n.isActive=!0,n.endTime=null,n.totalTime=0,U("study_timer_started")},W=()=>{n.isActive&&(n.endTime=Date.now(),n.totalTime=n.endTime-n.startTime,n.isActive=!1,U("study_timer_stopped",{totalTime:n.totalTime,totalMinutes:Math.round(n.totalTime/6e4*10)/10}))},N=(p,D)=>{p&&(n.wordTimes[p]=(n.wordTimes[p]||0)+D)},ie=()=>{try{const p={currentIndex:s.currentIndex,words:c().map(D=>({id:D.id,learned:D.learned,lastStudied:D.lastStudied})),lastSaved:new Date().toISOString()};localStorage.setItem("vocabularyProgress",JSON.stringify(p))}catch{}},S=()=>{try{const p=localStorage.getItem("vocabularyProgress");return p?JSON.parse(p):null}catch{return null}},R=p=>{if(!(p!=null&&p.words))return!1;try{const D=c();let F=0;return p.words.forEach(oe=>{const A=D.find(z=>z.id===oe.id||v(z,"term")===v(oe,"term"));A&&(A.learned=oe.learned,A.lastStudied=oe.lastStudied,F++)}),p.currentIndex!==void 0&&p.currentIndex<D.length&&(s.currentIndex=p.currentIndex),U("progress_restored",{totalWords:D.length,restoredWords:F}),!0}catch{return!1}},ee=(p,D={})=>{if(!(!p||typeof p!="string"))try{if("speechSynthesis"in window){window.speechSynthesis.cancel();const F=new SpeechSynthesisUtterance(p.trim());F.lang=D.lang||"en-US",F.rate=D.rate||.8,F.pitch=D.pitch||1,F.volume=D.volume||1,F.onstart=()=>{U("word_pronounced",{word:p,lang:F.lang})},F.onerror=oe=>{},window.speechSynthesis.speak(F)}}catch{}},se=p=>{if(!(typeof window>"u"))try{const D=document.createElement("div");D.setAttribute("aria-live","polite"),D.setAttribute("aria-atomic","true"),D.style.cssText="position:absolute;left:-10000px;width:1px;height:1px;overflow:hidden;",document.body.appendChild(D),D.textContent=p,setTimeout(()=>{document.body.removeChild(D)},1e3)}catch{}},ce=p=>{if(!s.isVisible)return;const{key:D,ctrlKey:F,altKey:oe}=p,A={" ":Z=>{Z.preventDefault(),t.showDefinition?P():w()},ArrowLeft:Z=>{Z.preventDefault(),b()},ArrowRight:Z=>{Z.preventDefault(),k()},Enter:Z=>{Z.preventDefault(),x()},Escape:Z=>{Z.preventDefault(),L()},Home:Z=>{Z.preventDefault(),C(0)},End:Z=>{Z.preventDefault(),C(c().length-1)}};if((F||oe)&&D==="r"){p.preventDefault(),M();return}if(/^[1-9]$/.test(D)){const Z=parseInt(D)-1,pe=c();Z<pe.length&&(p.preventDefault(),C(Z));return}const z=A[D];z&&(z(p),U("keyboard_shortcut_used",{key:D,ctrlKey:F,altKey:oe,currentWord:v(a.value,"term")}))},ge=()=>{const p=c(),D=p.filter(oe=>oe.learned),F=p.filter(oe=>!oe.learned);return{total:p.length,learned:D.length,unlearned:F.length,progress:p.length>0?Math.round(D.length/p.length*100):0,currentIndex:s.currentIndex,currentWord:a.value?{term:v(a.value,"term"),definition:v(a.value,"definition"),learned:a.value.learned,difficulty:a.value.difficulty}:null,isCompleted:s.isCompleted,isVisible:s.isVisible,studyTime:n.totalTime}},_e=()=>{const p=c(),D=p.filter(A=>A.learned),F=p.length>0?D.length/p.length*100:0,oe=[];return F===0?oe.push({type:"start",priority:"high",message:"Start your vocabulary journey! Begin with the first word.",action:"start_studying"}):F<25?oe.push({type:"continue",priority:"high",message:"Great start! Keep building momentum.",action:"continue_studying"}):F<50?oe.push({type:"halfway",priority:"medium",message:"You're making good progress! Halfway there.",action:"continue_studying"}):F<100?oe.push({type:"almost_done",priority:"high",message:"Almost finished! Push through to complete the set.",action:"finish_studying"}):oe.push({type:"completed",priority:"low",message:"Excellent! You've learned all words. Consider reviewing.",action:"review_or_restart"}),oe},Y=p=>{if(!p||typeof p!="string")return c();const D=p.toLowerCase().trim();return c().filter(oe=>{const A=v(oe,"term").toLowerCase(),z=v(oe,"definition").toLowerCase(),Z=v(oe,"example").toLowerCase();return A.includes(D)||z.includes(D)||Z.includes(D)})},V=p=>c().filter(D=>D.difficulty===p),Q=(p=!0)=>c().filter(D=>D.learned===p),H=()=>{const p=c();return{metadata:{exportedAt:new Date().toISOString(),totalWords:p.length,learnedWords:p.filter(D=>D.learned).length,version:"1.0"},vocabulary:p.map(D=>({id:D.id,term:v(D,"term"),definition:v(D,"definition"),example:v(D,"example"),pronunciation:v(D,"pronunciation"),partOfSpeech:v(D,"partOfSpeech"),difficulty:D.difficulty,learned:D.learned,lastStudied:D.lastStudied}))}},q=p=>{if(!p||p.type!=="vocabulary")return{isValid:!1,reason:"Invalid step type",stepType:(p==null?void 0:p.type)||"undefined"};const{patterns:D,recommendation:F,bestPattern:oe}=l(p);return{isValid:oe&&oe.valid>0,reason:F,patterns:D.map(A=>({type:A.type,count:A.count,valid:A.valid,validationRate:A.count>0?Math.round(A.valid/A.count*100):0})),bestPattern:oe?{type:oe.type,totalItems:oe.count,validItems:oe.valid,validationRate:Math.round(oe.valid/oe.count*100)}:null}},te=()=>{const p=c(),D=s.words;return{modal:{isVisible:s.isVisible,currentIndex:s.currentIndex,totalWords:D.length,validWords:p.length,invalidWords:D.length-p.length,isCompleted:s.isCompleted,showingList:s.showingList},currentWord:a.value?{id:a.value.id,term:v(a.value,"term"),definition:v(a.value,"definition"),learned:a.value.learned,difficulty:a.value.difficulty}:null,animation:{isFlipping:t.isFlipping,showDefinition:t.showDefinition},progress:{percentage:g.value,isLastWord:o.value,learnedCount:p.filter(F=>F.learned).length},timer:{isActive:n.isActive,totalTime:n.totalTime,startTime:n.startTime},words:p.map((F,oe)=>({index:oe,id:F.id,term:v(F,"term"),learned:F.learned,isCurrent:oe===s.currentIndex}))}},U=(p,D={})=>{const F={...D,timestamp:new Date().toISOString(),sessionId:`vocab_${Date.now()}`};try{const oe=JSON.parse(localStorage.getItem("vocabularyEvents")||"[]");oe.push({type:p,data:F}),oe.length>100&&oe.splice(0,oe.length-100),localStorage.setItem("vocabularyEvents",JSON.stringify(oe))}catch{}},fe=()=>{W(),s.isVisible=!1,s.currentIndex=0,s.words=[],s.isCompleted=!1,s.showingList=!1,t.isFlipping=!1,t.showDefinition=!1,n.startTime=null,n.endTime=null,n.totalTime=0,n.wordTimes={},n.isActive=!1,U("vocabulary_cleanup")},me=()=>{const p=c(),D=new Date().toISOString();p.forEach(F=>{F.learned=!0,F.lastStudied=D}),se(`All ${p.length} words marked as learned`),U("all_words_learned",{totalWords:p.length}),ie()},ae=()=>{const p=c(),D=p.filter(F=>F.learned).length;p.forEach(F=>{F.learned=!1,F.lastStudied=null}),s.currentIndex=0,s.isCompleted=!1,se(`All progress reset. ${D} words unmarked.`),U("progress_reset",{totalWords:p.length,previousLearnedCount:D}),ie()};return ke(()=>s.currentIndex,()=>{ie()}),ke(()=>c().filter(p=>p.learned).length,()=>{ie()}),{vocabularyModal:s,cardAnimation:t,studyTimer:n,currentVocabWord:a,vocabProgress:g,isLastVocabWord:o,initializeVocabularyModal:_,showVocabDefinition:w,hideVocabDefinition:P,markWordAsLearned:x,nextVocabWord:k,previousVocabWord:b,jumpToVocabWord:C,completeVocabularyModal:m,showVocabularyList:T,skipVocabularyModal:L,closeVocabularyModal:E,restartVocabulary:M,markAllWordsAsLearned:me,resetAllProgress:ae,handleKeyboardShortcuts:ce,pronounceWord:ee,startStudyTimer:$,stopStudyTimer:W,recordWordTime:N,autoSaveProgress:ie,loadSavedProgress:S,applySavedProgress:R,exportVocabularyData:H,searchWords:Y,filterWordsByDifficulty:V,filterWordsByLearned:Q,getStudySessionStats:ge,getStudyRecommendations:_e,announceForScreenReader:se,getValidWords:c,extractWordProperty:v,validateVocabularyStep:q,detectVocabularyPatterns:l,trackVocabularyEvent:U,getVocabularyDebugInfo:te,cleanup:fe}}function Jt(){const s=f(0),t=f(0),n=f(null),a=f(null),g=f([]),o=f([]),v=f([]),c=gt({}),l=f(""),_=f(!1),w=f(""),P=f(""),k=f(null),b=f([]),C=f([]),x=f(null),m=f(null),T=f(0),L=f(2),E=f(!1),M=O(()=>T.value===1&&T.value<L.value),$=u=>{if(!u)return[];let y=[];if(u.questions&&Array.isArray(u.questions))return y=u.questions.map((X,G)=>({question:typeof X=="string"?X:X.text||X.question||`Question ${G+1}`,index:G,source:"explicit-array"})),y;const I=u.question||u.content||"";if(I){const X=[{name:"numbered-dot",regex:/(\d+\.\s*[^?]*\?)/g,extract:G=>G.replace(/^\d+\.\s*/,"").trim()},{name:"numbered-paren",regex:/(\d+\)\s*[^?]*\?)/g,extract:G=>G.replace(/^\d+\)\s*/,"").trim()},{name:"question-prefix",regex:/((?:Question|Question)\s*\d+[:.]\s*[^?]*\?)/gi,extract:G=>G.replace(/(?:Question|Question)\s*\d+[:.]\s*/i,"").trim()},{name:"simple-questions",regex:/([Ð-Ð¯A-Z][^?]*\?)/g,extract:G=>G.trim()}];for(const G of X){const re=[...I.matchAll(G.regex)];if(re.length>1){y=re.map((ye,Ve)=>({question:G.extract(ye[1]||ye[0]),index:Ve,source:`pattern-${G.name}`}));break}}if(y.length===0){const re=I.split(/\n+/).filter(ye=>ye.trim().length>0).filter(ye=>ye.includes("?"));re.length>1&&(y=re.map((ye,Ve)=>({question:ye.trim().replace(/^\d+[\.)]\s*/,""),index:Ve,source:"line-split"})))}}if(y.length===0&&u.data)if(Array.isArray(u.data)){const X=u.data.filter(G=>typeof G=="string"?G.includes("?"):G&&(G.question||G.text)&&String(G.question||G.text).includes("?"));X.length>0&&(y=X.map((G,re)=>({question:typeof G=="string"?G:G.question||G.text||`Question ${re+1}`,index:re,source:"data-array"})))}else u.data.questions&&Array.isArray(u.data.questions)&&(y=u.data.questions.map((X,G)=>({question:typeof X=="string"?X:X.text||X.question||`Question ${G+1}`,index:G,source:"data-questions"})));return y},W=(u,y)=>{if(!u||!y)return 0;const I=u.length>y.length?u:y,X=u.length>y.length?y:u;if(I.length===0)return 1;const G=N(I,X);return(I.length-G)/I.length},N=(u,y)=>{u=u.toLowerCase(),y=y.toLowerCase();const I=[];for(let X=0;X<=u.length;X++){let G=X;for(let re=0;re<=y.length;re++)if(X===0)I[re]=re;else if(re>0){let ye=I[re-1];u.charAt(X-1)!==y.charAt(re-1)&&(ye=Math.min(Math.min(ye,G),I[re])+1),I[re-1]=G,G=ye}X>0&&(I[y.length]=G)}return I[y.length]},ie=u=>{const y=[...u];for(let I=y.length-1;I>0;I--){const X=Math.floor(Math.random()*(I+1));[y[I],y[X]]=[y[X],y[I]]}if(y.length>1){let I=0;for(;I<5&&JSON.stringify(y)===JSON.stringify(u);){for(let X=y.length-1;X>0;X--){const G=Math.floor(Math.random()*(X+1));[y[X],y[G]]=[y[G],y[X]]}I++}}return y},S=u=>u.every((y,I)=>y.originalIndex===I),R=u=>{const y=u.correctAnswer||u.answer;return Array.isArray(y)?y:[y].filter(Boolean)},ee=(u,y)=>{const I=$(y);if(I.length>1){if(!Array.isArray(u))return!1;const re=R(y);let ye=0;const Ve=I.length;for(let Le=0;Le<Ve;Le++){const Ne=u[Le];if(!Ne||typeof Ne!="string")continue;const Fe=Ne.trim().toLowerCase();if(Fe.length<1)continue;let Be=null;if(re[Le]?Be=re[Le]:re.length===1&&(Be=re[0]),Be){const bt=String(Be).trim().toLowerCase();(Fe===bt||bt.length>3&&W(Fe,bt)>.8)&&ye++}else Fe.length>=2&&ye++}return ye/Ve>=.7}if(!u||typeof u!="string")return!1;const X=R(y),G=u.trim().toLowerCase();return X.some(re=>{const ye=String(re).trim().toLowerCase();return G===ye?!0:ye.length>3?W(G,ye)>.8:!1})},se=(u,y)=>{const I=y.correctAnswer;if(typeof I=="number")return u===I;if(typeof I=="string"&&I.length===1)return u===I.toUpperCase();if(typeof I=="string")return u===I;if(Array.isArray(I)){const X=Array.isArray(u)?[...u].sort():[u],G=[...I].sort();return JSON.stringify(X)===JSON.stringify(G)}return!1},ce=(u,y)=>{const I=y.correctAnswer;if(typeof I=="boolean"){if(typeof u=="boolean")return u===I;if(typeof u=="string")return u.toLowerCase()==="true"?!0:I===!1;if(typeof u=="number")return u===1===I}if(typeof I=="number"){if(typeof u=="number")return u===I;if(typeof u=="string"){const X=I===0;return u.toLowerCase()==="true"===X}}return typeof I=="string"&&typeof u=="string"?u.toLowerCase()===I.toLowerCase():!1},ge=(u,y)=>{if(!u||typeof u!="object")return!1;let I=[];return y.questions&&Array.isArray(y.questions)?I=y.questions.flatMap(X=>X.blanks||[]):y.blanks&&Array.isArray(y.blanks)&&(I=y.blanks),I.length===0||Object.keys(u).length<I.length?!1:I.every(X=>{const G=X.id,re=u[G],ye=X.correctAnswer;return(re||"").trim().toLowerCase()===(ye||"").trim().toLowerCase()})},_e=(u,y)=>!u||typeof u!="object"||Object.keys(u).length<y.pairs.length?!1:y.pairs.every(I=>u[I.id]===I.correctMatch),Y=(u,y)=>!u||typeof u!="object"||Object.keys(u).length<y.questions.length?!1:y.questions.every(I=>JSON.stringify(u[I.id])===JSON.stringify(I.correctOrder)),V=(u,y)=>{(!u||typeof u!="object")&&(u=c);const I=Array.isArray(y.dropZones)?y.dropZones:Object.values(y.dropZones||{}).filter(re=>re&&(re.label||re.id));if(I.length===0)return!1;let X=0,G=0;for(const re of I){const ye=re.id||re.label||String(re),Ve=u[ye]||[];let Qe=re.correctItems||re.items||[];re.correctItem!==void 0&&(typeof re.correctItem=="number"&&y.dragItems?Qe=[(Array.isArray(y.dragItems)?y.dragItems:Object.values(y.dragItems))[re.correctItem]]:Qe=[re.correctItem]),G+=Qe.length;for(const Le of Qe){const Ne=typeof Le=="string"?Le:(Le==null?void 0:Le.text)||(Le==null?void 0:Le.label)||String(Le);Ve.some(Be=>(typeof Be=="string"?Be:(Be==null?void 0:Be.text)||(Be==null?void 0:Be.label)||String(Be)).trim().toLowerCase()===Ne.trim().toLowerCase())&&X++}}return X===G&&G>0},Q=u=>{if(!u)return!1;switch(u.type||"short-answer"){case"short-answer":case"reading":case"sentence-transformation":case"error-correction":return ee(a.value,u);case"multiple-choice":case"abc":case"dialogue-completion":return se(a.value,u);case"true-false":return ce(a.value,u);case"fill-blanks":return ge(a.value,u);case"matching":return _e(a.value,u);case"structure":case"ordering":return Y(a.value,u);case"drag-drop":return V(c,u);case"geometry":return H(a.value,u);default:return ee(a.value,u)}},H=(u,y)=>{if(y.mode==="calculate"){if(!u||typeof u!="object")return!1;const I=String(u.side_b)===String(y.questions.find(G=>G.id==="side_b").correctAnswer),X=String(u.angle_c)===String(y.questions.find(G=>G.id==="angle_c").correctAnswer);return I&&X}return!u||typeof u!="object"?!1:u.valid===!0},q=u=>{if(!u)return!1;switch(u.type||"multiple-choice"){case"multiple-choice":return se(a.value,u);case"true-false":return ce(a.value,u);case"short-answer":return ee(a.value,u);default:return se(a.value,u)}},te=()=>{const u=["âœ… Excellent! Correct answer!","ðŸŽ‰ Correct! Keep it up!","â­ Magnificent! Continue!","ðŸš€ Right! You did great!","ðŸ’¯ Bull's-eye! Great work!","ðŸ† Superb! Let's move on!"];return u[Math.floor(Math.random()*u.length)]},U=u=>{const y=["ðŸ¤” Not quite right. You have one more attempt!","ðŸ’­ Think a little more. Try again!","ðŸŽ¯ Almost there! One more try!","ðŸ” Pay attention! You have a second attempt!","ðŸ“š Re-read the material and try again!","âš¡ Don't give up! Try another option!"];return y[Math.floor(Math.random()*y.length)]},fe=(u,y)=>{const I=["ðŸ“š Don't worry! Correct answer:","ðŸ’¡ Here's the correct answer:","ðŸŽ¯ Correct answer:","âœ… Remember the correct answer:"];return`${I[Math.floor(Math.random()*I.length)]} ${y}`},me=(u,y,I)=>{if(I)return te();if(!Array.isArray(u)||u.length===0)return"ðŸ”— Create at least one pair to check!";const G=(y.pairs||[]).length,re=u.length;if(re<G)return`ðŸ”— Create all ${G} pairs (you have ${re})`;let ye=0;return u.forEach(Ve=>{const{leftIndex:Qe,rightIndex:Le}=Ve;Qe!==void 0&&Le!==void 0&&Qe===Le&&ye++}),ye===0?"ðŸ¤” No pairs match. Think about logical connections!":ye===1?`ðŸŽ¯ ${ye} pair correct out of ${G}. Check the rest!`:`ðŸŽ¯ ${ye} pairs correct out of ${G}. Almost there!`},ae=u=>{var X;if(!u)return"";const{correctAnswer:y,type:I="short-answer"}=u;if(I==="multiple-choice"||I==="abc"||I==="dialogue-completion"){if(typeof y=="number")return((X=u.options[y])==null?void 0:X.text)||u.options[y]||"";if(typeof y=="string"&&y.length===1){const G=u.options.find(re=>(re.text||re).startsWith(y));return(G==null?void 0:G.text)||G||""}}return I==="matching"?u.pairs&&Array.isArray(u.pairs)?u.pairs.map(G=>`${G.left} â†” ${G.correctMatch}`).join("; "):"Correct pairs shown above":I==="ordering"||I==="structure"?u.questions&&Array.isArray(u.questions)?u.questions.map(G=>G.correctOrder.join(" ")).join("; "):"Correct order shown above":Array.isArray(y)?y.join("; "):String(y||"")},p=u=>{T.value++;const y=Q(u);if(_.value=y,y)l.value="âœ… Excellent! Correct answer!";else{const I=ae(u);l.value=`Correct answer: ${I}`}return E.value=!0,y},D=u=>{T.value++;const y=q(u);if(_.value=y,y)l.value=te(),E.value=!1;else if(M.value)l.value=U(),E.value=!1;else{const I=ae(u);l.value=fe(u,I),E.value=!0}return y},F=u=>{n.value=u},oe=u=>{var X,G,re,ye,Ve,Qe,Le,Ne;if(!u)return console.log("No current step provided"),null;if(u.gameType||u.type==="game")return console.log("This is a game step, not an exercise"),null;if(!["exercise","practice","data_analysis","fraction_visual","geometry","geometry_poly","chem_mixing","chem_matching","english_sentence_fix","english_sentence_order","language_noun_bag","histogram","map","block-coding","explanation","language_tone_transformer","language_idiom_bridge","language_word_constellation","language_rhythm_match","language_false_friends"].includes(u.type))return console.log(`Step type ${u.type} is not a recognized exercise type`),null;let I=[];try{if(console.log("Processing step:",u),console.log("Step.data:",u.data),console.log("Step.data is array?",Array.isArray(u.data)),console.log("Step.data.length:",(X=u.data)==null?void 0:X.length),console.log("Step.data contents:",u.data?JSON.stringify(u.data,null,2):"N/A"),console.log("Step.content:",u.content),console.log("Step.content.type:",(G=u.content)==null?void 0:G.type),console.log("Step keys:",Object.keys(u)),Array.isArray(u.data)&&u.data.length>0?(console.log("Found exercises directly in data array, length:",u.data.length),I=u.data):(re=u.data)!=null&&re.exercises&&Array.isArray(u.data.exercises)?(console.log("Found exercises in data.exercises"),I=u.data.exercises):(ye=u.content)!=null&&ye.exercises&&Array.isArray(u.content.exercises)?(console.log("Found exercises in content.exercises"),I=u.content.exercises):u.exercises&&Array.isArray(u.exercises)?(console.log("Found exercises in step.exercises"),I=u.exercises):(Ve=u.data)!=null&&Ve.question||(Qe=u.data)!=null&&Qe.type?(console.log("Found single exercise in data (by question or type)"),I=[u.data]):(Le=u.content)!=null&&Le.question||(Ne=u.content)!=null&&Ne.type?(console.log("Found single exercise in content (by question or type)"),I=[u.content]):u.question?(console.log("Found single exercise as step itself"),I=[u]):(console.log("Step is the exercise itself (new interactive type)"),I=[u]),console.log(`Found ${I.length} exercises`),I.length===0)return console.warn("No exercises found in step"),null;s.value>=I.length&&(console.log("Resetting exercise index from",s.value,"to 0"),s.value=0);const Fe=I[s.value];return console.log("Returning exercise:",Fe),Fe&&$(Fe),F(Fe),Fe||null}catch(Fe){return console.error("Error in getCurrentExercise:",Fe),null}},A=u=>{if(!u||u.type!=="quiz")return null;let y=[];try{const I=u.data||u.content;return Array.isArray(I)?y=I:I&&Array.isArray(I.quizzes)?y=I.quizzes:I&&I.content&&Array.isArray(I.content.questions)?y=I.content.questions:I&&I.question&&(y=[I]),y.length===0?null:(t.value>=y.length&&(t.value=0),y[t.value]||null)}catch{return null}},z=u=>{if(!u||!["exercise","practice","data_analysis","fraction_visual","geometry","geometry_poly","chem_mixing","chem_matching","english_sentence_fix","english_sentence_order","language_noun_bag","histogram","map","block-coding"].includes(u.type))return 0;try{let I=[];const X=u.data||u.content;if(Array.isArray(X))I=X;else if(X&&Array.isArray(X.exercises))I=X.exercises;else if(X&&X.content&&Array.isArray(X.content.exercises))I=X.content.exercises;else return 1;return I.length}catch{return 0}},Z=u=>{if(!u||u.type!=="quiz")return 0;try{let y=[];const I=u.data||u.content;return Array.isArray(I)?y=I:I&&Array.isArray(I.quizzes)?y=I.quizzes:I&&I.content&&Array.isArray(I.content.questions)&&(y=I.content.questions),y.length}catch{return 0}},pe=u=>{const y=z(u);return s.value>=y-1},Ae=u=>{const y=Z(u);return t.value>=y-1},We=(u,y)=>{pe(u)?(j(),y()):(s.value++,at(),He(oe(u)))},ot=(u,y)=>{Ae(u)?(j(),y()):(t.value++,at())},He=u=>{if(u)switch(u.type){case"fill-blank":rt(u);break;case"ordering":Ke(u);break;case"drag-drop":st(u);break;case"matching":it();break;case"short-answer":const y=$(u);y.length>1&&(a.value=new Array(y.length).fill(""));break}},rt=u=>{if(!u){g.value=[];return}let y=0;if(u.blanks&&Array.isArray(u.blanks))y=u.blanks.length;else{const I=u.template||u.question||"",X=I.match(/_+/g)||[],G=I.match(/\[blank\]/gi)||[],re=I.match(/\{[^}]*\}/g)||[];y=Math.max(X.length,G.length,re.length)}g.value=new Array(Math.max(1,y)).fill("")},Ke=u=>{if(!u||u.type!=="ordering"||!Array.isArray(u.items)){v.value=[];return}const y=u.items.map((G,re)=>({id:`item_${re}_${Math.random()}`,text:typeof G=="string"?G:(G==null?void 0:G.text)||String(G),originalIndex:re}));let I=[...y],X=0;for(;X<10&&JSON.stringify(I.map(G=>G.originalIndex))===JSON.stringify(y.map(G=>G.originalIndex));)I.sort(()=>Math.random()-.5),X++;v.value=I},st=u=>{Object.keys(c).forEach(y=>{delete c[y]}),b.value=[],C.value=[],!(!u||u.type!=="drag-drop")&&(u.dragItems&&Array.isArray(u.dragItems)&&(b.value=u.dragItems.map(y=>typeof y=="string"?{text:y,id:y}:y&&y.text?y:{text:String(y),id:String(y)})),u.dropZones&&Array.isArray(u.dropZones)&&(C.value=u.dropZones.map(y=>typeof y=="string"?{label:y,id:y,correctItems:[]}:y&&y.label?{label:y.label,id:y.id||y.label,correctItems:y.correctItems||y.items||[]}:{label:String(y),id:String(y),correctItems:[]}),C.value.forEach(y=>{c[y.id]=[]})))},it=()=>{o.value=[],k.value=null,typeof window<"u"&&(window.matchingShuffleCache=null)},dt=(u,y)=>{if(!y){a.value=u;return}switch(y.type){case"matching":o.value=u||[],a.value=u||[];break;case"ordering":v.value=u||[],a.value=u||[];break;case"fill-blank":break;case"short-answer":$(y).length>1&&Array.isArray(u),a.value=u;break;default:a.value=u}},Ye=(u,y)=>{for(Array.isArray(g.value)||(g.value=[]);g.value.length<=u;)g.value.push("");const I=typeof y=="object"&&(y!=null&&y.target)?y.target.value:y;g.value[u]=I||"",g.value=[...g.value]},vt=()=>a.value||g.value||o.value||v.value,kt=u=>{k.value=u},je=u=>{if(u>=0&&u<o.value.length){const y=o.value.filter((I,X)=>X!==u);o.value=y,a.value=y}},ft=({item:u,event:y})=>{x.value=u},pt=u=>{m.value=u},_t=()=>{m.value=null},ht=({zoneId:u,item:y})=>{c[u]||(c[u]=[]);const I=typeof y=="string"?y:(y==null?void 0:y.text)||(y==null?void 0:y.label)||String(y);Object.keys(c).forEach(G=>{G!==u&&Array.isArray(c[G])&&(c[G]=c[G].filter(re=>(typeof re=="string"?re:(re==null?void 0:re.text)||(re==null?void 0:re.label)||String(re))!==I))}),c[u].some(G=>(typeof G=="string"?G:(G==null?void 0:G.text)||(G==null?void 0:G.label)||String(G))===I)||c[u].push(y),x.value=null,m.value=null},Ct=({zoneId:u,itemIndex:y,item:I})=>{c[u]&&c[u][y]&&c[u].splice(y,1)},$t=()=>{w.value="Read the question carefully and think about the correct answer."},St=()=>{P.value=""},It=u=>{P.value=u},ct=()=>{T.value=0,E.value=!1},at=()=>{a.value=null,l.value="",_.value=!1,w.value="",P.value="",ct()},ut=()=>{g.value=[],o.value=[],k.value=null,v.value=[],b.value=[],C.value=[],Object.keys(c).forEach(u=>{delete c[u]})},j=()=>{s.value=0,t.value=0,at(),ut(),ct()};return{currentExerciseIndex:s,currentQuizIndex:t,userAnswer:a,confirmation:l,answerWasCorrect:_,currentHint:w,smartHint:P,fillBlankAnswers:g,matchingPairs:o,selectedMatchingItem:k,orderingItems:v,dragDropPlacements:c,availableDragItems:b,dropZones:C,draggedDragItem:x,dropOverZone:m,attemptCount:T,maxAttempts:L,showCorrectAnswer:E,isOnSecondChance:M,getCurrentExercise:oe,getCurrentQuiz:A,getTotalExercises:z,getTotalQuizzes:Z,isLastExercise:pe,isLastQuiz:Ae,goToNextExercise:We,goToNextQuiz:ot,setCurrentExercise:F,detectQuestionsFromExercise:$,validateCurrentAnswer:Q,validateQuizAnswer:q,validateShortAnswer:ee,validateMultipleChoice:se,validateTrueFalse:ce,validateFillBlank:ge,validateMatching:_e,validateOrdering:Y,validateDragDrop:V,submitAnswer:p,submitQuizAnswer:D,initializeCurrentExerciseData:He,initializeFillBlankAnswers:rt,initializeOrderingItems:Ke,initializeDragDropItems:st,initializeMatchingItems:it,updateUserAnswer:dt,updateFillBlankAnswer:Ye,getCurrentUserAnswer:vt,handleMatchingSelection:kt,removeMatchingPair:je,handleDragItemStart:ft,handleDragOverZone:pt,handleDragLeaveZone:_t,handleDropInZone:ht,handleRemoveDroppedItem:Ct,getCorrectAnswerDisplay:ae,getMatchingFeedback:me,getRandomSuccessMessage:te,getSecondChanceMessage:U,getFinalFailureMessage:fe,showHint:$t,clearSmartHint:St,setSmartHint:It,resetExerciseState:j,resetExerciseAnswers:at,resetExerciseData:ut,resetAttemptState:ct,getCurrentExerciseType:u=>(u==null?void 0:u.type)||"short-answer",getFormattedFillBlankTemplate:u=>{if(!u||u.type!=="fill-blank")return"";const y=u.template||u.question||"";let I=0;return y.replace(/\[blank\]/gi,()=>`<input data-blank-index="${I++}">`).replace(/_+/g,()=>`<input data-blank-index="${I++}">`).replace(/\{[^}]*\}/g,()=>`<input data-blank-index="${I++}">`)},getLeftItemsArray:u=>{if(!(u!=null&&u.pairs))return[];const y=u.pairs;return Array.isArray(y)?y.map((I,X)=>{let G="";return Array.isArray(I)?G=String(I[0]||""):I&&typeof I=="object"?G=String(I.left||I[0]||I.question||I.term||""):G=String(I||""),{text:G,originalIndex:X}}).filter(I=>I.text.trim()!==""):[]},getRightItemsArray:u=>{if(!(u!=null&&u.pairs))return[];const y=u.pairs;if(Array.isArray(y)){const I=y.map((X,G)=>{let re="";return Array.isArray(X)?re=String(X[1]||""):X&&typeof X=="object"?re=String(X.right||X[1]||X.answer||X.definition||""):re=String(X||""),{text:re,originalIndex:G}}).filter(X=>X.text.trim()!=="");return ie(I)}return[]},calculateSimilarity:W,levenshteinDistance:N,getCorrectAnswersArray:R,shuffleArray:ie,isArrayInOriginalOrder:S,forceReshuffleRightItems:()=>!0}}function Fs(){const s=f(!1),t=f("free"),n=f(!1),a=f(null),g=O(()=>{const M=t.value,$=["premium","start","pro"];return $.includes(M)||$.includes(localStorage.getItem("subscriptionPlan"))}),o=O(()=>M=>!M||M==="free"?!0:M!=="premium"||g.value),v=async()=>{var M;try{n.value=!0,a.value=null;const $=wt.currentUser;if(!$)throw new Error("User not authenticated");const W=$.uid||localStorage.getItem("firebaseUserId");if(!W)throw new Error("No user ID available");const N=c();if(N&&N!=="unknown")return t.value=N,N;const ie=await Is(W);if(ie.success){const S=ie.status||((M=ie.data)==null?void 0:M.subscriptionPlan)||"free";return t.value=S,localStorage.setItem("subscriptionPlan",S),localStorage.setItem("statusLastChecked",Date.now().toString()),S}else throw new Error(ie.error||"Failed to get user status")}catch($){a.value=$.message;const W=localStorage.getItem("subscriptionPlan")||"free";return t.value=W,W}finally{n.value=!1}},c=()=>{const M=[()=>localStorage.getItem("subscriptionPlan"),()=>sessionStorage.getItem("userStatus"),()=>{var $,W;try{const N=window.__VUE_STORE__;return(W=($=N==null?void 0:N.state)==null?void 0:$.user)==null?void 0:W.subscriptionPlan}catch{return null}}];for(const $ of M)try{const W=$();if(W&&W!=="null"&&W!=="undefined")return W}catch{continue}return null},l=async M=>{try{if(!M)throw new Error("Lesson data not provided");const $=M.type||"free";return $==="free"?{hasAccess:!0,reason:"free_lesson"}:wt.currentUser?(await v(),$==="premium"&&!g.value?{hasAccess:!1,reason:"premium_required"}:{hasAccess:!0,reason:"premium_user"}):{hasAccess:!1,reason:"not_authenticated"}}catch($){return{hasAccess:!1,reason:"validation_error",error:$.message}}},_=(M,$="premium")=>{switch(M){case"not_authenticated":return{action:"redirect",path:"/login"};case"premium_required":return s.value=!0,{action:"paywall"};case"validation_error":return{action:"error",message:"Access validation error"};default:return s.value=!0,{action:"paywall"}}},w=()=>({plan:t.value,isPremium:g.value,features:P(t.value),upgradeOptions:k(t.value)}),P=M=>{const $={free:["Access to free lessons","Basic progress statistics","Progress saving"],start:["All Free features","Access to premium lessons","Detailed analytics","Homework assignments","AI assistant (limited)"],pro:["All Start features","Unlimited AI assistant","Personalized recommendations","Priority support","Extended statistics"]};return $[M]||$.free},k=M=>M==="free"?[{plan:"start",price:"260,000 sum",popular:!0},{plan:"pro",price:"455,000 sum",premium:!0}]:M==="start"?[{plan:"pro",price:"195,000 sum",upgrade:!0}]:[],b=()=>{localStorage.removeItem("subscriptionPlan"),localStorage.removeItem("statusLastChecked"),sessionStorage.removeItem("userStatus"),t.value="free"};return{showPaywallModal:s,userStatus:t,isCheckingStatus:n,statusError:a,isPremiumUser:g,canAccessLesson:o,checkUserStatus:v,validateLessonAccess:l,handleAccessDenied:_,getSubscriptionInfo:w,getFeaturesByPlan:P,getUpgradeOptions:k,clearStatusCache:b,isStatusCacheValid:()=>{const M=localStorage.getItem("statusLastChecked");if(!M)return!1;const $=Date.now()-parseInt(M),W=15*60*1e3;return $<W},refreshStatus:async()=>(b(),await v()),closePaywallModal:()=>{s.value=!1},goToUpgrade:(M="start")=>(s.value=!1,{action:"navigate",path:`/pay/${M}`}),simulatePremiumAccess:()=>{},simulateFreeAccess:()=>{}}}function Bs(){const s=f(!1),t=f(!1),n=f(null),a=f(!1),g=f([]),o=f(null),v=gt({speechRate:.8,speechPitch:1,speechVolume:1,language:"en-US",autoPlay:!1,pronunciation:!0}),c=()=>{try{if("speechSynthesis"in window){a.value=!0;const S=()=>{const R=speechSynthesis.getVoices();g.value=R;const ee=R.find(se=>se.lang.startsWith(v.language.substring(0,2)))||R[0];ee&&(o.value=ee)};speechSynthesis.getVoices().length>0?S():speechSynthesis.addEventListener("voiceschanged",S)}else a.value=!1}catch(S){a.value=!1,n.value=S.message}},l=async(S,R={})=>{var ee;if(!a.value||!S||typeof S!="string")return!1;try{s.value=!0,n.value=null,speechSynthesis.cancel();const se=new SpeechSynthesisUtterance(S.trim());return se.rate=R.rate||v.speechRate,se.pitch=R.pitch||v.speechPitch,se.volume=R.volume||v.speechVolume,se.lang=R.language||v.language,o.value&&(se.voice=o.value),se.onstart=()=>{s.value=!0},se.onend=()=>{s.value=!1},se.onerror=ce=>{n.value=ce.error,s.value=!1},speechSynthesis.speak(se),M("word_pronounced",{word:S,language:se.lang,voice:(ee=o.value)==null?void 0:ee.name}),!0}catch(se){return n.value=se.message,s.value=!1,!1}},_=async(S,R={})=>{if(!S)return!1;try{const ee=L(S),se=E(ee,R.chunkSize||100);for(const ce of se)await l(ce,R),se.length>1&&await new Promise(ge=>setTimeout(ge,500));return!0}catch{return!1}},w=async(S,R={})=>{if(!S)return!1;try{t.value=!0,n.value=null;const ee=new Audio(S);return ee.volume=R.volume||v.speechVolume,ee.playbackRate=R.playbackRate||1,ee.addEventListener("loadstart",()=>{}),ee.addEventListener("canplay",()=>{t.value=!1}),ee.addEventListener("play",()=>{s.value=!0}),ee.addEventListener("ended",()=>{s.value=!1}),ee.addEventListener("error",se=>{var ge;const ce=`Audio error: ${((ge=se.target.error)==null?void 0:ge.message)||"Unknown error"}`;n.value=ce,t.value=!1,s.value=!1}),await ee.play(),M("audio_played",{url:S,duration:ee.duration}),!0}catch(ee){return n.value=ee.message,t.value=!1,s.value=!1,!1}},P=()=>{try{speechSynthesis.speaking&&speechSynthesis.cancel(),document.querySelectorAll("audio").forEach(S=>{S.paused||(S.pause(),S.currentTime=0)}),s.value=!1}catch{}},k=()=>{try{speechSynthesis.speaking&&speechSynthesis.pause&&speechSynthesis.pause(),document.querySelectorAll("audio").forEach(S=>{S.paused||S.pause()}),s.value=!1}catch{}},b=()=>{try{speechSynthesis.paused&&speechSynthesis.resume&&speechSynthesis.resume(),document.querySelectorAll("audio").forEach(S=>{S.paused&&S.currentTime>0&&S.play()}),s.value=!0}catch{}},C=S=>{Object.assign(v,S),S.language&&S.language!==v.language&&c()},x=S=>{const R=g.value.find(ee=>ee.name===S);return R?(o.value=R,!0):!1},m=()=>{const S=new Set;return g.value.forEach(R=>{S.add(R.lang)}),Array.from(S).sort()},T=S=>g.value.filter(R=>R.lang.startsWith(S.substring(0,2))),L=S=>S.replace(/[^\w\s.,!?;:-]/g,"").replace(/\s+/g," ").trim(),E=(S,R=100)=>{if(S.length<=R)return[S];const ee=[],se=S.split(/[.!?]+/);let ce="";for(const ge of se)ce.length+ge.length<=R?ce+=ge+". ":(ce&&ee.push(ce.trim()),ce=ge+". ");return ce&&ee.push(ce.trim()),ee},M=(S,R={})=>{},$={en:{cleanText:S=>S.replace(/[^\w\s.,!?;:-]/g,""),getPhonetics:S=>null},ru:{cleanText:S=>S.replace(/[^\u0400-\u04FF\w\s.,!?;:-]/g,""),getPhonetics:S=>null},uz:{cleanText:S=>S.replace(/[^\u0100-\u017F\w\s.,!?;:-]/g,""),getPhonetics:S=>null}};return{isPlaying:s,isLoading:t,soundError:n,speechSupported:a,speechVoices:g,currentVoice:o,soundSettings:v,initializeSpeech:c,pronounceWord:l,pronounceSentence:_,playAudioFile:w,stopSound:P,pauseSound:k,resumeSound:b,updateSoundSettings:C,setVoice:x,getAvailableLanguages:m,getVoicesForLanguage:T,cleanTextForSpeech:L,splitTextIntoChunks:E,trackSoundEvent:M,getPronunciationHelper:(S="en")=>{const R=S.substring(0,2);return $[R]||$.en},pronounceWithPhonetics:async(S,R)=>{if(!R)return await l(S);try{const ee=`<phoneme alphabet="ipa" ph="${R}">${S}</phoneme>`;return await l(ee)}catch{}},pronounceWithSSML:async S=>{if(!a.value)return!1;try{const R=new SpeechSynthesisUtterance;return R.text=S,R.rate=v.speechRate,R.pitch=v.speechPitch,R.volume=v.speechVolume,o.value&&(R.voice=o.value),speechSynthesis.speak(R),!0}catch{return!1}}}}function Ns(){const s=f(!1),t=f(""),n=f(""),a=f(!1),g=f([]),o=f(""),v=f([]),c=f(""),l=f(!1),_=f(!1),w=f(""),P=f([]),k=f(null),b=f(""),C=gt({maxChatHistory:10,hintThreshold:2,suggestionRefreshInterval:5e3,usageCheckInterval:6e4,enableSmartHints:!0,enableProgressInsights:!0}),x=async()=>{try{await ee()}catch{}},m=async(ae,p)=>{if(t.value.trim())try{if(a.value=!0,n.value="",typeof Ht=="function"){const D=await Ht(ae,t.value.trim(),p||{});n.value=D,q("explanation_requested",{question:t.value,hasResponse:!!D,responseLength:(D==null?void 0:D.length)||0}),t.value=""}else throw new Error("Explanation help service not available")}catch{n.value="Unable to get help. Please try again."}finally{a.value=!1}},T=()=>{s.value=!1,t.value="",n.value=""},L=()=>{s.value=!s.value,s.value||T()},E=async(ae,p,D)=>{if(!o.value.trim()||l.value)return;const F=o.value.trim();o.value="",l.value=!0,ce("user",F);try{if(typeof Dt=="function"){const oe=await Dt(F,ae||{},p||{},D||{});ce("ai",oe),await Promise.all([W(D,p),ee()]),q("chat_message_sent",{messageLength:F.length,responseLength:(oe==null?void 0:oe.length)||0,chatHistorySize:g.value.length})}else throw new Error("AI chat service not available")}catch{ce("ai","Sorry, an error occurred. Please try again.")}finally{l.value=!1}},M=async(ae,p,D)=>{!w.value.trim()||l.value||(o.value=w.value,w.value="",await E(ae,p,D))},$=async(ae,p,D,F)=>{o.value=ae,await E(p,D,F)},W=async(ae,p)=>{try{if(typeof Pt=="function"){const D=await Pt(ae,p);Array.isArray(D)&&(v.value=D,P.value=D.slice(0,3),q("suggestions_generated",{count:D.length,stepType:ae==null?void 0:ae.type}))}}catch{}},N=async(ae,p)=>{await W(ae,p)},ie=async(ae,p,D)=>{if(!(!C.enableSmartHints||p<C.hintThreshold))try{if(typeof Ot=="function"){const F=await Ot(ae,p,D);F&&F.trim()&&(c.value=F,q("smart_hint_generated",{mistakeCount:p,hintLength:F.length,exerciseType:ae==null?void 0:ae.type}))}}catch{}},S=()=>{c.value=""},R=async(ae,p)=>{var D;if(C.enableProgressInsights)try{if(typeof Nt=="function"){const F=await Nt(ae,p);F&&F.trim()&&(b.value=F,q("progress_insight_generated",{progressData:{completedSteps:((D=ae==null?void 0:ae.completedSteps)==null?void 0:D.length)||0,mistakes:(ae==null?void 0:ae.mistakes)||0,stars:(ae==null?void 0:ae.stars)||0}}))}}catch{}},ee=async()=>{var ae;try{if(typeof Bt=="function"){const p=await Bt();p.success&&(k.value=As(p.usage,p.plan),q("usage_loaded",{plan:p.plan,messages:((ae=p.usage)==null?void 0:ae.messages)||0}))}}catch{}},se=()=>{if(!k.value)return{allowed:!0,reason:"unknown"};const ae=k.value.plan||"free",p=k.value.messages||0,D={free:50,start:200,pro:1/0},F=D[ae]||D.free;return p>=F?{allowed:!1,reason:"limit_reached",limit:F,usage:p}:{allowed:!0,remaining:F-p,limit:F,usage:p}},ce=(ae,p)=>{const D={id:Date.now()+Math.random(),type:ae,content:p,timestamp:new Date().toISOString()};g.value.push(D),g.value.length>C.maxChatHistory&&(g.value=g.value.slice(-C.maxChatHistory))},ge=()=>{g.value=[]},_e=()=>{const ae={messages:g.value,exportedAt:new Date().toISOString(),settings:C},p=new Blob([JSON.stringify(ae,null,2)],{type:"application/json"}),D=URL.createObjectURL(p),F=document.createElement("a");F.href=D,F.download=`ai-chat-history-${Date.now()}.json`,F.click(),URL.revokeObjectURL(D)},Y=()=>{_.value=!_.value,_.value&&W()},V=()=>{_.value=!1},Q=ae=>{Object.assign(C,ae)},H=()=>{Object.assign(C,{maxChatHistory:10,hintThreshold:2,suggestionRefreshInterval:5e3,usageCheckInterval:6e4,enableSmartHints:!0,enableProgressInsights:!0})},q=(ae,p={})=>{};return{showExplanationHelp:s,explanationQuestion:t,explanationAIResponse:n,isLoadingExplanation:a,aiChatHistory:g,aiChatInput:o,aiSuggestions:v,smartHint:c,aiIsLoading:l,showFloatingAI:_,floatingAIInput:w,quickSuggestions:P,aiUsage:k,progressInsight:b,aiSettings:C,initializeAI:x,askAboutExplanation:m,clearExplanationHelp:T,toggleExplanationHelp:L,sendAIMessage:E,sendFloatingAIMessage:M,askAI:$,generateAISuggestions:W,refreshSuggestions:N,generateSmartHintForMistakes:ie,clearSmartHint:S,generateProgressInsightForLesson:R,loadAIUsage:ee,checkUsageLimit:se,addToAIChatHistory:ce,clearAIChatHistory:ge,exportChatHistory:_e,toggleFloatingAI:Y,closeFloatingAI:V,updateAISettings:Q,resetAISettings:H,trackAIEvent:q,getAIAnalytics:()=>({chatHistorySize:g.value.length,suggestionsCount:v.value.length,hintsGenerated:c.value?1:0,insightsGenerated:b.value?1:0,usage:k.value,settings:C}),formatAIResponse:ae=>ae?ae.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>").trim():"",truncateMessage:(ae,p=100)=>!ae||ae.length<=p?ae:ae.substring(0,p).trim()+"...",isAIServiceAvailable:()=>typeof Dt=="function"&&typeof Pt=="function"}}function Os(){const s=f({}),t=f([]),n=f(0),a=f(!1),g=f(!0),o=f(null),v=f(0),c=f(!1),l=f(!1),_=f(3),w=f(0),P=f(0),k=f(0),b=f(0),C=f(!1),x=f([]),m=f(null),T=f(!1),L=f(0),E=f(null),M=f(null),$=f(!1),W=f(!1),N=f(""),ie=f(null),S=Qt(),R=Yt(),ee=()=>{const j=S.query.guest==="true",ne=!!localStorage.getItem("authToken"),le=!!wt.currentUser,Ce=S.query.type==="free";return j||!ne&&!le||Ce},se=()=>{try{const j=JSON.parse(localStorage.getItem("guestLessonData")||"{}"),ne=s.value._id;j.viewedLessons||(j.viewedLessons=[]),j.viewedLessons.includes(ne)||(j.viewedLessons.push(ne),j.lastViewed=Date.now()),localStorage.setItem("guestLessonData",JSON.stringify(j)),w.value=j.viewedLessons.length}catch{}},ce=()=>{var j;if(!c.value)return!1;try{return(((j=JSON.parse(localStorage.getItem("guestLessonData")||"{}").viewedLessons)==null?void 0:j.length)||0)>=_.value}catch{return!1}},ge=O(()=>t.value[n.value]||null),_e=O(()=>ge.value&&["exercise","practice","quiz","data_analysis","fraction_visual","geometry","geometry_poly","chem_mixing","chem_matching","english_sentence_fix","english_sentence_order","language_noun_bag","histogram","map","block-coding","language_tone_transformer","language_idiom_bridge","language_word_constellation","language_rhythm_match","language_false_friends"].includes(ge.value.type)),Y=O(()=>{if(t.value.length===0)return 0;const j=Math.min(n.value+1,t.value.length);return Math.floor(j/t.value.length*100)}),V=O(()=>{const j=Math.floor(L.value/60),ne=L.value%60;return`${j}:${ne<10?"0":""}${ne}`}),Q=O(()=>{const j=Math.floor(L.value/60),ne=L.value%60;return`${j} min ${ne} sec`}),H=O(()=>n.value>=t.value.length-1),q=O(()=>{var j;return((j=s.value.metadata)==null?void 0:j.estimatedDuration)||Math.max(5,t.value.length*2)}),te=O(()=>{if(!c.value)return!0;const ne=(s.value.type||S.query.type||"free")==="free",le=!ce();return ne||le}),U=O(()=>{if(!c.value)return"";const j=Math.max(0,_.value-w.value);return j===0?"You have reached the limit of free lessons. Register to continue!":j<=2?`You have ${j} free lessons remaining. Register for unlimited access!`:""}),fe=async()=>{if(!ee()&&!wt.currentUser)return new Promise(j=>{const ne=wt.onAuthStateChanged(le=>{if(ne(),le)try{const Ce=window.$store||window.__VUE_STORE__;Ce&&Ce.commit&&Ce.commit("user/setUser",{uid:le.uid,email:le.email,displayName:le.displayName})}catch{}j()});setTimeout(()=>{ne(),j()},5e3)})},me=async()=>{try{const j=S.params.id;if(!j||j==="null"||j==="undefined")throw new Error("Invalid lesson ID");g.value=!0,o.value=null,c.value=ee();const ne=await Ms(()=>Ls(j),"Load lesson");let le=null;if(ne.success)le=ne.lesson||ne.data;else if(ne.lesson)le=ne.lesson;else if(ne._id||ne.lessonName)le=ne;else throw new Error("Invalid lesson response format");if(!le||!le._id)throw new Error("Lesson data is invalid or missing");if(s.value=le,c.value){const Ce=s.value.type||S.query.type||"free";if(Ce!=="free"&&Ce!=="public"){l.value=!0,o.value="This lesson is only available to registered users",g.value=!1;return}if(ce()){l.value=!0,o.value="You have reached the limit of free lessons",g.value=!1;return}se()}ae(),t.value.length===0&&(t.value=[{type:"explanation",data:{content:s.value.description||"Lesson content not available"}}])}catch(j){o.value=ht(j),v.value++}finally{g.value=!1}},ae=()=>{if(t.value=[],!s.value.steps||!Array.isArray(s.value.steps)){Z();return}s.value.steps.forEach((j,ne)=>{var Ce,Ue,Ge;if(!j||typeof j!="object")return;j.type||(j.type="explanation");let le={...j};try{switch(j.type){case"exercise":case"practice":le=p(j,ne);break;case"quiz":le=D(j,ne);break;case"vocabulary":le=F(j,ne);break;case"game":le=A(j,ne);break;case"data_analysis":case"fraction_visual":case"geometry":case"geometry_poly":case"chem_mixing":case"chem_matching":case"english_sentence_fix":case"english_sentence_order":case"language_noun_bag":case"histogram":case"map":case"block-coding":case"language_tone_transformer":case"language_idiom_bridge":case"language_word_constellation":case"language_rhythm_match":case"language_false_friends":le=oe(j,ne);break;case"explanation":case"example":case"reading":default:le=z(j,ne)}le.data||(le.data={content:`Content for ${j.type} step ${ne+1}`}),console.log(`Step ${ne}: type=${le.type}`,le);let u=le.type==="map"||le.type==="geography";!u&&((Ce=le.title)!=null&&Ce.includes("Geography")||(Ue=le.prompt)!=null&&Ue.includes("Geography"))&&(u=!0,console.log("Filtered map by title/prompt")),!u&&le.type==="exercise"&&(Array.isArray(le.data)?u=le.data.some(y=>{var X;const I=y.type==="map"||y.type==="geography"||((X=y.content)==null?void 0:X.type)==="map";return I&&console.log("Found map in array:",y),I}):le.data&&typeof le.data=="object"&&(u=le.data.type==="map"||le.data.type==="geography"||((Ge=le.data.content)==null?void 0:Ge.type)==="map",u&&console.log("Found map in object:",le.data))),u?console.log("Filtered out map step:",le):t.value.push(le)}catch(u){t.value.push({type:"explanation",data:{content:`Error loading step ${ne+1}: ${u.message}`,error:!0}})}}),t.value.length===0&&t.value.push({type:"explanation",data:{content:s.value.description||"Lesson temporarily unavailable"}})},p=(j,ne)=>({type:"exercise",data:j.data||j.exercises||[]}),D=(j,ne)=>({type:"quiz",data:j.data||j.questions||[]}),F=(j,ne)=>({type:"vocabulary",data:j.data||j.words||[]}),oe=(j,ne)=>{let le=j.data||j;return Array.isArray(le)&&(le={data:le,...j}),{type:j.type,data:le,...j}},A=(j,ne)=>{var Ue;const le=j.data||j.content||{};let Ce=j.gameType||le.gameType||((Ue=le.gameConfig)==null?void 0:Ue.gameType);return Ce||(le.items&&le.items.length>0?Ce="whack-a-mole":le.questions&&le.questions.length>0&&(Ce="basket-catch")),Ce&&(le.gameType=Ce),j.gameConfig&&(le.gameConfig=j.gameConfig),{type:"game",gameType:Ce,gameConfig:j.gameConfig||le.gameConfig,data:le,metadata:j.metadata||{}}},z=(j,ne)=>{var Ce;let le="";return typeof j.content=="string"?le=j.content:j.data&&typeof j.data.text=="string"&&(le=j.data.text),{type:j.type,data:{content:le,questions:j.questions||((Ce=j.data)==null?void 0:Ce.questions)||[]}}},Z=()=>{Array.isArray(s.value.explanations)&&s.value.explanations.forEach(j=>{t.value.push({type:"explanation",data:{content:typeof j=="string"?j:j.content||""}})}),Array.isArray(s.value.examples)&&s.value.examples.forEach(j=>{t.value.push({type:"example",data:{content:typeof j=="string"?j:j.content||""}})}),Array.isArray(s.value.exercises)&&t.value.push({type:"exercise",data:s.value.exercises})},pe=async()=>{if(c.value){try{const ne=JSON.parse(localStorage.getItem("guestProgress")||"{}")[s.value._id];ne&&(m.value={completedSteps:ne.completedSteps||[],mistakes:ne.mistakes||0,stars:ne.stars||0,duration:ne.elapsedSeconds||0,currentStep:ne.currentStep||0})}catch{}return}if(!(!s.value._id||!ie.value))try{const j=await Es(ie.value,s.value._id);if(j.success&&j.data){const ne=j.data;ne.completedSteps&&ne.completedSteps.length>0?m.value={_id:ne._id,userId:ne.userId,lessonId:ne.lessonId,completedSteps:ne.completedSteps||[],accuracy:ne.accuracy||0,completed:ne.completed||!1,duration:ne.duration||0,mistakes:ne.mistakes||0,points:ne.points||0,stars:ne.stars||0,hintsUsed:ne.hintsUsed||0,medal:ne.medal||"none"}:m.value=null}else m.value=null}catch{m.value=null}},Ae=async(j=!1)=>{try{if(c.value){const Ge=JSON.parse(localStorage.getItem("guestProgress")||"{}"),u=[];if(a.value){const y=Math.min(n.value,t.value.length-1);for(let I=0;I<=y;I++)u.push(I)}return Ge[s.value._id]={lessonId:s.value._id,lessonName:s.value.lessonName||s.value.title,currentStep:n.value,completedSteps:u,mistakes:P.value,stars:k.value,elapsedSeconds:L.value,completed:j,timestamp:Date.now()},localStorage.setItem("guestProgress",JSON.stringify(Ge)),!0}if(!ie.value||!s.value._id)return!1;const ne=[];if(a.value){const Ge=Math.min(n.value,t.value.length-1);for(let u=0;u<=Ge;u++)ne.push(u)}const le=t.value.length>0?Math.floor(ne.length/t.value.length*100):0,Ce={userId:ie.value,lessonId:String(s.value._id),topicId:String(s.value.topicId||s.value._id),completedSteps:ne,progressPercent:le,completed:j,mistakes:P.value,medal:P.value===0?"gold":P.value<=2?"silver":"bronze",duration:L.value,stars:k.value,points:b.value,hintsUsed:C.value?1:0,submittedHomework:!1};return!!(await Ts(ie.value,Ce)).success}catch{return!1}},We=async()=>{try{await Ae(!1)||setTimeout(()=>We(),3e4)}catch{}},ot=()=>{a.value=!0,E.value=setInterval(()=>L.value++,1e3),c.value?M.value=setInterval(()=>Ae(!1),3e4):M.value=setInterval(()=>We(),15e3)},He=()=>{var j;m.value&&(n.value=Math.min(((j=m.value.completedSteps)==null?void 0:j.length)||m.value.currentStep||0,t.value.length-1),k.value=parseInt(m.value.stars)||0,P.value=parseInt(m.value.mistakes)||0,L.value=parseInt(m.value.duration)||0,C.value=!!m.value.hintsUsed,b.value=parseInt(m.value.points)||0),ot()},rt=()=>{H.value?st():n.value++},Ke=()=>{n.value>0&&n.value--},st=async()=>{pt(),T.value=!0,$.value=!0,b.value=Math.max(0,100-P.value*10+k.value*5),P.value===0?N.value="ðŸ¥‡ Gold Medal - Perfect!":P.value<=2?N.value="ðŸ¥ˆ Silver Medal - Excellent!":N.value="ðŸ¥‰ Bronze Medal - Good!",setTimeout(()=>_t(),200),await Ae(!0)},it=async()=>{v.value++,await me()},dt=()=>{W.value=!0},Ye=()=>{W.value=!1},vt=()=>{W.value=!1,E.value&&clearInterval(E.value),a.value&&!T.value&&Ae(),window.history.length>1?R.back():R.push("/profile/catalogue")},kt=()=>{l.value=!0},je=()=>{l.value=!1},ft=()=>{R.push({name:"HomePage",query:{openLogin:"true",returnTo:S.fullPath}})},pt=()=>{E.value&&(clearInterval(E.value),E.value=null),M.value&&(clearInterval(M.value),M.value=null)},_t=()=>{setTimeout(()=>$.value=!1,5e3)},ht=j=>{var ne,le,Ce,Ue,Ge,u;return(ne=j.message)!=null&&ne.includes("not found")?"Lesson not found. Check the link or try reloading the page.":(le=j.message)!=null&&le.includes("Invalid lesson ID")?"Invalid lesson ID. Please check the link.":(Ce=j.message)!=null&&Ce.includes("Authentication")&&!c.value?"You need to log in to access this lesson.":(Ue=j.message)!=null&&Ue.includes("premium")||(Ge=j.message)!=null&&Ge.includes("subscription")?"This lesson is only available to subscribers. Register to get access!":(u=j.message)!=null&&u.includes("limit")?"You have reached the limit of free lessons. Register to continue learning!":j.message||"An error occurred while loading the lesson."},Ct=j=>({explanation:"ðŸ“š",example:"ðŸ’¡",reading:"ðŸ“–",exercise:"âœï¸",practice:"ðŸ§ª",quiz:"ðŸ§©",vocabulary:"ðŸ“",video:"ðŸŽ¬",audio:"ðŸŽµ"})[j]||"ðŸ“„",$t=j=>({explanation:"Explanation",example:"Example",reading:"Reading",exercise:"Exercise",practice:"Practice",quiz:"Quiz",vocabulary:"Vocabulary",video:"Video",audio:"Audio"})[j]||"Content",St=()=>P.value===0?"ðŸ¥‡":P.value<=2?"ðŸ¥ˆ":"ðŸ¥‰",It=j=>j?j.replace(/\n/g,"<br>"):"Content unavailable",ct=j=>typeof j=="string"?j:((j==null?void 0:j.en)||(j==null?void 0:j.ru)||(j==null?void 0:j.uz)||"").replace(/^(en|ru|uz):/i,"").trim(),at=async()=>{var j;c.value=ee(),c.value||(await fe(),ie.value=localStorage.getItem("firebaseUserId")||localStorage.getItem("userId")||((j=wt.currentUser)==null?void 0:j.uid),ie.value||(c.value=!0)),await me(),o.value||await pe()},ut=()=>{pt(),a.value&&!T.value&&Ae(!1)};return nt(async()=>{await at()}),mt(()=>{ut()}),{lesson:s,steps:t,currentIndex:n,started:a,loading:g,error:o,retryCount:v,isGuestMode:c,showPaywallModal:l,guestLessonLimit:_,guestLessonsViewed:w,mistakeCount:P,stars:k,earnedPoints:b,hintsUsed:C,mistakeLog:x,previousProgress:m,lessonCompleted:T,elapsedSeconds:L,showConfetti:$,showExitModal:W,medalLabel:N,userId:ie,currentStep:ge,isInteractiveStep:_e,progressPercentage:Y,formattedTime:V,readableTime:Q,isLastStep:H,estimatedTime:q,canAccessLesson:te,guestAccessMessage:U,loadLesson:me,saveProgress:Ae,startLesson:ot,continuePreviousProgress:He,goNext:rt,goPrevious:Ke,completeLesson:st,retryLoad:it,confirmExit:dt,cancelExit:Ye,exitLesson:vt,showRegistrationPrompt:kt,closePaywallModal:je,redirectToRegistration:ft,checkGuestMode:ee,trackGuestLessonView:se,checkGuestLimit:ce,getStepIcon:Ct,getStepTypeText:$t,getMedalIcon:St,formatContent:It,getLocalized:ct,initializeLesson:at,cleanup:ut}}const Hs={name:"VocabularyModal",props:{vocabularyData:{type:Object,required:!0,default:()=>({isVisible:!1,currentIndex:0,words:[],isCompleted:!1,showingList:!1})},cardAnimation:{type:Object,default:()=>({isFlipping:!1,showDefinition:!1})},currentWord:{type:Object,default:null},progress:{type:Number,default:0},isLastWord:{type:Boolean,default:!1}},emits:["show-definition","hide-definition","mark-learned","next-word","previous-word","skip","restart","close","pronounce","jump-to-word"],computed:{isDevelopment(){return!1},hasValidWords(){const t=this.getValidWords().length>0;return this.isDevelopment,t},currentDisplayWord(){var a;const s=this.getValidWords(),t=((a=this.vocabularyData)==null?void 0:a.currentIndex)||0,n=s[t]||this.currentWord||null;return this.isDevelopment,n},debugInfo(){var s,t,n,a,g,o,v,c,l;return this.isDevelopment?{vocabularyData:{isVisible:(s=this.vocabularyData)==null?void 0:s.isVisible,currentIndex:(t=this.vocabularyData)==null?void 0:t.currentIndex,wordsLength:(a=(n=this.vocabularyData)==null?void 0:n.words)==null?void 0:a.length,isCompleted:(g=this.vocabularyData)==null?void 0:g.isCompleted,showingList:(o=this.vocabularyData)==null?void 0:o.showingList,wordsStructure:(l=(c=(v=this.vocabularyData)==null?void 0:v.words)==null?void 0:c.slice(0,2))==null?void 0:l.map(_=>({keys:Object.keys(_||{}),hasTerms:!!(_!=null&&_.term||_!=null&&_.word),hasDefinition:!!(_!=null&&_.definition||_!=null&&_.translation)}))},currentWord:this.currentWord?{keys:Object.keys(this.currentWord),term:this.getWordTerm(this.currentWord),definition:this.getWordDefinition(this.currentWord)}:null,validWordsCount:this.getValidWordsCount(),hasValidWords:this.hasValidWords}:null}},methods:{getValidWords(){var t;return(((t=this.vocabularyData)==null?void 0:t.words)||[]).filter(n=>{if(!n||typeof n!="object")return!1;const a=this.getWordTerm(n),g=this.getWordDefinition(n);return!!(a&&g)})},getValidWordsCount(){return this.getValidWords().length},getLearnedWordsCount(){return this.getValidWords().filter(s=>s==null?void 0:s.learned).length},getCompletionPercentage(){const s=this.getValidWordsCount(),t=this.getLearnedWordsCount();return s>0?Math.round(t/s*100):0},getWordTerm(s){if(!s)return"";const t=s.term||s.word||s.title||s.name||"";return String(t).trim()},getWordDefinition(s){if(!s)return"Definition not found";const t=s.definition||s.translation||s.meaning||s.desc||s.description||"";return String(t).trim()||"Definition not found"},getWordExample(s){if(!s)return"";const t=s.example||s.examples||s.usage||"";return String(t).trim()},getWordPronunciation(s){if(!s)return"";const t=s.pronunciation||s.phonetic||"";return String(t).trim()},getWordPartOfSpeech(s){if(!s)return"";const t=s.partOfSpeech||s.pos||s.type||"";return String(t).trim()},getWordId(s,t){var n;return s?s.id||s._id||`vocab-${t}-${((n=this.getWordTerm(s))==null?void 0:n.substring(0,10))||"word"}`:`vocab-${t}`},jumpToWord(s){this.$emit("jump-to-word",s)}},mounted(){this.isDevelopment},watch:{vocabularyData:{handler(s){this.isDevelopment},deep:!0,immediate:!0}}},Us={class:"vocabulary-modal-container"},Gs={class:"vocabulary-modal-header"},Qs={class:"vocab-progress-section"},Ys={class:"vocab-progress-bar"},Js={class:"vocab-progress-text"},Zs={class:"vocab-header-actions"},Xs={key:0,class:"debug-info"},Ks={key:1,class:"vocabulary-card-container"},ea={class:"card-content"},ta={class:"vocab-term-section"},sa={class:"vocab-term"},aa={key:0,class:"vocab-pronunciation"},na={key:1,class:"vocab-part-of-speech"},oa={class:"card-content"},ra={class:"vocab-definition-section"},la={class:"vocab-term-small"},ia={class:"vocab-definition"},ca={key:0,class:"vocab-example"},ua={class:"vocab-card-actions"},da=["disabled"],va={class:"vocab-main-actions"},ga={class:"btn-icon"},ma={class:"btn-text"},fa={class:"btn-icon"},pa={class:"btn-text"},ha={class:"vocab-dots-navigation"},ba=["onClick","title"],ya={key:2,class:"no-vocabulary-content"},xa={class:"no-vocab-subtitle"},wa={key:0,class:"debug-words"},ka={key:3,class:"vocabulary-completion"},_a={class:"completion-animation"},Ca={class:"completion-subtitle"},$a={class:"completion-stats"},Sa={class:"completion-stat"},Ia={class:"stat-number"},Aa={class:"completion-stat"},Ta={class:"stat-number"},Ma={key:4,class:"vocabulary-list-transition"};function La(s,t,n,a,g,o){var v,c,l,_,w,P,k,b,C,x,m,T,L,E,M,$,W,N,ie;return r(),i("div",{class:"vocabulary-modal-overlay",onClick:t[12]||(t[12]=qe(S=>s.$emit("close"),["self"]))},[e("div",Us,[e("div",Gs,[e("div",Qs,[e("div",Ys,[e("div",{class:"vocab-progress-fill",style:xe({width:n.progress+"%"})},null,4)]),e("div",Js,d((((v=n.vocabularyData)==null?void 0:v.currentIndex)||0)+1)+" / "+d(o.getValidWordsCount()),1)]),e("div",Zs,[e("button",{onClick:t[0]||(t[0]=S=>s.$emit("skip")),class:"vocab-skip-btn",title:"Skip and go to list"},t[13]||(t[13]=[e("span",{class:"btn-icon"},"â­ï¸",-1),e("span",{class:"btn-text"},"Skip",-1)])),e("button",{onClick:t[1]||(t[1]=S=>s.$emit("close")),class:"vocab-close-btn",title:"Close vocabulary"}," âœ• ")])]),o.isDevelopment?(r(),i("div",Xs,[e("details",null,[t[14]||(t[14]=e("summary",null,"ðŸ” Debug Info",-1)),e("pre",null,d(o.debugInfo),1)])])):B("",!0),!((c=n.vocabularyData)!=null&&c.isCompleted)&&!((l=n.vocabularyData)!=null&&l.showingList)&&o.hasValidWords?(r(),i("div",Ks,[e("div",{class:J(["vocabulary-card",{flipped:(_=n.cardAnimation)==null?void 0:_.showDefinition,flipping:(w=n.cardAnimation)==null?void 0:w.isFlipping,learned:(P=o.currentDisplayWord)==null?void 0:P.learned}])},[e("div",{class:"card-front",onClick:t[3]||(t[3]=S=>s.$emit("show-definition"))},[e("div",ea,[e("div",ta,[e("h2",sa,d(o.getWordTerm(o.currentDisplayWord)),1),o.getWordPronunciation(o.currentDisplayWord)?(r(),i("div",aa," /"+d(o.getWordPronunciation(o.currentDisplayWord))+"/ ",1)):B("",!0),o.getWordPartOfSpeech(o.currentDisplayWord)?(r(),i("div",na,d(o.getWordPartOfSpeech(o.currentDisplayWord)),1)):B("",!0)]),t[15]||(t[15]=e("div",{class:"card-instruction"},[e("div",{class:"instruction-icon"},"ðŸ’«"),e("p",null,"Click to see definition")],-1))]),o.getWordTerm(o.currentDisplayWord)?(r(),i("button",{key:0,onClick:t[2]||(t[2]=qe(S=>s.$emit("pronounce",o.getWordTerm(o.currentDisplayWord)),["stop"])),class:"voice-btn",title:"Pronunciation"},t[16]||(t[16]=[e("span",{class:"voice-icon"},"ðŸ”Š",-1)]))):B("",!0)]),e("div",{class:"card-back",onClick:t[5]||(t[5]=S=>s.$emit("hide-definition"))},[e("div",oa,[e("div",ra,[e("h3",la,d(o.getWordTerm(o.currentDisplayWord)),1),e("div",ia,d(o.getWordDefinition(o.currentDisplayWord)),1),o.getWordExample(o.currentDisplayWord)?(r(),i("div",ca,[t[17]||(t[17]=e("strong",null,"Example:",-1)),t[18]||(t[18]=e("br",null,null,-1)),e("em",null,d(o.getWordExample(o.currentDisplayWord)),1)])):B("",!0)]),t[19]||(t[19]=e("div",{class:"card-instruction"},[e("div",{class:"instruction-icon"},"â†©ï¸"),e("p",null,"ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ Ðº Ñ‚ÐµÑ€minÑƒ")],-1))]),o.getWordTerm(o.currentDisplayWord)?(r(),i("button",{key:0,onClick:t[4]||(t[4]=qe(S=>s.$emit("pronounce",o.getWordTerm(o.currentDisplayWord)),["stop"])),class:"voice-btn",title:"Pronunciation"},t[20]||(t[20]=[e("span",{class:"voice-icon"},"ðŸ”Š",-1)]))):B("",!0)])],2),e("div",ua,[e("button",{onClick:t[6]||(t[6]=S=>s.$emit("previous-word")),disabled:(((k=n.vocabularyData)==null?void 0:k.currentIndex)||0)===0,class:"vocab-nav-btn vocab-prev-btn",title:"Previous word"},t[21]||(t[21]=[e("span",{class:"btn-icon"},"â¬…ï¸",-1),e("span",{class:"btn-text"},"Back",-1)]),8,da),e("div",va,[e("button",{onClick:t[7]||(t[7]=S=>s.$emit("mark-learned")),class:J(["vocab-learned-btn",{active:(b=o.currentDisplayWord)==null?void 0:b.learned}]),title:"ÐžÑ‚Ð¼ÐµÑ‚Ð¸Ñ‚ÑŒ ÐºÐ°Ðº learned"},[e("span",ga,d((C=o.currentDisplayWord)!=null&&C.learned?"âœ…":"ðŸ“š"),1),e("span",ma,d((x=o.currentDisplayWord)!=null&&x.learned?"Learned":"Learn"),1)],2),e("button",{onClick:t[8]||(t[8]=S=>s.$emit("next-word")),class:"vocab-next-btn",title:"Next word"},[e("span",fa,d(n.isLastWord?"ðŸ":"âž¡ï¸"),1),e("span",pa,d(n.isLastWord?"Finish":"Next"),1)])]),e("button",{onClick:t[9]||(t[9]=S=>s.$emit("restart")),class:"vocab-restart-btn",title:"Start over"},t[22]||(t[22]=[e("span",{class:"btn-icon"},"ðŸ”„",-1),e("span",{class:"btn-text"},"Start over",-1)]))]),e("div",ha,[(r(!0),i(de,null,ve(o.getValidWords(),(S,R)=>{var ee;return r(),i("button",{key:o.getWordId(S,R),onClick:se=>o.jumpToWord(R),class:J(["vocab-dot",{active:R===(((ee=n.vocabularyData)==null?void 0:ee.currentIndex)||0),learned:S==null?void 0:S.learned}]),title:o.getWordTerm(S)},null,10,ba)}),128))])])):!o.hasValidWords&&!((m=n.vocabularyData)!=null&&m.isCompleted)&&!((T=n.vocabularyData)!=null&&T.showingList)?(r(),i("div",ya,[t[25]||(t[25]=e("div",{class:"no-vocab-icon"},"ðŸ“š",-1)),t[26]||(t[26]=e("h3",{class:"no-vocab-title"},"Vocabulary is empty",-1)),e("p",xa,d(((E=(L=n.vocabularyData)==null?void 0:L.words)==null?void 0:E.length)>0?"Ð’ ÑÑ‚Ð¾Ð¼ lessonÐµ Ð½ÐµÑ‚ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ñ‹Ñ… words Ð´Ð»Ñ learning":"Ð’ ÑÑ‚Ð¾Ð¼ lessonÐµ Ð½ÐµÑ‚ words Ð´Ð»Ñ learning"),1),o.isDevelopment&&(($=(M=n.vocabularyData)==null?void 0:M.words)==null?void 0:$.length)>0?(r(),i("div",wa,[e("details",null,[t[23]||(t[23]=e("summary",null,"ðŸ”§ Word debug information",-1)),e("pre",null,d(JSON.stringify(n.vocabularyData.words,null,2)),1)])])):B("",!0),e("button",{onClick:t[10]||(t[10]=S=>s.$emit("skip")),class:"continue-btn"},t[24]||(t[24]=[e("span",{class:"btn-icon"},"ðŸ“‹",-1),e("span",{class:"btn-text"},"Continue lesson",-1)]))])):(W=n.vocabularyData)!=null&&W.isCompleted&&!((N=n.vocabularyData)!=null&&N.showingList)?(r(),i("div",ka,[e("div",_a,[t[30]||(t[30]=e("div",{class:"completion-icon"},"ðŸŽ‰",-1)),t[31]||(t[31]=e("h3",{class:"completion-title"},"Excellent!",-1)),e("p",Ca," You learned "+d(o.getLearnedWordsCount())+" of "+d(o.getValidWordsCount())+" words ",1),e("div",$a,[e("div",Sa,[e("div",Ia,d(o.getLearnedWordsCount()),1),t[27]||(t[27]=e("div",{class:"stat-label"},"Learned",-1))]),e("div",Aa,[e("div",Ta,d(o.getCompletionPercentage())+"%",1),t[28]||(t[28]=e("div",{class:"stat-label"},"Progress",-1))])]),e("button",{onClick:t[11]||(t[11]=S=>s.$emit("skip")),class:"continue-btn"},t[29]||(t[29]=[e("span",{class:"btn-icon"},"ðŸ“‹",-1),e("span",{class:"btn-text"},"Go to word list",-1)]))])])):(ie=n.vocabularyData)!=null&&ie.showingList?(r(),i("div",Ma,t[32]||(t[32]=[e("div",{class:"transition-animation"},[e("div",{class:"transition-icon"},"ðŸ“š"),e("h3",null,"Going to word list..."),e("div",{class:"loading-dots"},[e("span"),e("span"),e("span")])],-1)]))):B("",!0)])])}const Ea=Ie(Hs,[["render",La],["__scopeId","data-v-8675311f"]]),Da={name:"LessonIntro",props:{lesson:{type:Object,required:!0},estimatedTime:{type:Number,default:10},steps:{type:Array,default:()=>[]},previousProgress:{type:Object,default:null}},emits:["start","continue","exit","report-problem"],methods:{getLocalized(s){return typeof s=="string"?s:((s==null?void 0:s.en)||(s==null?void 0:s.ru)||(s==null?void 0:s.uz)||"").replace(/^(en|ru|uz):/i,"").trim()}}},Pa={class:"fixed inset-0 z-50 bg-white flex flex-col"},Wa={class:"flex items-center justify-between px-4 py-4 border-b border-slate-100"},ja={class:"text-xs font-medium text-slate-400 uppercase tracking-wider"},za={class:"flex-1 flex flex-col items-center justify-center px-6 py-12 overflow-y-auto"},qa={class:"w-full max-w-md text-center flex flex-col gap-10"},Ra={class:"flex flex-col gap-5"},Va={class:"text-2xl sm:text-3xl font-bold text-slate-900"},Fa={class:"text-slate-500 text-base sm:text-lg leading-relaxed"},Ba={class:"flex justify-center gap-12 py-2"},Na={class:"text-center"},Oa={class:"text-3xl font-bold text-slate-900"},Ha={class:"text-center"},Ua={class:"text-3xl font-bold text-slate-900"},Ga={key:0,class:"bg-slate-50 rounded-2xl p-5 text-left"},Qa={class:"flex items-center justify-between mb-4"},Ya={class:"text-sm font-bold text-slate-900"},Ja={class:"h-2 bg-slate-200 rounded-full overflow-hidden mb-5"},Za={class:"px-6 pb-8 pt-4 border-t border-slate-100 bg-white"},Xa={class:"max-w-md mx-auto space-y-4"};function Ka(s,t,n,a,g,o){var v,c,l,_,w,P;return r(),i("div",Pa,[e("div",Wa,[e("button",{onClick:t[0]||(t[0]=k=>s.$emit("exit")),class:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-400 hover:text-slate-600 transition-colors"},t[4]||(t[4]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),e("span",ja,d(((v=n.lesson)==null?void 0:v.type)==="premium"?"Premium":"Free"),1),t[5]||(t[5]=e("div",{class:"w-10"},null,-1))]),e("div",za,[e("div",qa,[e("div",Ra,[t[6]||(t[6]=e("div",{class:"w-20 h-20 mx-auto rounded-2xl bg-slate-100 flex items-center justify-center"},[e("svg",{class:"w-12 h-12 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})])],-1)),e("h1",Va,d(o.getLocalized((c=n.lesson)==null?void 0:c.lessonName)||"Lesson"),1),e("p",Fa,d(o.getLocalized((l=n.lesson)==null?void 0:l.description)||"Start learning now"),1)]),e("div",Ba,[e("div",Na,[e("div",Oa,"~"+d(n.estimatedTime),1),t[7]||(t[7]=e("div",{class:"text-xs text-slate-400 uppercase tracking-wide mt-1"},"min",-1))]),t[9]||(t[9]=e("div",{class:"w-px bg-slate-200"},null,-1)),e("div",Ha,[e("div",Ua,d((n.steps||[]).length),1),t[8]||(t[8]=e("div",{class:"text-xs text-slate-400 uppercase tracking-wide mt-1"},"steps",-1))])]),n.previousProgress&&(((_=n.previousProgress)==null?void 0:_.completedSteps)||[]).length>0?(r(),i("div",Ga,[e("div",Qa,[t[10]||(t[10]=e("span",{class:"text-sm font-medium text-slate-600"},"Previous Progress",-1)),e("span",Ya,d((((w=n.previousProgress)==null?void 0:w.completedSteps)||[]).length)+"/"+d((n.steps||[]).length),1)]),e("div",Ja,[e("div",{class:"h-full bg-slate-900 rounded-full transition-all",style:xe({width:(((P=n.previousProgress)==null?void 0:P.completedSteps)||[]).length/Math.max((n.steps||[]).length,1)*100+"%"})},null,4)]),e("button",{onClick:t[1]||(t[1]=k=>s.$emit("continue")),class:"w-full py-3.5 bg-slate-900 text-white font-medium rounded-xl hover:bg-slate-800 transition-colors"}," Continue ")])):B("",!0)])]),e("div",Za,[e("div",Xa,[e("button",{onClick:t[2]||(t[2]=k=>s.$emit("start")),class:"w-full py-4 bg-slate-900 text-white font-semibold rounded-xl hover:bg-slate-800 transition-colors text-lg"},d(n.previousProgress?"Start Over":"Start Lesson"),1),e("button",{onClick:t[3]||(t[3]=k=>s.$emit("report-problem")),class:"w-full py-3 text-slate-400 hover:text-slate-600 text-sm transition-colors"}," Report an issue ")])])])}const en=Ie(Da,[["render",Ka],["__scopeId","data-v-bc04639d"]]),tn={name:"LessonHeader",props:{lesson:{type:Object,required:!0},currentStep:{type:Number,required:!0},totalSteps:{type:Number,required:!0},formattedTime:{type:String,required:!0},stars:{type:Number,default:0},progressPercentage:{type:Number,required:!0,default:0}},emits:["exit","report-problem"],computed:{progressMarkers(){if(this.totalSteps<=1)return[];const s=[],t=100/(this.totalSteps-1);for(let n=0;n<this.totalSteps;n++)s.push({id:n,position:n*t,completed:n<this.currentStep-1,current:n===this.currentStep-1,title:`Step ${n+1}`});return s}},methods:{getLocalized(s){return typeof s=="string"?s:((s==null?void 0:s.en)||(s==null?void 0:s.ru)||(s==null?void 0:s.uz)||"").replace(/^(en|ru|uz):/i,"").trim()}}},sn={class:"lesson-header"},an={class:"header-single-row"},nn={class:"lesson-title"},on={class:"progress-container"},rn={class:"progress-bar-wrapper"},ln={class:"progress-markers"},cn=["title"],un={class:"progress-text"},dn={class:"timer-display"},vn={class:"stars-display"};function gn(s,t,n,a,g,o){var v;return r(),i("div",sn,[e("div",an,[e("button",{class:"exit-btn-small",onClick:t[0]||(t[0]=c=>s.$emit("exit"))},"âœ•"),e("h2",nn,d(o.getLocalized((v=n.lesson)==null?void 0:v.lessonName)||"Lesson"),1),e("div",on,[e("div",rn,[e("div",{class:"progress-bar",style:xe({width:n.progressPercentage+"%"})},t[2]||(t[2]=[e("div",{class:"progress-shine"},null,-1)]),4),e("div",ln,[(r(!0),i(de,null,ve(o.progressMarkers,c=>(r(),i("div",{key:c.id,class:J(["progress-marker",{completed:c.completed,current:c.current}]),style:xe({left:c.position+"%"}),title:c.title},t[3]||(t[3]=[e("div",{class:"marker-dot"},null,-1)]),14,cn))),128))])]),e("div",un,d(n.currentStep)+"/"+d(n.totalSteps),1)]),e("div",dn,d(n.formattedTime),1),e("div",vn,"â­ "+d(n.stars),1),e("button",{class:"problem-report-btn-header",onClick:t[1]||(t[1]=c=>s.$emit("report-problem")),title:"Report a problem with the lesson"}," âš ï¸ ")])])}const mn=Ie(tn,[["render",gn],["__scopeId","data-v-29b147ab"]]),fn={name:"ContentPanel",props:{currentStep:Object,currentIndex:Number,isInteractiveStep:Boolean,isGameStep:Boolean,showExplanationAlways:Boolean,totalExercises:Number,exerciseIndex:Number,isLastStep:Boolean},emits:["init-vocabulary","pronounce","next","previous"],computed:{isExerciseStep(){var s,t,n;return(((s=this.currentStep)==null?void 0:s.type)==="exercise"||((t=this.currentStep)==null?void 0:t.type)==="practice")&&!((n=this.currentStep)!=null&&n.gameType)},hasEmptyContent(){const s=this.getStepContent(this.currentStep);if(!s||typeof s!="string")return!0;const t=s.trim();return!t||t.includes("is not available")||t.includes("not found")||t.length<3},specialInteractiveTypes(){return["histogram","map","block-coding","data_analysis","fraction_visual","geometry_poly","chem_mixing","chem_matching","english_sentence_fix","english_sentence_order","language_noun_bag","geometry","selection_game","language_tone_transformer","language_idiom_bridge","language_word_constellation","language_rhythm_match","language_false_friends"]},isSpecialInteractive(){var s;return this.specialInteractiveTypes.includes((s=this.currentStep)==null?void 0:s.type)},totalExercisesInStep(){var s;return this.currentStep?Array.isArray(this.currentStep.data)?this.currentStep.data.length:(s=this.currentStep.data)!=null&&s.exercises?this.currentStep.data.exercises.length:this.currentStep.exercises?this.currentStep.exercises.length:1:0}},methods:{getStepIcon(s){return{explanation:"ðŸ“š",example:"ðŸ’¡",reading:"ðŸ“–",exercise:"âœï¸",practice:"ðŸ§ª",quiz:"ðŸ§©",vocabulary:"ðŸ“",video:"ðŸŽ¬",audio:"ðŸŽµ",game:"ðŸŽ®"}[s]||"ðŸ“„"},getStepTypeText(s){return{explanation:"Explanation",example:"Example",reading:"Reading",exercise:"Exercise",practice:"Practice",quiz:"Quiz",vocabulary:"Vocabulary",video:"Video",audio:"Audio",game:"Game"}[s]||"Content"},getStepContent(s){var n,a,g,o;if(!s)return"Step not found";if(s.gameType)return s.instructions||s.description||"Complete the game to proceed";let t=null;return(n=s.data)!=null&&n.content?t=s.data.content:(a=s.data)!=null&&a.text?t=s.data.text:(g=s.content)!=null&&g.text?t=s.content.text:(o=s.content)!=null&&o.content?t=s.content.content:typeof s.content=="string"?t=s.content:typeof s.data=="string"?t=s.data:s.description?t=s.description:s.text&&(t=s.text),t||`Content for "${s.type}" step is not available`},formatContent(s){if(!s)return"";let t=String(s);return t=t.replace(/\[card title="(.*?)"\]([\s\S]*?)\[\/card\]/g,(n,a,g)=>`<div class="content-card"><h3 class="card-heading">${a}</h3><div class="card-content">${g}</div></div>`),t=t.replace(/\[card\]([\s\S]*?)\[\/card\]/g,(n,a)=>`<div class="content-card">${a}</div>`),t=t.replace(/^## (.*$)/gim,'<h2 class="content-h2">$1</h2>').replace(/^### (.*$)/gim,'<h3 class="content-h3">$1</h3>').replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`(.+?)`/g,"<code>$1</code>").replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br>"),`<p>${t}</p>`}}},pn={class:"content-step-header"},hn={class:"header-title"},bn={class:"step-number"},yn={class:"step-icon"},xn={class:"step-text"},wn={key:0,class:"exercise-counter"},kn={class:"content-step-container"},_n={class:"content-padding"},Cn={key:0},$n={key:0,class:"empty-content-card"},Sn=["innerHTML"],In={key:1,class:"interactive-instruction-card"},An={key:2,class:"game-context-view"},Tn={class:"game-intro-card"},Mn={class:"intro-header"},Ln={key:3,class:"interactive-instruction-card"},En={key:4,class:"interactive-instruction-card"},Dn={class:"instruction-icon"},Pn={class:"instruction-heading"},Wn={key:5,class:"vocabulary-content"},jn={key:0,class:"vocabulary-trigger"},zn={class:"trigger-subheading"},qn={key:1,class:"vocabulary-list-view"},Rn={class:"vocabulary-header"},Vn={class:"vocabulary-list"},Fn={class:"vocab-item-header"},Bn={class:"vocab-term"},Nn=["onClick"],On={key:0,class:"learned-badge"},Hn={class:"vocab-definition"},Un={key:0,class:"vocab-example"},Gn={key:6,class:"media-placeholder"},Qn={class:"media-icon"},Yn={class:"media-title"},Jn={class:"media-description"},Zn=["innerHTML"],Xn={class:"content-navigation"};function Kn(s,t,n,a,g,o){var v,c,l,_,w,P,k,b,C,x,m,T,L,E,M,$,W;return r(),i("div",{class:J(["content-panel",{"game-mode":n.isGameStep}])},[e("header",pn,[e("h3",hn,[e("span",bn,d(n.currentIndex+1),1),e("span",yn,d(o.getStepIcon((v=n.currentStep)==null?void 0:v.type)),1),e("span",xn,d(o.getStepTypeText((c=n.currentStep)==null?void 0:c.type)),1),n.isInteractiveStep&&!n.isGameStep?(r(),i("span",wn," ("+d(n.exerciseIndex+1)+"/"+d(n.totalExercises||1)+") ",1)):B("",!0)])]),e("div",kn,[e("div",_n,[["explanation","example","reading"].includes((l=n.currentStep)==null?void 0:l.type)?(r(),i("div",Cn,[o.hasEmptyContent?(r(),i("div",$n,t[4]||(t[4]=[e("div",{class:"empty-icon"},"ðŸ“­",-1),e("h3",{class:"empty-heading"},"Content Not Available",-1),e("p",{class:"empty-text"},"This step doesn't have content yet. Click Next to continue with the lesson.",-1)]))):(r(),i("div",{key:1,class:"content-text",innerHTML:o.formatContent(o.getStepContent(n.currentStep))},null,8,Sn))])):o.isExerciseStep?(r(),i("div",In,t[5]||(t[5]=[e("div",{class:"instruction-icon"},"âœï¸",-1),e("h3",{class:"instruction-heading"},"Complete the exercise on the right",-1),e("p",{class:"instruction-text"}," Use the interactive panel to answer the question and continue with the lesson. ",-1)]))):n.isGameStep?(r(),i("div",An,[e("div",Tn,[e("div",Mn,[t[6]||(t[6]=e("span",{class:"game-icon"},"ðŸŽ®",-1)),e("h3",null,"Game Time: "+d(n.currentStep.title||"Interactive Challenge"),1)]),t[7]||(t[7]=e("div",{class:"game-instructions-box"},[e("h4",null,"How to Play:"),e("ul",{class:"instruction-list"},[e("li",null,"Follow the instructions in the game panel"),e("li",null,"Complete all objectives to proceed"),e("li",null,"Have fun learning!")])],-1))])])):o.isSpecialInteractive?(r(),i("div",Ln,t[8]||(t[8]=[e("div",{class:"instruction-icon"},"ðŸŽ®",-1),e("h3",{class:"instruction-heading"},"Interactive Exercise",-1),e("p",{class:"instruction-text"},"Complete the interactive exercise on the right to continue.",-1)]))):n.isInteractiveStep&&!o.isExerciseStep&&!n.isGameStep?(r(),i("div",En,[e("div",Dn,d(((_=n.currentStep)==null?void 0:_.type)==="practice"?"ðŸ§ª":"ðŸ§©"),1),e("h3",Pn,"Complete the "+d(o.getStepTypeText((w=n.currentStep)==null?void 0:w.type).toLowerCase())+" on the right",1),t[9]||(t[9]=e("p",{class:"instruction-text"},"Use the interactive panel to complete this activity.",-1))])):((P=n.currentStep)==null?void 0:P.type)==="vocabulary"?(r(),i("div",Wn,[(b=(k=n.currentStep)==null?void 0:k.data)!=null&&b.modalCompleted?(r(),i("div",qn,[e("div",Rn,[t[12]||(t[12]=e("h3",null,"ðŸ“– Learned Words",-1)),e("button",{onClick:t[1]||(t[1]=N=>s.$emit("init-vocabulary")),class:"review-button"}," ðŸ”„ Review ")]),e("div",Vn,[(r(!0),i(de,null,ve(((m=(x=n.currentStep)==null?void 0:x.data)==null?void 0:m.allWords)||((T=n.currentStep)==null?void 0:T.data)||[],(N,ie)=>(r(),i("div",{key:(N==null?void 0:N.id)||`vocab-list-${ie}`,class:J(["vocabulary-item",{"is-learned":N==null?void 0:N.learned}])},[e("div",Fn,[e("div",Bn,[Se(d((N==null?void 0:N.term)||"Term")+" ",1),N!=null&&N.term?(r(),i("button",{key:0,onClick:S=>s.$emit("pronounce",N.term),class:"pronunciation-button",title:"Pronunciation"}," ðŸ”Š ",8,Nn)):B("",!0)]),N!=null&&N.learned?(r(),i("div",On,"âœ…")):B("",!0)]),e("div",Hn,d((N==null?void 0:N.definition)||"Definition"),1),N!=null&&N.example?(r(),i("div",Un,[t[13]||(t[13]=e("strong",null,"Example:",-1)),Se(" "+d(N.example),1)])):B("",!0)],2))),128))])])):(r(),i("div",jn,[t[10]||(t[10]=e("div",{class:"trigger-icon"},"ðŸ“š",-1)),t[11]||(t[11]=e("h3",{class:"trigger-heading"},"Vocabulary Learning",-1)),e("p",zn,d(Array.isArray((C=n.currentStep)==null?void 0:C.data)?n.currentStep.data.length:1)+" new words await you!",1),e("button",{onClick:t[0]||(t[0]=N=>s.$emit("init-vocabulary")),class:"trigger-button"}," ðŸš€ Start Learning ")]))])):["video","audio"].includes((L=n.currentStep)==null?void 0:L.type)?(r(),i("div",Gn,[e("div",Qn,d(((E=n.currentStep)==null?void 0:E.type)==="video"?"ðŸŽ¬":"ðŸŽµ"),1),e("h4",Yn,d(((M=n.currentStep)==null?void 0:M.type)==="video"?"Video Lesson":"Audio Lesson"),1),e("p",Jn,d(((W=($=n.currentStep)==null?void 0:$.data)==null?void 0:W.description)||"Multimedia content"),1)])):(r(),i("div",{key:7,class:"content-text",innerHTML:o.formatContent(o.getStepContent(n.currentStep))},null,8,Zn))])]),e("footer",Xn,[n.currentIndex>0?(r(),i("button",{key:0,class:"nav-button prev-button",onClick:t[2]||(t[2]=N=>s.$emit("previous"))}," â¬…ï¸ Back ")):B("",!0),!n.isInteractiveStep||o.hasEmptyContent?(r(),i("button",{key:1,class:J(["nav-button next-button",{"hide-on-mobile-game":n.isGameStep}]),onClick:t[3]||(t[3]=N=>s.$emit("next"))},d(n.isLastStep?"ðŸ Finish":"âž¡ï¸ Next"),3)):B("",!0)])],2)}const eo=Ie(fn,[["render",Kn],["__scopeId","data-v-87b834fc"]]);function to(s){const t=f(0),n=f(0),a=f(null),g=f(null),o=O(()=>{const P=be(s);return(P==null?void 0:P.questions)||[]}),v=O(()=>o.value[n.value]),c=O(()=>n.value>=o.value.length-1&&g.value==="correct"),l=P=>{g.value||(a.value=P.id,P.id===v.value.targetId?(g.value="correct",t.value++,setTimeout(()=>{n.value<o.value.length-1&&_()},1500)):(g.value="incorrect",setTimeout(()=>{a.value=null,g.value=null},1e3)))},_=()=>{n.value++,a.value=null,g.value=null};return{score:t,currentQuestion:v,currentQuestionIndex:n,questions:o,selectedItemId:a,feedback:g,isComplete:c,handleSelection:l,resetGame:()=>{n.value=0,t.value=0,a.value=null,g.value=null}}}const so={class:"game-hud-sidebar"},ao={class:"hud-section score"},no={class:"hud-value"},oo={class:"hud-value"},ro={key:0,class:"hud-section lives"},lo={class:"hearts"},io={key:1,class:"hud-section prompt"},co={class:"prompt-text"},uo={key:2,class:"hud-section target"},vo={class:"hud-value"},go={__name:"GameHUDSidebar",props:{score:{type:Number,default:0},timeRemaining:{type:Number,default:60},lives:{type:Number,default:3},maxLives:{type:Number,default:3},prompt:{type:String,default:""},targetScore:{type:Number,default:0}},setup(s){return(t,n)=>(r(),i("div",so,[e("div",ao,[n[0]||(n[0]=e("span",{class:"hud-icon"},"ðŸŽ¯",-1)),e("span",no,d(s.score),1),n[1]||(n[1]=e("span",{class:"hud-label"},"Score",-1))]),e("div",{class:J(["hud-section timer",{warning:s.timeRemaining<10}])},[n[2]||(n[2]=e("span",{class:"hud-icon"},"â³",-1)),e("span",oo,d(s.timeRemaining)+"s",1),n[3]||(n[3]=e("span",{class:"hud-label"},"Time",-1))],2),s.maxLives>0?(r(),i("div",ro,[e("div",lo,[(r(!0),i(de,null,ve(s.maxLives,a=>(r(),i("span",{key:a,class:J(["heart",{lost:a>s.lives}])},"â¤ï¸",2))),128))]),n[4]||(n[4]=e("span",{class:"hud-label"},"Lives",-1))])):B("",!0),s.prompt?(r(),i("div",io,[e("p",co,d(s.prompt),1)])):B("",!0),s.targetScore?(r(),i("div",uo,[n[5]||(n[5]=e("span",{class:"hud-icon"},"ðŸŽ¯",-1)),e("span",vo,d(s.targetScore),1),n[6]||(n[6]=e("span",{class:"hud-label"},"Target",-1))])):B("",!0)]))}},Zt=Ie(go,[["__scopeId","data-v-1df417cb"]]),mo={key:1,class:"question-display"},fo={class:"question-text"},po={class:"game-world"},ho={class:"orb-text"},bo={class:"splash-icon"},yo={class:"splash-text"},xo={__name:"BasketCatch",props:{gameData:{type:Object,required:!0},score:{type:Number,default:0},lives:{type:Number,default:3},timeRemaining:{type:Number,default:60},isPaused:{type:Boolean,default:!1}},emits:["score-change","life-lost","item-collected","game-complete","pause","game-started"],setup(s,{emit:t}){const n=s,a=t,g=f(null),o=f([]),v=f({}),c=f(50),l=f(!1),_=f(0),w=f(null),P=f(null),k=f(0),b=f(!1),C=f(""),x=f(""),m=f(""),T=["#FFE0B2","#C8E6C9","#BBDEFB","#F8BBD0","#E1BEE7"],L=O(()=>n.gameData.questions||[{q:"Ready?",a:"Go",wrong:[]}]),E=O(()=>L.value[k.value]),M=O(()=>{var Y,V;return((Y=E.value)==null?void 0:Y.q)||((V=E.value)==null?void 0:V.question)||"Loading..."}),$=()=>{if(!l.value||n.isPaused)return;const Y=E.value;if(!Y)return;const V=Math.random()>.5,Q=Y.a||Y.correctAnswer||Y.answer,H=Y.wrong||Y.wrongAnswers||["0","1"],q=H[Math.floor(Math.random()*H.length)],te=V?Q:q,U={id:`item-${_.value++}`,text:te,isCorrect:V,x:Math.random()*80+10,speed:n.gameData.difficulty==="hard"?2.5:4,color:T[Math.floor(Math.random()*T.length)]};o.value.push(U),setTimeout(()=>{S(U.id)},U.speed*1e3+500)},W=()=>{var Q;if(!l.value||n.isPaused)return;const Y=(Q=g.value)==null?void 0:Q.querySelector(".basket-body");if(!Y)return;const V=Y.getBoundingClientRect();o.value.forEach(H=>{const q=v.value[H.id];if(!q)return;const te=q.getBoundingClientRect();!(te.right<V.left+20||te.left>V.right-20||te.bottom<V.top+20||te.top>V.bottom-20)&&N(H)})},N=Y=>{S(Y.id),Y.isCorrect?(a("score-change",100),ie("Correct!","success","âœ¨"),o.value=[],setTimeout(()=>{k.value<L.value.length-1?k.value++:a("game-complete",{score:n.score+100})},800)):(a("score-change",-20),a("life-lost"),ie("Wrong!","error","âŒ"))},ie=(Y,V,Q)=>{C.value=Y,x.value=V,m.value=Q,b.value=!0,setTimeout(()=>b.value=!1,1e3)},S=Y=>{const V=o.value.findIndex(Q=>Q.id===Y);V!==-1&&(o.value.splice(V,1),delete v.value[Y])},R=Y=>{if(!g.value||!l.value)return;const V=g.value.getBoundingClientRect();se(Y.clientX-V.left,V.width)},ee=Y=>{if(Y.preventDefault(),!g.value||!l.value)return;const V=g.value.getBoundingClientRect();se(Y.touches[0].clientX-V.left,V.width)},se=(Y,V)=>{const Q=Y/V*100;c.value=Math.max(10,Math.min(90,Q))},ce=()=>{l.value||ge()},ge=()=>{l.value=!0,o.value=[],k.value=0,w.value&&clearInterval(w.value),P.value&&clearInterval(P.value),w.value=setInterval($,1400),P.value=setInterval(W,50)},_e=()=>{l.value=!1,clearInterval(w.value),clearInterval(P.value)};return ke(()=>n.lives,Y=>{Y<=0&&_e()}),nt(()=>{o.value=[],a("game-started"),setTimeout(()=>{ge()},100)}),mt(_e),(Y,V)=>(r(),i("div",{class:"basket-catch-game",ref_key:"gameContainer",ref:g,onMousemove:R,onTouchmove:ee,onClick:ce},[V[2]||(V[2]=et('<div class="sun" data-v-69674282>â˜€ï¸</div><div class="cloud cloud-1" data-v-69674282>â˜ï¸</div><div class="cloud cloud-2" data-v-69674282>â˜ï¸</div><div class="cloud cloud-3" data-v-69674282>â˜ï¸</div><div class="cloud cloud-4" data-v-69674282>â˜ï¸</div><div class="cloud cloud-5" data-v-69674282>â˜ï¸</div><div class="cloud cloud-6" data-v-69674282>â˜ï¸</div><div class="cloud cloud-7" data-v-69674282>â˜ï¸</div><div class="cloud cloud-8" data-v-69674282>â˜ï¸</div>',9)),l.value?(r(),$e(Zt,{key:0,score:s.score,"time-remaining":s.timeRemaining,lives:s.lives,"max-lives":3},null,8,["score","time-remaining","lives"])):B("",!0),l.value?(r(),i("div",mo,[V[0]||(V[0]=e("div",{class:"question-icon"},"â“",-1)),e("div",fo,d(M.value),1)])):B("",!0),e("div",po,[(r(!0),i(de,null,ve(o.value,Q=>(r(),i("div",{key:Q.id,class:"falling-orb",ref_for:!0,ref:H=>{H&&(v.value[Q.id]=H)},style:xe({left:Q.x+"%",animationDuration:Q.speed+"s",backgroundColor:Q.color})},[e("span",ho,d(Q.text),1)],4))),128))]),e("div",{class:"basket-wrapper",style:xe({left:c.value+"%"})},V[1]||(V[1]=[e("div",{class:"basket-body"},[e("span",{class:"basket-emoji"},"ðŸ§º")],-1)]),4),Me(Re,{name:"pop"},{default:Pe(()=>[b.value?(r(),i("div",{key:0,class:J(["feedback-splash",x.value])},[e("div",bo,d(m.value),1),e("div",yo,d(C.value),1)],2)):B("",!0)]),_:1})],544))}},Ut=Ie(xo,[["__scopeId","data-v-69674282"]]),wo={class:"memory-cards-game"},ko={key:1,class:"instruction-banner"},_o={class:"instruction-text"},Co=["onClick"],$o={class:"card-back"},So={class:"card-content"},Io={__name:"MemoryCards",props:{gameData:{type:Object,required:!0},score:{type:Number,default:0},lives:{type:Number,default:3},timeRemaining:{type:Number,default:60}},emits:["score-change","life-lost","game-complete","item-collected","game-started"],setup(s,{emit:t}){const n=s,a=t,g=f([]),o=f([]),v=f(0),c=f(!0),l=f(!0),_=O(()=>{var T;return((T=n.gameData)==null?void 0:T.instructions)||"Find matching pairs!"}),w=O(()=>{var T,L;return((T=n.gameData)==null?void 0:T.items)||((L=n.gameData)==null?void 0:L.pairs)||[]}),P=O(()=>{const T=g.value.length;return T<=12?"4x3":T<=16?"4x4":T<=20?"5x4":"6x4"}),k=()=>{if(w.value.length===0)return;const T=[];let L=0;w.value.forEach((E,M)=>{let $;typeof E=="object"&&E!==null?$=E.content||E.text||E.word||JSON.stringify(E):$=E,T.push({id:L++,pairId:M,content:$,flipped:!1,matched:!1}),T.push({id:L++,pairId:M,content:$,flipped:!1,matched:!1})}),g.value=b(T)},b=T=>{const L=[...T];for(let E=L.length-1;E>0;E--){const M=Math.floor(Math.random()*(E+1));[L[E],L[M]]=[L[M],L[E]]}return L},C=T=>{!l.value||!c.value||T.flipped||T.matched||(T.flipped=!0,o.value.push(T),o.value.length===2&&(c.value=!1,x()))},x=()=>{const[T,L]=o.value;T.pairId===L.pairId?setTimeout(()=>{T.matched=!0,L.matched=!0,v.value++,a("score-change",20),a("item-collected",{isCorrect:!0}),v.value===w.value.length&&setTimeout(()=>{a("game-complete",{reason:"all-matched"})},500),m()},500):setTimeout(()=>{T.flipped=!1,L.flipped=!1,a("score-change",-2),a("item-collected",{isCorrect:!1}),m()},1e3)},m=()=>{o.value=[],c.value=!0};return ke(()=>n.lives,T=>{T<=0&&(l.value=!1)}),ke(()=>n.timeRemaining,T=>{T<=0&&(l.value=!1)}),nt(()=>{k(),a("game-started")}),(T,L)=>(r(),i("div",wo,[l.value?(r(),$e(Zt,{key:0,score:s.score,"time-remaining":s.timeRemaining,lives:s.lives,"max-lives":3},null,8,["score","time-remaining","lives"])):B("",!0),l.value?(r(),i("div",ko,[e("p",_o,d(_.value),1)])):B("",!0),e("div",{class:J(["cards-grid",`grid-${P.value}`])},[(r(!0),i(de,null,ve(g.value,E=>(r(),i("div",{key:E.id,class:"card-wrapper",onClick:M=>C(E)},[e("div",{class:J(["card",{flipped:E.flipped,matched:E.matched}])},[L[0]||(L[0]=e("div",{class:"card-front"},[e("div",{class:"card-icon"},"ðŸŽ´")],-1)),e("div",$o,[e("div",So,d(E.content),1)])],2)],8,Co))),128))],2)]))}},Ao=Ie(Io,[["__scopeId","data-v-3359ceb4"]]),To={ref:"gameWrapper",class:"game-container"},Mo={class:"top-section"},Lo={class:"question-text"},Eo={class:"stats-row"},Do={class:"stat-badge stat-score"},Po={class:"stat-value"},Wo={class:"stat-badge stat-time"},jo={class:"stat-value"},zo={class:"stat-badge stat-lives"},qo={class:"game-area"},Ro={class:"moles-grid"},Vo={key:1,class:"start-screen"},Fo={class:"start-content"},Bo={class:"start-info"},No={class:"info-item"},Oo={class:"info-value"},Ho={class:"info-item"},Uo={class:"info-value"},Go={class:"info-item"},Qo={class:"info-value"},Yo={key:2,class:"gameover-screen"},Jo={class:"gameover-card"},Zo={class:"gameover-emoji"},Xo={class:"gameover-title"},Ko={class:"gameover-score"},er={class:"gameover-stars"},tr={class:"gameover-stats"},sr={class:"gstat"},ar={class:"gstat-value gstat-correct"},nr={class:"gstat"},or={class:"gstat-value gstat-wrong"},rr={class:"gstat"},lr={class:"gstat-value"},ir={class:"gameover-progress"},cr={class:"gameover-timer"},ur=2500,dr=1200,Gt=5e3,vr={__name:"WhackAMole",props:{gameData:{type:Object,required:!0},score:{type:Number,default:0},lives:{type:Number,default:3},timeRemaining:{type:Number,default:60}},emits:["score-change","life-lost","game-complete","item-collected","game-started"],setup(s,{emit:t}){const n=Ds({props:{hole:Object},setup(Y){return()=>{var V,Q,H,q,te,U;return Te("div",{class:"hole-container"},[Te("div",{class:"hole-visual"},[Te("div",{class:"dirt-mound-back"}),Te("div",{class:["mole-wrapper",{"mole-up":(V=Y.hole)==null?void 0:V.active,"mole-hit":((Q=Y.hole)==null?void 0:Q.state)==="hit","mole-miss":((H=Y.hole)==null?void 0:H.state)==="miss"}]},[Te("div",{class:"mole-character"},[Te("div",{class:"mole-head"},[Te("div",{class:"mole-ear mole-ear-l"}),Te("div",{class:"mole-ear mole-ear-r"}),Te("div",{class:"mole-face"},[Te("div",{class:"mole-eye mole-eye-l"},[Te("div",{class:"mole-pupil"}),Te("div",{class:"mole-eye-shine"})]),Te("div",{class:"mole-eye mole-eye-r"},[Te("div",{class:"mole-pupil"}),Te("div",{class:"mole-eye-shine"})]),Te("div",{class:"mole-cheek mole-cheek-l"}),Te("div",{class:"mole-cheek mole-cheek-r"}),Te("div",{class:"mole-nose"}),Te("div",{class:"mole-mouth"})])]),Te("div",{class:"mole-body"},[Te("div",{class:"mole-body-inner"}),Te("div",{class:"mole-paw mole-paw-l"}),Te("div",{class:"mole-paw mole-paw-r"})])])]),Te("div",{class:"dirt-mound-front"}),Te("div",{class:["wooden-sign",{"sign-visible":(q=Y.hole)==null?void 0:q.active}]},[Te("div",{class:"sign-board"},[Te("span",{class:"sign-text"},((te=Y.hole)==null?void 0:te.content)||"")])])]),(U=Y.hole)!=null&&U.showEffect?Te("div",{class:"hit-effect"},Y.hole.state==="hit"?"â­":"âŒ"):null])}}}),a=s,g=t,o=O(()=>{var Y;return((Y=a.gameData)==null?void 0:Y.lives)||3}),v=O(()=>{var Y;return((Y=a.gameData)==null?void 0:Y.timeLimit)||60}),c=O(()=>{var Y;return((Y=a.gameData)==null?void 0:Y.targetScore)||100}),l=f([]),_=f(!1),w=f(null),P=f(0),k=f(!1),b=f(0),C=f(100),x=f(null),m=f(null),T=f(0),L=f(0),E=O(()=>{var Y,V;return((V=(Y=a.gameData)==null?void 0:Y.questions)==null?void 0:V.length)>0?"question":"category"}),M=O(()=>{var Y;return((Y=a.gameData)==null?void 0:Y.questions)||[]}),$=O(()=>M.value[P.value]),W=O(()=>{var Y,V,Q,H;return E.value==="question"?((Y=$.value)==null?void 0:Y.q)||((V=$.value)==null?void 0:V.question)||"Find the answer!":((Q=a.gameData)==null?void 0:Q.targetCategory)||((H=a.gameData)==null?void 0:H.prompt)||"Tap correct items!"}),N=O(()=>{const Y=T.value+L.value;return Y===0?0:Math.round(T.value/Y*100)}),ie=()=>{l.value=Array.from({length:4},()=>({active:!1,content:"",isCorrect:!1,state:"idle",showEffect:!1,timer:null}))},S=()=>{var U;if(!_.value)return;const Y=l.value.map((fe,me)=>fe.active?null:me).filter(fe=>fe!==null);if(Y.length===0)return;const V=Y[Math.floor(Math.random()*Y.length)],Q=l.value[V];let H="",q=!1;if(E.value==="question"){const fe=$.value;if(!fe)return;if(q=Math.random()>.4,q)H=fe.a||fe.answer||fe.correctAnswer||"âœ“";else{const me=fe.wrong||fe.wrongAnswers||fe.distractors||[];H=me.length>0?me[Math.floor(Math.random()*me.length)]:"âœ—"}}else{const fe=((U=a.gameData)==null?void 0:U.items)||[];if(fe.length===0)return;const me=fe[Math.floor(Math.random()*fe.length)];typeof me=="string"?(H=me,q=!0):(H=me.text||me.word||me.label||"?",q=me.isCorrect??me.correct??!0)}Q.content=H,Q.isCorrect=q,Q.active=!0,Q.state="idle";const te=Math.max(dr,ur-a.score*15);Q.timer=setTimeout(()=>{Q.active&&Q.state==="idle"&&(Q.active=!1)},te)},R=Y=>{const V=l.value[Y];!V||!V.active||V.state!=="idle"||(clearTimeout(V.timer),V.showEffect=!0,V.isCorrect?(V.state="hit",T.value++,g("score-change",10),g("item-collected",{isCorrect:!0}),E.value==="question"&&setTimeout(()=>ee(),400)):(V.state="miss",L.value++,g("score-change",-5),g("life-lost"),g("item-collected",{isCorrect:!1})),setTimeout(()=>{V.active=!1,V.showEffect=!1,V.state="idle"},350))},ee=()=>{P.value<M.value.length-1?(P.value++,l.value.forEach(Y=>{Y.active=!1,clearTimeout(Y.timer)})):ce()},se=()=>{const Y=a.score/c.value*100;return Y>=100?3:Y>=70?2:Y>=40?1:0},ce=()=>{_e(),k.value=!0,b.value=se(),C.value=100;const Y=Date.now();x.value=setInterval(()=>{C.value=Math.max(0,100-(Date.now()-Y)/Gt*100)},50),m.value=setTimeout(()=>{clearInterval(x.value),g("game-complete",{score:a.score,stars:b.value,accuracy:N.value,correctHits:T.value,wrongHits:L.value,completed:a.score>=c.value*.4})},Gt)},ge=()=>{k.value=!1,_.value=!0,T.value=0,L.value=0,P.value=0,ie(),g("game-started"),setTimeout(()=>{w.value=setInterval(S,900)},500)},_e=()=>{_.value=!1,w.value&&(clearInterval(w.value),w.value=null),l.value.forEach(Y=>{Y.timer&&clearTimeout(Y.timer)})};return ke(()=>a.score,Y=>{Y>=c.value&&_.value&&ce()}),ke(()=>a.lives,Y=>{Y<=0&&_.value&&ce()}),ke(()=>a.timeRemaining,Y=>{Y<=0&&_.value&&ce()}),nt(()=>ie()),mt(()=>{_e(),m.value&&clearTimeout(m.value),x.value&&clearInterval(x.value)}),(Y,V)=>(r(),i("div",To,[_.value?(r(),i(de,{key:0},[e("div",Mo,[(r(),i("div",{class:"question-card",key:P.value},[V[8]||(V[8]=e("span",{class:"question-label"},"Question",-1)),e("p",Lo,d(W.value),1)])),e("div",Eo,[e("div",Do,[V[9]||(V[9]=e("span",{class:"stat-icon"},"ðŸŽ¯",-1)),e("span",Po,d(s.score),1)]),e("div",Wo,[V[10]||(V[10]=e("span",{class:"stat-icon"},"â±ï¸",-1)),e("span",jo,d(s.timeRemaining)+"s",1)]),e("div",zo,[(r(!0),i(de,null,ve(o.value,Q=>(r(),i("span",{key:Q,class:"heart"},d(Q<=s.lives?"â¤ï¸":"ðŸ¤"),1))),128))])])]),e("div",qo,[e("div",Ro,[e("div",{class:"mole-cell",onClick:V[0]||(V[0]=Q=>R(0)),onTouchstart:V[1]||(V[1]=qe(Q=>R(0),["prevent"]))},[Me(be(n),{hole:l.value[0]},null,8,["hole"])],32),e("div",{class:"mole-cell",onClick:V[2]||(V[2]=Q=>R(1)),onTouchstart:V[3]||(V[3]=qe(Q=>R(1),["prevent"]))},[Me(be(n),{hole:l.value[1]},null,8,["hole"])],32),e("div",{class:"mole-cell",onClick:V[4]||(V[4]=Q=>R(2)),onTouchstart:V[5]||(V[5]=qe(Q=>R(2),["prevent"]))},[Me(be(n),{hole:l.value[2]},null,8,["hole"])],32),e("div",{class:"mole-cell",onClick:V[6]||(V[6]=Q=>R(3)),onTouchstart:V[7]||(V[7]=qe(Q=>R(3),["prevent"]))},[Me(be(n),{hole:l.value[3]},null,8,["hole"])],32)])])],64)):k.value?(r(),i("div",Yo,[e("div",Jo,[e("div",Zo,d(b.value>=3?"ðŸ†":b.value>=2?"ðŸŽ‰":b.value>=1?"ðŸ‘":"ðŸ’ª"),1),e("h2",Xo,d(b.value>=3?"Perfect!":b.value>=2?"Great Job!":b.value>=1?"Good Try!":"Keep Going!"),1),e("div",Ko,d(s.score),1),V[24]||(V[24]=e("div",{class:"gameover-score-label"},"points",-1)),e("div",er,[(r(),i(de,null,ve(3,Q=>e("span",{key:Q,class:J(["star",Q<=b.value?"star-filled":"star-empty"])},"â˜…",2)),64))]),e("div",tr,[e("div",sr,[e("div",ar,d(T.value),1),V[19]||(V[19]=e("div",{class:"gstat-label"},"Correct",-1))]),V[22]||(V[22]=e("div",{class:"gstat-divider"},null,-1)),e("div",nr,[e("div",or,d(L.value),1),V[20]||(V[20]=e("div",{class:"gstat-label"},"Wrong",-1))]),V[23]||(V[23]=e("div",{class:"gstat-divider"},null,-1)),e("div",rr,[e("div",lr,d(N.value)+"%",1),V[21]||(V[21]=e("div",{class:"gstat-label"},"Accuracy",-1))])]),e("div",ir,[e("div",{class:"progress-fill",style:xe({width:C.value+"%"})},null,4)]),e("p",cr,"Next in "+d(Math.ceil(C.value/20))+"s",1)])])):(r(),i("div",Vo,[e("div",Fo,[V[18]||(V[18]=et('<div class="start-mole" data-v-daa656e9><div class="mole-preview" data-v-daa656e9><div class="preview-body" data-v-daa656e9></div><div class="preview-ear preview-ear-l" data-v-daa656e9></div><div class="preview-ear preview-ear-r" data-v-daa656e9></div><div class="preview-eye preview-eye-l" data-v-daa656e9></div><div class="preview-eye preview-eye-r" data-v-daa656e9></div><div class="preview-nose" data-v-daa656e9></div><div class="preview-cheek preview-cheek-l" data-v-daa656e9></div><div class="preview-cheek preview-cheek-r" data-v-daa656e9></div></div></div><h1 class="start-title" data-v-daa656e9>Whack-a-Mole!</h1><p class="start-subtitle" data-v-daa656e9>Tap moles with the <strong data-v-daa656e9>correct answer</strong></p>',3)),e("div",Bo,[e("div",No,[V[11]||(V[11]=e("span",{class:"info-icon"},"â¤ï¸",-1)),V[12]||(V[12]=e("span",{class:"info-label"},"Lives",-1)),e("span",Oo,d(o.value),1)]),e("div",Ho,[V[13]||(V[13]=e("span",{class:"info-icon"},"â±ï¸",-1)),V[14]||(V[14]=e("span",{class:"info-label"},"Time",-1)),e("span",Uo,d(v.value)+"s",1)]),e("div",Go,[V[15]||(V[15]=e("span",{class:"info-icon"},"ðŸŽ¯",-1)),V[16]||(V[16]=e("span",{class:"info-label"},"Goal",-1)),e("span",Qo,d(c.value),1)])]),e("button",{class:"start-button",onClick:ge,onTouchend:qe(ge,["prevent"])},V[17]||(V[17]=[e("span",{class:"button-text"},"Play Now",-1),e("span",{class:"button-icon"},"â–¶",-1)]),32)])]))],512))}},gr=Ie(vr,[["__scopeId","data-v-daa656e9"]]),mr={class:"lightning-round-game"},fr={key:0,class:"question-container"},pr={class:"question-number"},hr={class:"question-card"},br={class:"question-text"},yr={class:"options-grid"},xr=["disabled","onClick"],wr={class:"question-timer"},kr={class:"game-instructions"},_r={__name:"LightningRound",props:{gameData:{type:Object,required:!0},score:{type:Number,default:0},lives:{type:Number,default:3},timeRemaining:{type:Number,default:60}},emits:["score-change","life-lost","game-complete","item-collected","game-started"],setup(s,{emit:t}){const n=s,a=t,g=f(0),o=f(!1),v=f(null),c=f(""),l=f(""),_=f(10),w=f(null),P=f(!0),k=O(()=>{var W;return((W=n.gameData)==null?void 0:W.instructions)||"Answer as fast as you can!"}),b=O(()=>{var W,N;return((W=n.gameData)==null?void 0:W.questions)||((N=n.gameData)==null?void 0:N.items)||[]}),C=O(()=>g.value<b.value.length?b.value[g.value]:null),x=O(()=>_.value/10*100),m=()=>{_.value=10,w.value=setInterval(()=>{_.value--,_.value<=0&&(clearInterval(w.value),o.value||L())},1e3)},T=W=>{if(o.value||!P.value)return;o.value=!0,v.value=W,w.value&&clearInterval(w.value);const N=C.value,ie=N.correctAnswer,S=W===ie;let R=0;S?(R=10+Math.floor(_.value*2),c.value=`Correct! +${R} points`,l.value="correct"):(R=-5,c.value=`Wrong! The correct answer was: ${N.options[ie]}`,l.value="incorrect",a("life-lost")),a("score-change",R),a("item-collected",{isCorrect:S}),setTimeout(()=>{E()},2e3)},L=()=>{o.value=!0,v.value=null,c.value="Time's up!",l.value="timeout",a("life-lost"),a("score-change",-5),a("item-collected",{isCorrect:!1}),setTimeout(()=>{E()},2e3)},E=()=>{g.value++,g.value>=b.value.length?(a("game-complete",{reason:"all-questions-answered"}),P.value=!1):(o.value=!1,v.value=null,c.value="",l.value="",m())},M=W=>{var ie;if(!o.value)return"";const N=(ie=C.value)==null?void 0:ie.correctAnswer;return W===v.value?W===N?"selected-correct":"selected-wrong":W===N?"show-correct":"disabled"},$=()=>{P.value=!1,w.value&&clearInterval(w.value)};return ke(()=>n.lives,W=>{W<=0&&$()}),ke(()=>n.timeRemaining,W=>{W<=0&&$()}),nt(()=>{b.value.length>0&&(m(),a("game-started"))}),mt(()=>{$()}),(W,N)=>(r(),i("div",mr,[C.value?(r(),i("div",fr,[e("div",pr," Question "+d(g.value+1)+" / "+d(b.value.length),1),e("div",hr,[e("h3",br,d(C.value.question),1),e("div",yr,[(r(!0),i(de,null,ve(C.value.options,(ie,S)=>(r(),i("button",{key:S,class:J(["option-btn",M(S)]),disabled:o.value,onClick:R=>T(S)},d(ie),11,xr))),128))]),o.value?(r(),i("div",{key:0,class:J(["feedback",l.value])},d(c.value),3)):B("",!0)]),e("div",wr,[e("div",{class:"timer-bar",style:xe({width:`${x.value}%`})},null,4)])])):B("",!0),e("div",kr,d(k.value),1)]))}},Cr=Ie(_r,[["__scopeId","data-v-632b2750"]]),$r={class:"pattern-builder-game"},Sr={class:"pattern-display"},Ir={class:"pattern-items"},Ar={class:"player-pattern"},Tr={class:"pattern-items"},Mr=["onClick"],Lr={key:0,class:"pattern-item empty"},Er={class:"available-items"},Dr={class:"items-grid"},Pr=["disabled","onClick"],Wr={class:"game-instructions"},jr={__name:"PatternBuilder",props:{gameData:{type:Object,required:!0},score:{type:Number,default:0},lives:{type:Number,default:3},timeRemaining:{type:Number,default:60}},emits:["score-change","life-lost","game-complete","item-collected","game-started"],setup(s,{emit:t}){const n=s,a=t,g=f([]),o=f([]),v=f([]),c=f(0),l=f(!1),_=f(!0),w=O(()=>{var M;return((M=n.gameData)==null?void 0:M.instructions)||"Build the pattern using the items below!"}),P=O(()=>{var M,$;return((M=n.gameData)==null?void 0:M.items)||(($=n.gameData)==null?void 0:$.patterns)||[]}),k=()=>{if(c.value>=P.value.length){a("game-complete",{reason:"all-patterns-completed"}),_.value=!1;return}const M=P.value[c.value];Array.isArray(M)?g.value=[...M]:M.pattern?g.value=[...M.pattern]:g.value=["A","B","C"],o.value=[],l.value=!1;const $=[...g.value];M.distractors&&$.push(...M.distractors);const W=b($);v.value=W.map((N,ie)=>({id:ie,text:N,available:!0}))},b=M=>{const $=[...M];for(let W=$.length-1;W>0;W--){const N=Math.floor(Math.random()*(W+1));[$[W],$[N]]=[$[N],$[W]]}return $},C=M=>{!M.available||!_.value||o.value.length<g.value.length&&(o.value.push(M.text),M.available=!1)},x=M=>{if(!_.value||l.value)return;const $=o.value[M];o.value.splice(M,1);const W=v.value.find(N=>N.text===$&&!N.available);W&&(W.available=!0)},m=()=>{if(o.value.length!==g.value.length)return;if(l.value=!0,o.value.every(($,W)=>$===g.value[W])){const $=25+g.value.length*5;a("score-change",$),a("item-collected",{isCorrect:!0}),setTimeout(()=>{c.value++,k()},1500)}else a("score-change",-10),a("life-lost"),a("item-collected",{isCorrect:!1}),setTimeout(()=>{T()},2e3)},T=()=>{o.value=[],l.value=!1,v.value.forEach(M=>{M.available=!0})},L=M=>l.value?o.value[M]===g.value[M]:!1,E=M=>l.value?o.value[M]!==g.value[M]:!1;return ke(()=>n.lives,M=>{M<=0&&(_.value=!1)}),ke(()=>n.timeRemaining,M=>{M<=0&&(_.value=!1)}),nt(()=>{P.value.length>0&&(k(),a("game-started"))}),(M,$)=>(r(),i("div",$r,[e("div",Sr,[$[0]||($[0]=e("h3",{class:"pattern-title"},"Build this pattern:",-1)),e("div",Ir,[(r(!0),i(de,null,ve(g.value,(W,N)=>(r(),i("div",{key:`target-${N}`,class:"pattern-item target"},d(W),1))),128))])]),e("div",Ar,[$[2]||($[2]=e("h3",{class:"pattern-title"},"Your pattern:",-1)),e("div",Tr,[(r(!0),i(de,null,ve(o.value,(W,N)=>(r(),i("div",{key:`player-${N}`,class:J(["pattern-item player",{correct:L(N),wrong:E(N)}]),onClick:ie=>x(N)},[Se(d(W)+" ",1),$[1]||($[1]=e("span",{class:"remove-icon"},"Ã—",-1))],10,Mr))),128)),o.value.length<g.value.length?(r(),i("div",Lr," ? ")):B("",!0)])]),e("div",Er,[$[3]||($[3]=e("h3",{class:"items-title"},"Drag or click items:",-1)),e("div",Dr,[(r(!0),i(de,null,ve(v.value,(W,N)=>(r(),i("button",{key:`available-${N}`,class:"item-btn",disabled:!W.available,onClick:ie=>C(W)},d(W.text),9,Pr))),128))])]),o.value.length===g.value.length?(r(),i("button",{key:0,class:"check-btn",onClick:m}," Check Pattern ")):B("",!0),e("div",Wr,d(w.value),1)]))}},zr=Ie(jr,[["__scopeId","data-v-9d121a37"]]),qr={class:"flex flex-col items-center justify-center min-h-[400px] w-full bg-slate-50 p-6 rounded-2xl border border-slate-200 shadow-sm relative overflow-hidden"},Rr={key:0,class:"w-1 h-1 bg-slate-200 rounded-full mx-auto mt-[40%]"},Vr={class:"relative w-4/5 h-4/5"},xt=48,Et=8,Wt=10,Fr={__name:"MazeRunner",props:{grid:{type:Array,default:()=>[[1,1,1,1,1,1,1,1,1,1],[1,0,0,0,1,0,0,0,0,1],[1,0,1,0,1,0,1,1,0,1],[1,0,1,0,0,0,0,1,0,1],[1,0,1,1,1,1,0,1,0,1],[1,0,0,0,0,0,0,1,0,1],[1,1,1,1,1,1,1,1,0,1],[1,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1]]},robotPos:{type:Object,default:()=>({x:1,y:1})},goalPos:{type:Object,default:()=>({x:8,y:7})}},setup(s){const t=s,n=f({...t.robotPos}),a=f(!1),g=O(()=>t.robotPos||n.value),o=O(()=>t.goalPos),v=O(()=>xt*Wt+Et*(Wt-1)+32),c=O(()=>xt*t.grid.length+Et*(t.grid.length-1)+32),l=O(()=>t.grid.flat()),_=w=>{if(!w)return{};const P=16+w.x*(xt+Et),k=16+w.y*(xt+Et);return{width:`${xt}px`,height:`${xt}px`,transform:`translate(${P}px, ${k}px)`}};return ke(()=>t.robotPos,()=>{a.value=!0,setTimeout(()=>a.value=!1,500)},{deep:!0}),(w,P)=>(r(),i("div",qr,[P[2]||(P[2]=et('<div class="absolute top-0 left-0 w-full h-full opacity-30 pointer-events-none bg-[radial-gradient(#e0e7ff_1px,transparent_1px)] [background-size:16px_16px]" data-v-357da0eb></div><div class="relative z-10 mb-6 flex justify-between w-full max-w-md px-4" data-v-357da0eb><div class="flex flex-col" data-v-357da0eb><span class="text-xs font-bold tracking-wider text-slate-400 uppercase" data-v-357da0eb>Current Level</span><span class="text-2xl font-black text-slate-800" data-v-357da0eb>01</span></div><div class="flex flex-col items-end" data-v-357da0eb><span class="text-xs font-bold tracking-wider text-slate-400 uppercase" data-v-357da0eb>Status</span><span class="flex items-center gap-2 text-sm font-bold text-indigo-600 bg-indigo-50 px-3 py-1 rounded-full" data-v-357da0eb><span class="relative flex h-2 w-2" data-v-357da0eb><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-indigo-400 opacity-75" data-v-357da0eb></span><span class="relative inline-flex rounded-full h-2 w-2 bg-indigo-500" data-v-357da0eb></span></span> Active </span></div></div>',2)),e("div",{class:"relative bg-white p-4 rounded-xl shadow-[0_8px_30px_rgb(0,0,0,0.04)] border border-slate-100 select-none",style:xe({width:v.value+"px",height:c.value+"px"})},[e("div",{class:"grid w-full h-full",style:xe({gridTemplateColumns:`repeat(${Wt}, 1fr)`,gap:Et+"px"})},[(r(!0),i(de,null,ve(l.value,(k,b)=>(r(),i("div",{key:b,class:J(["rounded-md transition-colors duration-300",[k===1?"bg-slate-800 shadow-inner":"bg-slate-50 border border-slate-100/50"]])},[k===0?(r(),i("div",Rr)):B("",!0)],2))),128))],4),e("div",{class:"absolute flex items-center justify-center text-emerald-500 animate-bounce",style:xe(_(o.value))},P[0]||(P[0]=[e("svg",{class:"w-6 h-6 drop-shadow-lg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 21v-8a2 2 0 012-2h14a2 2 0 012 2v8M10 9H3V5a2 2 0 012-2h4a2 2 0 012 2v4zm10-4h-4m0 0v4m0-4h4a2 2 0 012 2v4m-6 4v.01"})],-1)]),4),e("div",{class:"absolute z-20 flex items-center justify-center transition-all duration-500 cubic-bezier(0.34, 1.56, 0.64, 1)",style:xe(_(g.value))},[e("div",Vr,[e("div",{class:J(["absolute bottom-0 left-1/2 -translate-x-1/2 w-3/4 h-2 bg-black/20 blur-sm rounded-full transition-all duration-500",{"scale-75 opacity-10":a.value,"scale-100 opacity-20":!a.value}])},null,2),P[1]||(P[1]=et('<div class="w-full h-full bg-indigo-600 rounded-xl shadow-lg shadow-indigo-500/30 flex items-center justify-center text-white relative animate-float" data-v-357da0eb><svg class="w-3/5 h-3/5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-357da0eb><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-357da0eb></path></svg><div class="absolute -top-1 w-1 h-2 bg-indigo-400 rounded-full" data-v-357da0eb></div><div class="absolute -top-2 w-2 h-2 bg-red-400 rounded-full animate-pulse" data-v-357da0eb></div></div>',1))])],4)],4),P[3]||(P[3]=et('<div class="mt-6 flex gap-4 text-xs font-mono text-slate-400" data-v-357da0eb><div class="flex items-center gap-1" data-v-357da0eb><span class="px-2 py-1 bg-white border rounded shadow-sm" data-v-357da0eb>WASD</span> to move</div><div class="flex items-center gap-1" data-v-357da0eb><span class="px-2 py-1 bg-white border rounded shadow-sm" data-v-357da0eb>SPACE</span> to jump</div></div>',1))]))}},Br=Ie(Fr,[["__scopeId","data-v-357da0eb"]]),Nr={key:0,class:"game-loading"},Or={__name:"GameContainer",props:{gameData:{type:Object,required:!0},gameType:{type:String,required:!0},userId:{type:String,required:!0},lessonId:{type:String,required:!0},stepIndex:{type:Number,required:!0}},emits:["game-complete","game-exit"],setup(s,{emit:t}){const n=s,a=t,g=f(!1),o=f(!1),v=f(0),c=f(3),l=f(60),_=f(0),w=f(0),P=f(0),k=f(0),b=f(null),C=O(()=>({"basket-catch":Ut,"memory-cards":Ao,"whack-a-mole":gr,"lightning-round":Cr,"pattern-builder":zr,"maze-runner":Br})[n.gameType]||Ut),x=O(()=>n.gameData.timeLimit||60),m=O(()=>n.gameData.lives||3),T=O(()=>w.value===0?0:Math.round(P.value/w.value*100)),L=O(()=>_.value?Math.floor((Date.now()-_.value)/1e3):0),E=()=>{g.value=!0,_.value=Date.now(),c.value=m.value,l.value=x.value,v.value=0,w.value=0,P.value=0,k.value=0,M()},M=()=>{b.value=setInterval(()=>{l.value>0?l.value--:clearInterval(b.value)},1e3)},$=S=>{v.value=Math.max(0,v.value+S)},W=()=>{c.value=Math.max(0,c.value-1)},N=({isCorrect:S})=>{w.value++,S?P.value++:k.value++},ie=async(S={})=>{b.value&&clearInterval(b.value);try{o.value=!0,await Ws({userId:n.userId,lessonId:n.lessonId,stepIndex:n.stepIndex,gameType:n.gameType,score:v.value,accuracy:T.value,timeSpent:L.value,itemsCollected:w.value,correctItems:P.value,wrongItems:k.value,completed:S.completed||!1,metadata:{stars:S.stars||0,livesRemaining:c.value,...S}})}catch(R){console.error("Error submitting game results:",R)}finally{o.value=!1}a("game-complete",{score:v.value,stars:S.stars||0,completed:S.completed||!1,accuracy:T.value})};return mt(()=>{b.value&&clearInterval(b.value)}),(S,R)=>(r(),i("div",{class:J(["game-container",`game-${s.gameType}`])},[(r(),$e(Ps(C.value),{"game-data":s.gameData,score:v.value,lives:c.value,"time-remaining":l.value,onScoreChange:$,onLifeLost:W,onGameComplete:ie,onItemCollected:N,onGameStarted:E},null,40,["game-data","score","lives","time-remaining"])),o.value?(r(),i("div",Nr,R[0]||(R[0]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"Saving results...",-1)]))):B("",!0)],2))}},Hr=Ie(Or,[["__scopeId","data-v-b0986cba"]]),Ur={class:"histogram-wrapper"},Gr={class:"histogram-header"},Qr={class:"histogram-title"},Yr={key:0,class:"histogram-description"},Jr={class:"chart-container"},Zr={class:"chart-inner"},Xr={class:"chart-grid"},Kr={class:"grid-label"},el={class:"bars-container"},tl=["onClick"],sl={class:"bar-value"},al={class:"bar-label"},nl={class:"slider-section"},ol={class:"slider-header"},rl={class:"slider-current-value"},ll={class:"slider-container"},il={class:"slider-min"},cl={class:"slider-track-wrapper"},ul=["min","max","step","disabled"],dl={class:"slider-track"},vl={class:"slider-max"},gl=["disabled"],ml={class:"feedback-icon"},fl={class:"feedback-text"},pl={__name:"ModernHistogram",props:{title:String,description:String,data:{type:Object,required:!0},correctValue:{type:Number,required:!0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1}},emits:["complete","next"],setup(s,{emit:t}){const n=s,a=t,g=f(Math.floor((n.max+n.min)/2)),o=f(-1),v=f(""),c=f(!1),l=f(!1),_=O(()=>n.data||{labels:[],values:[]}),w=O(()=>Math.max(..._.value.values)),P=O(()=>(g.value-n.min)/(n.max-n.min)*100),k=x=>{g.value=Number(x.target.value)},b=x=>{const m=_.value.labels.indexOf(x);o.value=m,g.value=parseInt(x.replace("k","000"))},C=()=>{if(l.value)return;const x=n.step||100;Math.abs(g.value-n.correctValue)<=x?(c.value=!0,v.value="Perfect! You found the correct value!",l.value=!0,a("complete",!0),setTimeout(()=>{a("next")},2e3)):(c.value=!1,v.value="Not quite. Try again!",setTimeout(()=>{v.value=""},2e3))};return ke(()=>n.correctValue,()=>{g.value=Math.floor((n.max+n.min)/2),o.value=-1,v.value="",c.value=!1,l.value=!1}),(x,m)=>(r(),i("div",Ur,[e("div",Gr,[e("h3",Qr,d(s.title||"Data Visualization"),1),s.description?(r(),i("p",Yr,d(s.description),1)):B("",!0)]),e("div",Jr,[e("div",Zr,[e("div",Xr,[(r(),i(de,null,ve(5,T=>e("div",{key:T,class:"grid-line"},[e("span",Kr,d(Math.round(w.value/4*(5-T))),1)])),64))]),e("div",el,[(r(!0),i(de,null,ve(_.value.values,(T,L)=>(r(),i("div",{key:L,class:"bar-wrapper",onClick:E=>b(_.value.labels[L])},[e("div",{class:J(["bar",{"bar-selected":o.value===L}]),style:xe({height:`${T/w.value*100}%`})},[e("div",sl,d(T),1)],6),e("div",al,d(_.value.labels[L]),1)],8,tl))),128))])])]),e("div",nl,[e("div",ol,[m[1]||(m[1]=e("span",{class:"slider-label"},"Select Value",-1)),e("span",rl,d(g.value),1)]),e("div",ll,[e("span",il,d(s.min),1),e("div",cl,[Xe(e("input",{type:"range",min:s.min,max:s.max,step:s.step,"onUpdate:modelValue":m[0]||(m[0]=T=>g.value=T),class:"slider-input",disabled:l.value,onInput:k},null,40,ul),[[tt,g.value,void 0,{number:!0}]]),e("div",dl,[e("div",{class:"slider-fill",style:xe({width:P.value+"%"})},null,4)])]),e("span",vl,d(s.max),1)]),e("button",{onClick:C,disabled:l.value,class:J(["submit-button",{"submit-button-success":l.value}])},d(l.value?"âœ“ Correct!":"Submit Answer"),11,gl),Me(Re,{name:"fade-slide"},{default:Pe(()=>[v.value?(r(),i("div",{key:0,class:J(["feedback",{"feedback-success":c.value,"feedback-error":!c.value}])},[e("span",ml,d(c.value?"ðŸŽ¯":"ðŸ’«"),1),e("span",fl,d(v.value),1)],2)):B("",!0)]),_:1})])]))}},hl=Ie(pl,[["__scopeId","data-v-7df8c6f2"]]),bl={class:"map-wrapper"},yl={class:"map-card"},xl={class:"map-header"},wl={class:"map-title"},kl={class:"map-description"},_l={class:"map-content"},Cl={class:"map-decoration"},$l={class:"lat-lines"},Sl={class:"lon-lines"},Il=["onClick"],Al={class:"marker-pin"},Tl={class:"pin-head"},Ml={key:0,class:"pin-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},Ll={key:1,class:"pin-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},El={key:2,class:"pin-dot"},Dl={class:"marker-label"},Pl={class:"feedback-section"},Wl={class:"feedback-icon-wrapper"},jl={class:"feedback-emoji"},zl={class:"feedback-content"},ql={class:"feedback-title"},Rl={class:"feedback-message"},Vl={key:1,class:"feedback-idle"},Fl={key:0,class:"action-buttons"},Bl=5,Nl={__name:"ModernMap",props:{image:String,title:{type:String,default:"Find the Location"},description:{type:String,default:"Select the correct location marker on the map"},markers:{type:Array,required:!0}},emits:["next","complete"],setup(s,{emit:t}){const n=t,a=f(null),g=f(!1),o=f(!1),v=f(0),c=f(null),l=f({show:!1,x:0,y:0}),_=k=>{if(!o.value){if(c.value){const b=c.value.getBoundingClientRect(),C=k.x/100*b.width,x=k.y/100*b.height;l.value={show:!0,x:C,y:x},setTimeout(()=>{l.value.show=!1},600)}v.value++,a.value=k.id,g.value=!0,k.isCorrect?(o.value=!0,n("complete",!0)):(o.value=!1,n("complete",!1),setTimeout(()=>{o.value||(g.value=!1,a.value=null)},2500))}},w=()=>{n("next")},P=()=>{n("complete",!1),n("next")};return(k,b)=>(r(),i("div",bl,[e("div",yl,[e("div",xl,[b[0]||(b[0]=e("div",{class:"header-badge"},[e("span",{class:"badge-icon"},"ðŸ—ºï¸"),e("span",{class:"badge-text"},"Geography Challenge")],-1)),e("h2",wl,d(s.title),1),e("p",kl,d(s.description),1)]),e("div",{class:"map-container",ref_key:"mapContainer",ref:c},[b[5]||(b[5]=e("div",{class:"map-grid"},null,-1)),e("div",_l,[e("div",Cl,[e("div",$l,[(r(),i(de,null,ve(8,C=>e("div",{key:"lat-"+C,class:"lat-line",style:xe({top:C*12.5+"%"})},null,4)),64))]),e("div",Sl,[(r(),i(de,null,ve(12,C=>e("div",{key:"lon-"+C,class:"lon-line",style:xe({left:C*8.33+"%"})},null,4)),64))])]),b[4]||(b[4]=et('<div class="region-display" data-v-bbdbab1e><svg viewBox="0 0 800 500" class="region-svg" data-v-bbdbab1e><defs data-v-bbdbab1e><linearGradient id="landGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-bbdbab1e><stop offset="0%" style="stop-color:#10b981;stop-opacity:0.1;" data-v-bbdbab1e></stop><stop offset="100%" style="stop-color:#059669;stop-opacity:0.15;" data-v-bbdbab1e></stop></linearGradient></defs><path d="M 200,100 L 700,100 L 700,400 L 500,450 L 200,400 Z" fill="url(#landGradient)" stroke="#10b981" stroke-width="2" stroke-dasharray="10,5" opacity="0.6" data-v-bbdbab1e></path><text x="450" y="260" font-size="48" fill="#94a3b8" opacity="0.3" text-anchor="middle" font-family="Arial, sans-serif" font-weight="bold" data-v-bbdbab1e> ASIA </text></svg></div>',1)),(r(!0),i(de,null,ve(s.markers,C=>(r(),i("div",{key:C.id,class:J(["marker",{"marker-selected":a.value===C.id,"marker-correct":a.value===C.id&&C.isCorrect&&g.value,"marker-incorrect":a.value===C.id&&!C.isCorrect&&g.value,"marker-pulse":a.value===C.id}]),style:xe({left:C.x+"%",top:C.y+"%"}),onClick:x=>_(C)},[e("div",Al,[e("div",Tl,[a.value===C.id&&g.value&&C.isCorrect?(r(),i("svg",Ml,b[1]||(b[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"},null,-1)]))):a.value===C.id&&g.value&&!C.isCorrect?(r(),i("svg",Ll,b[2]||(b[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M6 18L18 6M6 6l12 12"},null,-1)]))):(r(),i("div",El))]),b[3]||(b[3]=e("div",{class:"pin-spike"},null,-1))]),e("div",Dl,d(C.label),1)],14,Il))),128)),l.value.show?(r(),i("div",{key:0,class:"click-ripple",style:xe({left:l.value.x+"px",top:l.value.y+"px"})},null,4)):B("",!0)]),b[6]||(b[6]=et('<div class="compass" data-v-bbdbab1e><div class="compass-rose" data-v-bbdbab1e><div class="compass-n" data-v-bbdbab1e>N</div><div class="compass-arrows" data-v-bbdbab1e><div class="compass-arrow compass-arrow-n" data-v-bbdbab1e>â–²</div><div class="compass-arrow compass-arrow-e" data-v-bbdbab1e>â–¶</div><div class="compass-arrow compass-arrow-s" data-v-bbdbab1e>â–¼</div><div class="compass-arrow compass-arrow-w" data-v-bbdbab1e>â—€</div></div></div></div><div class="scale-indicator" data-v-bbdbab1e><div class="scale-line" data-v-bbdbab1e></div><span class="scale-text" data-v-bbdbab1e>~ 1000 km</span></div>',2))],512),e("div",Pl,[Me(Re,{name:"slide-up",mode:"out-in"},{default:Pe(()=>[g.value?(r(),i("div",{key:0,class:J(["feedback",{"feedback-success":o.value,"feedback-error":!o.value}])},[e("div",Wl,[e("span",jl,d(o.value?"ðŸŽ¯":"ðŸ§­"),1)]),e("div",zl,[e("h3",ql,d(o.value?"Perfect! You found it!":"Not quite the right location"),1),e("p",Rl,d(o.value?"Excellent geographic knowledge! +15 XP":"Try selecting another marker on the map."),1)])],2)):(r(),i("div",Vl,b[7]||(b[7]=[e("span",{class:"feedback-idle-icon"},"ðŸ“",-1),e("span",{class:"feedback-idle-text"},"Click on a location marker to make your selection",-1)])))]),_:1}),g.value?(r(),i("div",Fl,[o.value?(r(),i("button",{key:0,onClick:w,class:"action-button action-button-success"},b[8]||(b[8]=[e("svg",{class:"button-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7l5 5m0 0l-5 5m5-5H6"})],-1),Se(" Continue ")]))):v.value>=Bl?(r(),i("button",{key:1,onClick:P,class:"action-button action-button-skip"},b[9]||(b[9]=[e("svg",{class:"button-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 9l3 3m0 0l-3 3m3-3H8m13 0a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),Se(" Skip & Continue ")]))):B("",!0)])):B("",!0)])])]))}},Ol=Ie(Nl,[["__scopeId","data-v-bbdbab1e"]]),Hl={class:"w-full max-w-6xl mx-auto"},Ul={class:"bg-[linear-gradient(135deg,rgb(139,92,246),rgb(219,39,119))] rounded-3xl p-8 mb-8 shadow-2xl"},Gl={class:"text-white font-black text-2xl mb-3"},Ql={class:"text-white/90 text-base"},Yl={class:"flex flex-col lg:flex-row gap-8 items-start"},Jl={class:"flex-1 order-2 lg:order-1"},Zl={class:"bg-linear-to-br from-slate-900 to-slate-800 rounded-3xl p-8 shadow-2xl border-4 border-purple-500/30"},Xl={key:0},Kl={class:"grid grid-cols-5 gap-3 bg-slate-950/50 p-4 rounded-2xl"},ei={key:1,class:"aspect-square bg-white rounded-2xl relative shadow-inner"},ti={class:"w-full h-full",viewBox:"0 0 200 200"},si=["d"],ai=["cx","cy"],ni={class:"text-base font-bold text-center"},oi={class:"w-full lg:w-80 order-1 lg:order-2 space-y-6"},ri={class:"bg-linear-to-br from-purple-600 to-pink-600 rounded-3xl p-8 shadow-2xl"},li={class:"flex flex-col items-center gap-3"},ii=["disabled"],ci={class:"flex gap-3"},ui=["disabled"],di=["disabled"],vi=["disabled"],gi={__name:"ModernBlockCoding",props:{type:String,title:String,description:String,availableBlocks:{type:Array,default:()=>["move_forward","turn_left","turn_right"]},config:Object},emits:["complete","next"],setup(s,{emit:t}){const n=s,a=t;f([]);const g=f(!1),o=f({x:0,y:0}),v=f(0),c=f([]),l=f({x:100,y:100}),_=f(0),w=f(""),P=f(!1);O(()=>{var L;return n.type==="maze"||((L=n.config)==null?void 0:L.type)==="maze"});const k=O(()=>{var L;return((L=n.config)==null?void 0:L.goal)||{x:4,y:4}}),b=O(()=>{var L;return((L=n.config)==null?void 0:L.walls)||[]}),C=L=>{const E=L%5,M=Math.floor(L/5);return o.value.x===E&&o.value.y===M?"bg-[linear-gradient(135deg,rgb(34,211,238),rgb(59,130,246))] shadow-2xl shadow-cyan-400/60 border-2 border-cyan-300/50":k.value.x===E&&k.value.y===M?"bg-[linear-gradient(135deg,rgb(251,191,36),rgb(245,158,11))] shadow-2xl shadow-amber-400/60 border-2 border-amber-300/50 animate-pulse":b.value.some($=>$.x===E&&$.y===M)?"bg-[linear-gradient(135deg,rgb(88,28,135),rgb(126,34,206))] border-2 border-purple-700/30":"bg-slate-800/40 border border-slate-700/30 hover:bg-slate-700/40 transition-colors"},x=L=>{const E=L%5,M=Math.floor(L/5);return o.value.x===E&&o.value.y===M?"ðŸ¤–":k.value.x===E&&k.value.y===M?"â­":""},m=async L=>{g.value=!0;const M={up:{dx:0,dy:-1},down:{dx:0,dy:1},left:{dx:-1,dy:0},right:{dx:1,dy:0}}[L],$=o.value.x+M.dx,W=o.value.y+M.dy;$>=0&&$<5&&W>=0&&W<5?b.value.some(N=>N.x===$&&N.y===W)?(w.value="ðŸš« Can't move there - wall!",setTimeout(()=>w.value="",1e3)):(o.value={x:$,y:W},o.value.x===k.value.x&&o.value.y===k.value.y&&(w.value="ðŸŽ‰ Goal reached! Perfect!",P.value=!0,setTimeout(()=>{a("complete",!0),a("next")},1500))):(w.value="ðŸš« Can't move outside the maze!",setTimeout(()=>w.value="",1e3)),setTimeout(()=>g.value=!1,300)},T=()=>{var L;o.value=((L=n.config)==null?void 0:L.start)||{x:0,y:0},v.value=0,c.value=[],l.value={x:100,y:100},_.value=0,w.value="",P.value=!1};return T(),nt(()=>{console.log("ModernBlockCoding mounted with props:",n)}),(L,E)=>{var M;return r(),i("div",Hl,[e("div",Ul,[e("h3",Gl,d(s.title||"ðŸŽ® Maze Challenge"),1),e("p",Ql,d(s.description||"Use the arrow buttons to navigate the robot to the golden star!"),1)]),e("div",Yl,[e("div",Jl,[e("div",Zl,[E[4]||(E[4]=e("h4",{class:"text-purple-300 font-bold text-sm uppercase tracking-wider mb-6 text-center"},"ðŸ—ºï¸ Maze Grid",-1)),s.type==="maze"||((M=s.config)==null?void 0:M.type)==="maze"?(r(),i("div",Xl,[e("div",Kl,[(r(),i(de,null,ve(25,($,W)=>e("div",{key:W,class:J(["aspect-square rounded-xl flex items-center justify-center text-4xl transition-all duration-300 shadow-lg",C(W)])},d(x(W)),3)),64))])])):(r(),i("div",ei,[(r(),i("svg",ti,[(r(!0),i(de,null,ve(c.value,($,W)=>(r(),i("path",{key:W,d:`M ${$.from.x} ${$.from.y} L ${$.to.x} ${$.to.y}`,stroke:"#8b5cf6","stroke-width":"2",fill:"none",class:"animate-draw"},null,8,si))),128)),l.value?(r(),i("circle",{key:0,cx:l.value.x,cy:l.value.y,r:"4",fill:"#ec4899",class:"animate-pulse"},null,8,ai)):B("",!0)]))])),w.value?(r(),i("div",{key:2,class:J(["mt-6 p-4 rounded-2xl backdrop-blur-md shadow-lg",P.value?"bg-emerald-500/30 border-2 border-emerald-400 text-emerald-100":"bg-rose-500/30 border-2 border-rose-400 text-rose-100"])},[e("p",ni,d(w.value),1)],2)):B("",!0)])]),e("div",oi,[e("div",ri,[E[5]||(E[5]=e("h4",{class:"text-white font-bold text-base uppercase tracking-wide mb-6 text-center"},"ðŸŽ® Controls",-1)),e("div",li,[e("button",{onClick:E[0]||(E[0]=$=>m("up")),disabled:g.value,class:"w-20 h-20 bg-white/95 hover:bg-white text-purple-600 font-black rounded-2xl hover:shadow-2xl hover:scale-110 transition-all duration-200 disabled:opacity-40 disabled:cursor-not-allowed text-3xl active:scale-95 shadow-xl"}," â¬† ",8,ii),e("div",ci,[e("button",{onClick:E[1]||(E[1]=$=>m("left")),disabled:g.value,class:"w-20 h-20 bg-white/95 hover:bg-white text-purple-600 font-black rounded-2xl hover:shadow-2xl hover:scale-110 transition-all duration-200 disabled:opacity-40 disabled:cursor-not-allowed text-3xl active:scale-95 shadow-xl"}," â¬… ",8,ui),e("button",{onClick:E[2]||(E[2]=$=>m("down")),disabled:g.value,class:"w-20 h-20 bg-white/95 hover:bg-white text-purple-600 font-black rounded-2xl hover:shadow-2xl hover:scale-110 transition-all duration-200 disabled:opacity-40 disabled:cursor-not-allowed text-3xl active:scale-95 shadow-xl"}," â¬‡ ",8,di),e("button",{onClick:E[3]||(E[3]=$=>m("right")),disabled:g.value,class:"w-20 h-20 bg-white/95 hover:bg-white text-purple-600 font-black rounded-2xl hover:shadow-2xl hover:scale-110 transition-all duration-200 disabled:opacity-40 disabled:cursor-not-allowed text-3xl active:scale-95 shadow-xl"}," âž¡ ",8,vi)])])]),e("button",{onClick:T,class:"w-full py-5 bg-linear-to-r from-amber-500 to-orange-500 text-white font-black text-lg rounded-2xl hover:shadow-2xl hover:scale-105 transition-all duration-200 active:scale-95 shadow-xl"}," ðŸ”„ Reset ")])])])}}},mi=Ie(gi,[["__scopeId","data-v-c9536df7"]]),fi={class:"min-h-screen bg-white p-4 md:p-8"},pi={class:"max-w-7xl mx-auto"},hi={key:0,class:"grid lg:grid-cols-2 gap-6 md:gap-8 items-start"},bi={class:"bg-white rounded-2xl border-2 border-purple-200 p-6 md:p-8 shadow-lg"},yi={class:"space-y-1 mb-6 md:mb-8"},xi={class:"text-slate-900 text-base"},wi={class:"font-semibold"},ki={class:"text-purple-600 font-medium text-base"},_i={class:"flex justify-center items-center py-8 md:py-12"},Ci={class:"relative"},$i={width:"280",height:"280",viewBox:"0 0 280 280",class:"max-w-full h-auto"},Si={x:"140",y:"268","text-anchor":"middle",class:"fill-green-600 font-bold text-sm"},Ii={class:"space-y-6"},Ai={class:"bg-white rounded-2xl border-2 border-purple-200 p-6 md:p-8 shadow-lg"},Ti={class:"space-y-3 md:space-y-4"},Mi=["onClick"],Li={class:"font-semibold text-slate-900 mb-1.5"},Ei={class:"font-mono text-purple-600 text-sm"},Di={class:"pt-6"},Pi=["disabled"],Wi={class:"flex items-start gap-3"},ji={class:"flex-shrink-0"},zi={key:0,class:"w-6 h-6 rounded-full bg-teal-500 flex items-center justify-center"},qi={key:1,class:"w-6 h-6 rounded-full bg-red-500 flex items-center justify-center"},Ri={key:0,class:"bg-white rounded-2xl border-2 border-purple-200 p-6 shadow-lg"},Vi={class:"text-slate-700 text-sm md:text-base leading-relaxed"},Fi={__name:"GeometryExercise",props:{geometryData:{type:Object,required:!0},userAnswer:{type:Object,required:!0}},emits:["update:userAnswer","next-exercise","submit"],setup(s,{emit:t}){const n=s,a=t,g=f(null),o=f(null),v=f(!1),c=f(!1),l=O(()=>{var k;return((k=n.userAnswer)==null?void 0:k.side_b)&&o.value}),_=k=>{g.value=k,v.value=!1},w=k=>{o.value=k,v.value=!1},P=()=>{const k=n.geometryData.correctAnswer.side_b,b=n.geometryData.correctAnswer.formulaId,C=parseFloat(n.userAnswer.side_b),x=o.value;c.value=C===k&&x===b,v.value=!0,a("submit",{isCorrect:c.value,userSide:C,userFormula:x})};return ke(()=>n.geometryData,()=>{g.value=null,o.value=null,v.value=!1,c.value=!1},{deep:!0}),(k,b)=>(r(),i("div",fi,[e("div",pi,[b[12]||(b[12]=e("div",{class:"text-center mb-8 md:mb-12"},[e("h1",{class:"text-3xl md:text-4xl font-bold text-slate-900 mb-2"},"Geometry Lesson: Square Properties"),e("p",{class:"text-purple-600 text-lg md:text-xl font-medium"}," Find the missing side length using the correct formula ")],-1)),s.geometryData.mode==="calculate"?(r(),i("div",hi,[e("div",bi,[b[6]||(b[6]=e("h3",{class:"text-purple-600 font-semibold text-lg mb-4 md:mb-6"},"Given Information",-1)),e("div",yi,[e("p",xi,[b[3]||(b[3]=Se("Side a = ")),e("span",wi,d(s.geometryData.given.side_a),1),b[4]||(b[4]=Se(" units"))]),e("p",ki,"Angle = "+d(s.geometryData.given.angle)+"Â°",1)]),e("div",_i,[e("div",Ci,[(r(),i("svg",$i,[b[5]||(b[5]=et('<defs><linearGradient id="rainbowGradient" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#a855f7"></stop><stop offset="25%" stop-color="#ec4899"></stop><stop offset="50%" stop-color="#f97316"></stop><stop offset="75%" stop-color="#eab308"></stop><stop offset="100%" stop-color="#22c55e"></stop></linearGradient></defs><rect x="40" y="40" width="200" height="200" fill="white" stroke="url(#rainbowGradient)" stroke-width="4" rx="4"></rect><path d="M 40 220 L 55 220 L 55 240" fill="none" stroke="#eab308" stroke-width="2"></path><text x="62" y="233" class="text-xs fill-yellow-500 font-medium">90Â°</text>',4)),e("text",Si," side a = "+d(s.geometryData.given.side_a),1),e("g",{onClick:b[0]||(b[0]=C=>_("b")),class:"cursor-pointer transition-all duration-200"},[e("text",{x:"255",y:"140","text-anchor":"start",class:J(["font-bold text-sm",g.value==="b"?"fill-pink-600":"fill-pink-500 hover:fill-pink-600"])}," side b = ? ",2)])]))])])]),e("div",Ii,[e("div",Ai,[b[10]||(b[10]=e("h3",{class:"text-purple-600 font-semibold text-lg mb-6"},"Select the Formula You Used",-1)),e("div",Ti,[(r(!0),i(de,null,ve(s.geometryData.formulas,C=>(r(),i("button",{key:C.id,onClick:x=>w(C.id),class:J(["w-full text-left p-4 md:p-5 rounded-xl border-2 transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98]",o.value===C.id?"border-purple-500 bg-purple-50 shadow-md":"border-gray-200 hover:border-purple-300 bg-white hover:shadow-sm"])},[e("p",Li,d(C.name),1),e("p",Ei,d(C.formula),1)],10,Mi))),128))]),e("div",Di,[b[7]||(b[7]=e("label",{class:"block text-sm font-medium text-slate-900 mb-2"},"Enter value for side b:",-1)),Xe(e("input",{type:"number","onUpdate:modelValue":b[1]||(b[1]=C=>s.userAnswer.side_b=C),placeholder:"Enter value...",class:"w-full p-3 md:p-4 rounded-lg border-2 border-purple-300 bg-white text-slate-900 placeholder:text-slate-400 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition-all"},null,512),[[tt,s.userAnswer.side_b]])]),e("button",{onClick:P,disabled:!l.value,class:"w-full py-3.5 md:py-4 rounded-full font-semibold text-white text-base transition-all transform hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 mt-6 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 shadow-lg"}," Check Answer ",8,Pi),Me(Re,{"enter-active-class":"transition duration-300 ease-out","enter-from-class":"transform scale-95 opacity-0","enter-to-class":"transform scale-100 opacity-100"},{default:Pe(()=>[v.value?(r(),i("div",{key:0,class:J(["mt-4 p-4 rounded-xl border-2",c.value?"bg-teal-50 border-teal-400":"bg-red-50 border-red-400"])},[e("div",Wi,[e("div",ji,[c.value?(r(),i("div",zi,b[8]||(b[8]=[e("span",{class:"text-white text-sm font-bold"},"âœ“",-1)]))):(r(),i("div",qi,b[9]||(b[9]=[e("span",{class:"text-white text-sm font-bold"},"âœ•",-1)])))]),e("div",null,[e("h4",{class:J(["font-bold text-base",c.value?"text-teal-900":"text-red-900"])},d(c.value?"Great job!":"Not quite right"),3),e("p",{class:J(["text-sm mt-1",c.value?"text-teal-800":"text-red-800"])},d(c.value?`Side b = ${s.geometryData.given.side_a} units`:"Review the hint and square property, then try again."),3)])])],2)):B("",!0)]),_:1}),Me(Re,{"enter-active-class":"transition duration-300 ease-out","enter-from-class":"transform scale-95 opacity-0","enter-to-class":"transform scale-100 opacity-100"},{default:Pe(()=>[c.value?(r(),i("button",{key:0,onClick:b[2]||(b[2]=C=>a("next-exercise")),class:"w-full py-3.5 md:py-4 rounded-full font-semibold text-white shadow-lg bg-purple-600 hover:bg-purple-700 transition-all transform hover:scale-[1.02] active:scale-[0.98] mt-4"}," Next â†’ ")):B("",!0)]),_:1})]),s.geometryData.hint?(r(),i("div",Ri,[b[11]||(b[11]=e("h3",{class:"text-purple-600 font-semibold text-base mb-2 flex items-center gap-2"},[e("span",{class:"text-xl"},"ðŸ’¡"),Se(" Hint ")],-1)),e("p",Vi,d(s.geometryData.hint),1)])):B("",!0)])])):B("",!0)])]))}},Bi={class:"data-analysis-container"},Ni={class:"relative z-10"},Oi={class:"da-header"},Hi={class:"da-title"},Ui={class:"da-chart-section"},Gi={class:"da-chart"},Qi={class:"da-bar-value"},Yi={class:"da-tooltip"},Ji={class:"da-bar-label"},Zi={class:"da-axis-label"},Xi={class:"da-input-section"},Ki={class:"da-input-row"},ec=["disabled"],tc={class:"da-input-unit"},sc={class:"da-button-wrapper"},ac=["disabled"],nc={class:"da-feedback-icon"},oc={class:"da-feedback-content"},rc={class:"da-feedback-title"},lc={class:"da-feedback-message"},ic={__name:"DataAnalysisStep",props:{step:{type:Object,default:()=>({prompt:"What is the average rainfall?",numericLabel:"Rainfall (mm)",numericKey:"rainfall",data:[{label:"January",rainfall:45},{label:"February",rainfall:38},{label:"March",rainfall:52}],correctAnswer:45,tolerance:.5})}},emits:["complete"],setup(s,{emit:t}){const n=s,a=t,g=f(null),o=f(!1),v=f({show:!1,isCorrect:!1,message:""}),c=O(()=>n.step.numericLabel||"Value"),l=O(()=>n.step.numericKey||"value"),_=O(()=>(n.step.data||[]).map(x=>({label:x.label||"Item",value:x[l.value]||x.value||0}))),w=O(()=>_.value.length===0?100:Math.max(..._.value.map(C=>C.value))),P=C=>!C||!w.value?5:Math.max(10,C/w.value*100),k=C=>{const x=["bg-gradient-to-t from-blue-600 to-blue-400","bg-gradient-to-t from-cyan-600 to-cyan-400","bg-gradient-to-t from-teal-600 to-teal-400","bg-gradient-to-t from-emerald-600 to-emerald-400","bg-gradient-to-t from-green-600 to-green-400","bg-gradient-to-t from-lime-600 to-lime-400"];return x[C%x.length]},b=()=>{if(g.value===null)return;const C=n.step.tolerance||.5,x=n.step.correctAnswer,m=Math.abs(g.value-x)<=C;o.value=!0,v.value={show:!0,isCorrect:m,message:m?`Excellent! The correct answer is ${x.toFixed(2)}. Your calculation is spot on!`:`The correct answer is ${x.toFixed(2)}. You answered ${g.value.toFixed(2)}. Remember: Average = Sum of all values Ã· Number of values`},a("complete",m)};return(C,x)=>(r(),i("div",Bi,[x[7]||(x[7]=e("div",{class:"absolute inset-0 overflow-hidden pointer-events-none"},[e("div",{class:"bg-decoration bg-decoration-1"}),e("div",{class:"bg-decoration bg-decoration-2"})],-1)),e("div",Ni,[e("div",Oi,[x[2]||(x[2]=e("div",{class:"da-badge"},[e("span",{class:"da-badge-icon"},"ðŸ“Š"),e("span",{class:"da-badge-text"},"Data Analysis")],-1)),e("h2",Hi,d(s.step.prompt||"Analyze the Data"),1)]),e("div",Ui,[e("div",Gi,[(r(!0),i(de,null,ve(_.value,(m,T)=>(r(),i("div",{key:T,class:"da-bar-wrapper"},[e("span",Qi,d(m.value),1),e("div",{class:J(["da-bar bar-animate",k(T)]),style:xe({height:P(m.value)+"%",animationDelay:T*.1+"s"})},[e("div",Yi,d(m.label)+": "+d(m.value)+" "+d(c.value),1)],6),e("span",Ji,d(m.label),1)]))),128))]),e("div",Zi,[e("span",null,d(c.value),1)])]),e("div",Xi,[x[3]||(x[3]=e("label",{class:"da-input-label"}," Enter your answer: ",-1)),e("div",Ki,[Xe(e("input",{type:"number","onUpdate:modelValue":x[0]||(x[0]=m=>g.value=m),disabled:o.value,step:.01,class:"da-input",placeholder:"0.00",onKeyup:jt(b,["enter"])},null,40,ec),[[tt,g.value,void 0,{number:!0}]]),e("span",tc,d(c.value),1)]),x[4]||(x[4]=e("p",{class:"da-hint"}," ðŸ’¡ Tip: Calculate the average of all values (sum Ã· count) ",-1))]),e("div",sc,[o.value?(r(),i("button",{key:1,onClick:x[1]||(x[1]=m=>C.$emit("complete",!0)),class:"da-btn da-btn-success"},x[6]||(x[6]=[Se(" Continue "),e("svg",{class:"da-btn-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7l5 5m0 0l-5 5m5-5H6"})],-1)]))):(r(),i("button",{key:0,onClick:b,disabled:g.value===null||g.value==="",class:"da-btn da-btn-primary"},x[5]||(x[5]=[e("svg",{class:"da-btn-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1),Se(" Calculate ")]),8,ac))]),Me(Re,{"enter-active-class":"transition-all duration-500 ease-out","enter-from-class":"opacity-0 translate-y-4 scale-95","enter-to-class":"opacity-100 translate-y-0 scale-100"},{default:Pe(()=>[v.value.show?(r(),i("div",{key:0,class:J(["da-feedback",v.value.isCorrect?"da-feedback-success":"da-feedback-error"])},[e("div",nc,d(v.value.isCorrect?"ðŸŽ¯":"ðŸ“"),1),e("div",oc,[e("h4",rc,d(v.value.isCorrect?"Correct!":"Not quite"),1),e("p",lc,d(v.value.message),1)])],2)):B("",!0)]),_:1})])]))}},cc=Ie(ic,[["__scopeId","data-v-fd05e49a"]]),uc={class:"interactive-step step-animate-in"},dc={class:"text-lg text-gray-600 mb-6 leading-relaxed"},vc={class:"flex flex-col sm:flex-row gap-8 justify-center items-center sm:items-start"},gc={class:"flex flex-col items-center gap-3"},mc={class:"text-sm font-bold text-gray-500 uppercase tracking-wide"},fc={class:"flex flex-col items-center gap-3"},pc={class:"text-sm font-bold text-gray-500 uppercase tracking-wide"},hc=["onClick","disabled","aria-label"],bc={class:"mt-8"},yc=["disabled"],xc={__name:"FractionVisualStep",props:{step:{type:Object,required:!0}},emits:["complete"],setup(s,{emit:t}){const n=s,a=t,g=f([]),o=f("idle"),v=f("");ke(()=>n.step,()=>{g.value=Array(n.step.userTotalBlocks).fill(!1),o.value="idle",v.value=""},{immediate:!0});const c=O(()=>g.value.filter(Boolean).length),l=b=>({gridTemplateColumns:`repeat(${b<=4?2:b<=9?3:4}, 1fr)`}),_=O(()=>o.value==="correct"?"âœ… Correct! (Equivalent)":o.value==="incorrect"?"âŒ Try again":"Check Answer"),w=O(()=>o.value==="correct"?"bg-green-100 text-green-700 ring-2 ring-green-500 ring-offset-2 cursor-default":o.value==="incorrect"?"bg-red-100 text-red-700 ring-2 ring-red-500 ring-offset-2":"bg-gray-100 text-gray-900 hover:bg-gray-200"),P=b=>{o.value!=="correct"&&(g.value[b]=!g.value[b],o.value==="incorrect"&&(o.value="idle",v.value=""))},k=()=>{const b=n.step.targetNumerator/n.step.targetDenominator,C=c.value/n.step.userTotalBlocks;Math.abs(b-C)<1e-4?(o.value="correct",v.value=`ðŸŽ‰ Perfect! ${c.value}/${n.step.userTotalBlocks} = ${n.step.targetNumerator}/${n.step.targetDenominator}`,a("complete",!0)):(o.value="incorrect",v.value="Not quite equivalent. Try shading a different number of cells.",a("complete",!1),setTimeout(()=>{o.value="idle",v.value=""},2e3))};return(b,C)=>(r(),i("div",uc,[e("p",dc,d(s.step.prompt),1),e("div",vc,[e("div",gc,[e("span",mc," Target: "+d(s.step.targetNumerator)+"/"+d(s.step.targetDenominator),1),e("div",{class:"grid gap-2 bg-gray-100 p-3 rounded-xl border border-gray-200 shadow-inner",style:xe(l(s.step.targetDenominator))},[(r(!0),i(de,null,ve(s.step.targetDenominator,(x,m)=>(r(),i("div",{key:"target-"+m,class:J(["w-12 h-12 rounded-lg border-2 transition-all duration-300",m<s.step.targetNumerator?"bg-blue-500 border-blue-600":"bg-white border-gray-200"])},null,2))),128))],4)]),C[0]||(C[0]=e("div",{class:"text-4xl font-light text-gray-300 self-center hidden sm:block"},"=",-1)),e("div",fc,[e("span",pc," Your Answer: "+d(c.value)+"/"+d(s.step.userTotalBlocks),1),e("div",{class:"grid gap-2 bg-gray-100 p-3 rounded-xl border border-gray-200 shadow-inner cursor-pointer",style:xe(l(s.step.userTotalBlocks))},[(r(!0),i(de,null,ve(g.value,(x,m)=>(r(),i("button",{key:"user-"+m,onClick:T=>P(m),disabled:o.value==="correct",class:J(["w-12 h-12 rounded-lg border-2 transition-all duration-200 transform focus:outline-none",{"bg-blue-500 border-blue-600 shadow-md":x,"bg-white border-gray-200 hover:border-blue-300 hover:scale-105 active:scale-95":!x&&o.value!=="correct"}]),"aria-label":`Toggle cell ${m+1}`},null,10,hc))),128))],4)])]),e("div",bc,[e("button",{onClick:k,disabled:o.value==="correct",class:J(["w-full py-4 rounded-xl font-bold text-lg transition-all shadow-sm",w.value])},d(_.value),11,yc)]),v.value?(r(),i("div",{key:0,class:J(["step-feedback mt-4",o.value])},d(v.value),3)):B("",!0)]))}},wc=Ie(xc,[["__scopeId","data-v-f6e3214c"]]),kc={class:"interactive-step step-animate-in"},_c={class:"text-lg text-gray-600 mb-6 leading-relaxed"},Cc={class:"bg-gray-100 rounded-xl overflow-hidden shadow-inner border border-gray-200 select-none"},$c={viewBox:"0 0 400 300",class:"w-full h-auto"},Sc=["x1","y1","x2","y2"],Ic=["points"],Ac=["cx","cy"],Tc=["d"],Mc=["cx","cy"],Lc={class:"flex items-center gap-4 bg-white p-4 rounded-lg border border-gray-200 shadow-sm mt-6"},Ec={key:0,class:"flex flex-col gap-4 mt-4"},Dc={class:"flex gap-3 flex-wrap"},Pc=["onClick","disabled"],Wc=["disabled"],jc={__name:"GeometryPolyStep",props:{step:{type:Object,required:!0}},emits:["complete"],setup(s,{emit:t}){const n=s,a=t,g=f(0),o=f(null),v=f("idle"),c=[{x:200,y:50},{x:350,y:250},{x:50,y:250}],l={x:200,y:183},_=O(()=>c.map(x=>({x:x.x+(l.x-x.x)*g.value,y:x.y+(l.y-x.y)*g.value}))),w=O(()=>_.value.map(x=>`${x.x},${x.y}`).join(" ")),P=x=>`M ${x.x+15} ${x.y} A 15 15 0 0 1 ${x.x} ${x.y-15}`,k=()=>{g.value<.8&&(v.value="idle",o.value=null)},b=x=>{v.value!=="correct"&&(o.value=x,v.value="idle")},C=()=>{if(!o.value)return;const x=o.value===n.step.correctShape;v.value=x?"correct":"incorrect",a("complete",x)};return(x,m)=>(r(),i("div",kc,[e("p",_c,d(s.step.prompt),1),e("div",Cc,[(r(),i("svg",$c,[(r(!0),i(de,null,ve(_.value,(T,L)=>(r(),i("line",{key:`ray-${L}`,x1:l.x,y1:l.y,x2:T.x,y2:T.y,stroke:"#e5e7eb","stroke-width":"2","stroke-dasharray":"4"},null,8,Sc))),128)),e("polygon",{points:w.value,fill:"rgba(59, 130, 246, 0.1)",stroke:"#3b82f6","stroke-width":"3"},null,8,Ic),(r(!0),i(de,null,ve(_.value,(T,L)=>(r(),i("g",{key:`ext-${L}`},[e("circle",{cx:T.x,cy:T.y,r:"4",fill:"#3b82f6"},null,8,Ac),g.value>.8?(r(),i("path",{key:0,d:P(T),fill:"none",stroke:"#f59e0b","stroke-width":"3",opacity:"0.8"},null,8,Tc)):B("",!0)]))),128)),g.value===1?(r(),i("circle",{key:0,cx:l.x,cy:l.y,r:"15",fill:"none",stroke:"#f59e0b","stroke-width":"4"},null,8,Mc)):B("",!0)]))]),e("div",Lc,[m[1]||(m[1]=e("span",{class:"text-xs font-bold text-gray-500 uppercase"},"Large",-1)),Xe(e("input",{type:"range",min:"0",max:"1",step:"0.01","onUpdate:modelValue":m[0]||(m[0]=T=>g.value=T),onInput:k,class:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"},null,544),[[tt,g.value,void 0,{number:!0}]]),m[2]||(m[2]=e("span",{class:"text-xs font-bold text-gray-500 uppercase"},"Point",-1))]),Me(Re,{"enter-active-class":"transition-all duration-500","enter-from-class":"max-h-0 opacity-0","enter-to-class":"max-h-64 opacity-100","leave-active-class":"transition-all duration-500","leave-from-class":"max-h-64 opacity-100","leave-to-class":"max-h-0 opacity-0"},{default:Pe(()=>[g.value>.5?(r(),i("div",Ec,[m[3]||(m[3]=e("p",{class:"font-semibold text-gray-800"}," What shape do the exterior angles form? ",-1)),e("div",Dc,[(r(!0),i(de,null,ve(s.step.shapes,T=>(r(),i("button",{key:T,onClick:L=>b(T),disabled:v.value==="correct",class:J(["flex-1 min-w-[80px] py-3 px-2 rounded-lg border font-medium transition-all",{"border-blue-500 bg-blue-50 text-blue-700 shadow-sm":o.value===T,"border-gray-200 bg-white text-gray-600 hover:bg-gray-50 hover:border-gray-300":o.value!==T}])},d(T),11,Pc))),128))]),o.value?(r(),i("button",{key:0,onClick:C,disabled:v.value==="correct",class:J(["w-full py-3 rounded-lg font-bold text-white transition-all shadow-md",{"bg-green-500 cursor-default":v.value==="correct","bg-red-500 hover:bg-red-600":v.value==="incorrect","bg-zinc-900 hover:bg-zinc-800":v.value==="idle"}])},d(v.value==="correct"?"Correct!":v.value==="incorrect"?"Incorrect, look closer!":"Confirm"),11,Wc)):B("",!0)])):B("",!0)]),_:1})]))}},zc={class:"interactive-step step-animate-in"},qc={class:"text-lg text-gray-600 mb-6 leading-relaxed"},Rc={class:"grid grid-cols-1 sm:grid-cols-3 gap-8 items-end justify-items-center mb-8"},Vc={class:"flex flex-col gap-3 w-full max-w-[150px]"},Fc=["title"],Bc={class:"flex justify-center"},Nc={class:"chem-tube"},Oc={class:"flex flex-col gap-1"},Hc=["max","disabled"],Uc={class:"flex flex-col items-center gap-4 w-full order-last sm:order-none"},Gc={class:"relative"},Qc={class:"chem-beaker"},Yc={key:0,class:"chem-bubbles"},Jc={key:0,class:"absolute -top-6 -right-8 text-6xl animate-bounce z-10"},Zc=["disabled"],Xc={class:"flex flex-col gap-3 w-full max-w-[150px]"},Kc=["title"],eu={class:"flex justify-center"},tu={class:"chem-tube"},su={class:"flex flex-col gap-1"},au=["max","disabled"],nu={class:"bg-gray-50 rounded-xl p-4 text-sm flex flex-col sm:flex-row justify-between gap-2 border border-gray-100"},ou={class:"text-gray-400"},ru={__name:"ChemMixingStep",props:{step:{type:Object,required:!0}},emits:["complete"],setup(s,{emit:t}){const n=s,a=t,g=f(0),o=f(0),v=f("idle"),c=f(""),l=O(()=>{var x;return((x=n.step.substances)==null?void 0:x[0])||{}}),_=O(()=>{var x;return((x=n.step.substances)==null?void 0:x[1])||{}}),w=(x,m)=>!m||x<=0?0:Math.min(x/m,1)*90,P=O(()=>v.value==="success"?n.step.successColor:v.value==="fail"?n.step.failColor:"#e5e7eb"),k=O(()=>v.value==="mixing"?"Mixing...":v.value==="success"?"Reaction Complete":"Start Reaction"),b=()=>{v.value!=="mixing"&&(v.value="idle",c.value="")},C=()=>{v.value!=="mixing"&&(v.value="mixing",c.value="Mixing... ðŸ§ª",setTimeout(()=>{const x=n.step.tolerance||5,m=Math.abs((g.value||0)-l.value.targetVolume)<=x,T=Math.abs((o.value||0)-_.value.targetVolume)<=x;m&&T?(v.value="success",c.value="âœ… Perfect! The solution is stable and balanced.",a("complete",!0)):(v.value="fail",c.value="ðŸ’¥ The proportions were off! The reaction became unstable.",a("complete",!1))},1500))};return(x,m)=>(r(),i("div",zc,[e("p",qc,d(s.step.prompt),1),e("div",Rc,[e("div",Vc,[e("h3",{class:"text-sm font-bold text-gray-500 text-center truncate",title:l.value.name},d(l.value.name),9,Fc),e("div",Bc,[e("div",Nc,[e("div",{class:"chem-tube-fill",style:xe({height:`${w(g.value,l.value.maxVolume)}%`,backgroundColor:l.value.color})},null,4),m[2]||(m[2]=e("div",{class:"chem-tube-graduations"},null,-1))])]),e("div",Oc,[m[3]||(m[3]=e("label",{class:"text-xs font-semibold text-gray-400"},"Volume (ml)",-1)),Xe(e("input",{type:"number","onUpdate:modelValue":m[0]||(m[0]=T=>g.value=T),max:l.value.maxVolume,min:0,disabled:v.value==="mixing",class:"p-2 border border-gray-200 rounded-lg text-center font-mono font-bold focus:ring-2 focus:ring-purple-400 outline-none bg-white text-gray-900",onInput:b},null,40,Hc),[[tt,g.value,void 0,{number:!0}]])])]),e("div",Uc,[e("div",Gc,[e("div",Qc,[e("div",{class:J(["chem-beaker-fill",{"animate-pulse":v.value==="mixing"}]),style:xe({height:v.value==="idle"?"0%":"75%",backgroundColor:P.value})},null,6),v.value==="mixing"?(r(),i("div",Yc,m[4]||(m[4]=[e("div",{class:"chem-bubble"},null,-1),e("div",{class:"chem-bubble",style:{width:"12px",height:"12px"}},null,-1),e("div",{class:"chem-bubble"},null,-1)]))):B("",!0)]),Me(Re,{name:"bounce"},{default:Pe(()=>[v.value==="fail"?(r(),i("div",Jc," ðŸ’¥ ")):B("",!0)]),_:1})]),e("button",{onClick:C,disabled:v.value==="mixing"||v.value==="success",class:J(["step-btn-primary",{"opacity-50 cursor-wait":v.value==="mixing","step-btn-success":v.value==="success"}])},d(k.value),11,Zc)]),e("div",Xc,[e("h3",{class:"text-sm font-bold text-gray-500 text-center truncate",title:_.value.name},d(_.value.name),9,Kc),e("div",eu,[e("div",tu,[e("div",{class:"chem-tube-fill",style:xe({height:`${w(o.value,_.value.maxVolume)}%`,backgroundColor:_.value.color})},null,4),m[5]||(m[5]=e("div",{class:"chem-tube-graduations"},null,-1))])]),e("div",su,[m[6]||(m[6]=e("label",{class:"text-xs font-semibold text-gray-400"},"Volume (ml)",-1)),Xe(e("input",{type:"number","onUpdate:modelValue":m[1]||(m[1]=T=>o.value=T),max:_.value.maxVolume,min:0,disabled:v.value==="mixing",class:"p-2 border border-gray-200 rounded-lg text-center font-mono font-bold focus:ring-2 focus:ring-purple-400 outline-none bg-white text-gray-900",onInput:b},null,40,au),[[tt,o.value,void 0,{number:!0}]])])])]),e("div",nu,[e("div",null,[m[7]||(m[7]=e("span",{class:"font-semibold"},"Target:",-1)),Se(" "+d(l.value.targetVolume)+"ml + "+d(_.value.targetVolume)+"ml ",1),e("span",ou,"(Â±"+d(s.step.tolerance)+"ml)",1)]),e("div",null,[m[8]||(m[8]=e("span",{class:"font-semibold"},"Current:",-1)),Se(" "+d(g.value||0)+"ml + "+d(o.value||0)+"ml ",1)])]),e("div",{class:J(["step-feedback mt-4",v.value==="success"?"success":v.value==="fail"?"error":""])},d(c.value),3)]))}},lu=Ie(ru,[["__scopeId","data-v-f4b4fac2"]]),iu={class:"interactive-step step-animate-in"},cu={class:"text-lg text-gray-600 mb-6 leading-relaxed"},uu={class:"grid grid-cols-2 gap-4 sm:gap-8"},du={class:"bg-gray-50 p-4 rounded-xl border border-gray-100"},vu={class:"flex flex-col gap-2"},gu=["onClick"],mu={class:"bg-gray-50 p-4 rounded-xl border border-gray-100"},fu={class:"flex flex-col gap-2"},pu=["onClick"],hu={class:"h-8 flex items-center justify-center font-bold text-lg transition-colors duration-300 mt-6"},bu={key:0,class:"bg-green-100 text-green-800 p-4 rounded-xl text-center font-bold mt-4"},yu={__name:"ChemMatchingStep",props:{step:{type:Object,required:!0}},emits:["complete"],setup(s,{emit:t}){const n=s,a=t,g=f(null),o=f(null),v=f([]),c=f({text:"",type:null}),l=O(()=>[...n.step.pairs].sort(()=>Math.random()-.5)),_=O(()=>v.value.length===n.step.pairs.length);ke(_,b=>{b&&a("complete",!0)});const w=(b,C)=>{v.value.includes(C)||b==="name"&&g.value===C||b==="formula"&&o.value===C||(c.value.type==="wrong"&&(c.value={text:"",type:null}),b==="name"?(g.value=C,o.value!==null&&P(C,o.value)):(o.value=C,g.value!==null&&P(g.value,C)))},P=(b,C)=>{b===C?(v.value=[...v.value,b],c.value={text:"âœ… Correct match!",type:"correct"},g.value=null,o.value=null):(c.value={text:"âŒ Not a correct pair. Try again.",type:"wrong"},setTimeout(()=>{g.value=null,o.value=null,c.value.type==="wrong"&&(c.value={text:"",type:null})},1e3))},k=(b,C)=>{const x=v.value.includes(b),m=C==="name"?g.value===b:o.value===b,T=c.value.type==="wrong"&&m;return x?"border-green-500 bg-green-50 text-green-700 cursor-default shadow-none":T?"border-red-500 bg-red-50 text-red-700 animate-pulse":m?"border-purple-500 bg-purple-50 text-purple-700 shadow-sm ring-1 ring-purple-200":"border-gray-200 bg-white text-gray-700 hover:border-gray-300 hover:bg-gray-50"};return(b,C)=>(r(),i("div",iu,[e("p",cu,d(s.step.prompt),1),e("div",uu,[e("div",du,[C[0]||(C[0]=e("h3",{class:"text-sm font-bold text-gray-500 uppercase tracking-wider mb-3"},"Names",-1)),e("div",vu,[(r(!0),i(de,null,ve(s.step.pairs,x=>(r(),i("button",{key:`name-${x.id}`,onClick:m=>w("name",x.id),class:J(["w-full text-left p-3 sm:p-4 rounded-xl border-2 transition-all duration-200 font-medium text-sm sm:text-base",k(x.id,"name")])},d(x.name),11,gu))),128))])]),e("div",mu,[C[1]||(C[1]=e("h3",{class:"text-sm font-bold text-gray-500 uppercase tracking-wider mb-3"},"Formulas",-1)),e("div",fu,[(r(!0),i(de,null,ve(l.value,x=>(r(),i("button",{key:`formula-${x.id}`,onClick:m=>w("formula",x.id),class:J(["w-full text-left p-3 sm:p-4 rounded-xl border-2 transition-all duration-200 font-medium font-mono text-sm sm:text-base",k(x.id,"formula")])},d(x.formula),11,pu))),128))])])]),e("div",hu,[e("span",{class:J(c.value.type==="correct"?"text-green-600":"text-red-500")},d(c.value.text),3)]),_.value?(r(),i("div",bu," ðŸŽ‰ Great job! You matched all correctly. ")):B("",!0)]))}},xu={class:"interactive-step step-animate-in"},wu={class:"text-lg text-gray-600 mb-6 leading-relaxed"},ku={class:"bg-gray-50 p-6 rounded-xl border border-gray-200 flex flex-wrap gap-2 items-center leading-loose mb-6"},_u=["onClick"],Cu={key:0,class:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm mb-6 animate-fade-in"},$u={class:"text-sm font-semibold text-gray-500 mb-3"},Su={class:"text-gray-900 font-bold"},Iu={class:"flex flex-wrap gap-2 mb-3"},Au=["onClick"],Tu={class:"text-xs text-gray-500 italic flex items-center gap-2"},Mu=["disabled"],Lu={__name:"EnglishSentenceFixStep",props:{step:{type:Object,required:!0}},emits:["complete"],setup(s,{emit:t}){const n=s,a=t,g=f([]),o=f(null),v=f(""),c=f(!1);ke(()=>n.step,()=>{var x;(x=n.step.tokens)!=null&&x.length?g.value=[...n.step.tokens]:g.value=n.step.originalSentence.split(" "),v.value="",c.value=!1,o.value=null},{immediate:!0});const l=O(()=>new Set(n.step.errors.map(x=>x.index))),_=O(()=>o.value===null?null:n.step.errors.find(x=>x.index===o.value)),w=O(()=>o.value===null?"":n.step.tokens[o.value]),P=x=>{if(!l.value.has(x))return"border-transparent bg-white cursor-default text-gray-800";const T=x===o.value,L=n.step.errors.find($=>$.index===x),E=L&&g.value[x]===L.correct;let M="cursor-pointer transition-all duration-200 border ";return T&&(M+="ring-2 ring-purple-500 shadow-sm "),E?M+="bg-green-100 text-green-800 border-green-200":M+="bg-orange-100 text-orange-800 border-orange-200",M},k=x=>{if(!l.value.has(x)){o.value=null;return}o.value=x,v.value=""},b=x=>{o.value!==null&&(g.value[o.value]=x)},C=()=>{n.step.errors.every(m=>g.value[m.index]===m.correct)?(v.value="âœ… Great! You fixed all the mistakes.",c.value=!0,a("complete",!0)):(v.value="âŒ There are still some mistakes. Tap the highlighted words.",c.value=!1,a("complete",!1))};return(x,m)=>(r(),i("div",xu,[e("p",wu,d(s.step.prompt),1),e("div",ku,[(r(!0),i(de,null,ve(g.value,(T,L)=>(r(),i("button",{key:L,onClick:E=>k(L),class:J(["sentence-token",P(L)])},d(T),11,_u))),128))]),Me(Re,{name:"slide-fade"},{default:Pe(()=>[_.value?(r(),i("div",Cu,[e("p",$u,[m[0]||(m[0]=Se(" Choose the correct form for: ")),e("span",Su,'"'+d(w.value)+'"',1)]),e("div",Iu,[(r(!0),i(de,null,ve(_.value.options,T=>(r(),i("button",{key:T,onClick:L=>b(T),class:J(["px-4 py-2 rounded-lg border font-medium transition-colors",{"bg-purple-100 text-purple-700 border-purple-300":g.value[o.value]===T,"bg-white text-gray-700 border-gray-200 hover:bg-gray-50":g.value[o.value]!==T}])},d(T),11,Au))),128))]),e("p",Tu,[m[1]||(m[1]=e("span",{class:"text-lg"},"ðŸ’¡",-1)),Se(" "+d(_.value.explanation),1)])])):B("",!0)]),_:1}),e("div",{class:J(["step-feedback mb-4",c.value?"success":"error"])},d(v.value),3),e("button",{onClick:C,disabled:c.value,class:J(["px-6 py-3 rounded-full font-bold text-white shadow-md transition-transform active:scale-95",{"bg-green-500 cursor-default":c.value,"bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700":!c.value}])},d(c.value?"Correct!":"Check Sentence"),11,Mu)]))}},Eu=Ie(Lu,[["__scopeId","data-v-46ae28c6"]]),Du={class:"interactive-step step-animate-in"},Pu={class:"text-lg text-gray-600 mb-6 leading-relaxed"},Wu=["draggable","onDragstart","onDrop"],ju={key:0,class:"text-gray-400 italic"},zu={class:"bg-white p-4 rounded-lg border border-gray-100 shadow-sm mb-6"},qu={class:"text-lg text-gray-800 font-serif"},Ru=["disabled"],Vu={__name:"EnglishSentenceOrderStep",props:{step:{type:Object,required:!0}},emits:["complete"],setup(s,{emit:t}){const n=s,a=t,g=f([]),o=f(null),v=f(""),c=f(!1),l=f(!1);ke(()=>n.step,()=>{var k;(k=n.step.scrambledOptions)!=null&&k.length?g.value=[...n.step.scrambledOptions]:g.value=[...n.step.correctOrder].sort(()=>Math.random()-.5),v.value="",c.value=!1},{immediate:!0});const _=k=>{o.value=k,v.value=""},w=k=>{if(o.value===null||o.value===k)return;const b=[...g.value],[C]=b.splice(o.value,1);b.splice(k,0,C),g.value=b,o.value=null,c.value=!1},P=()=>{g.value.join(" ")===n.step.correctOrder.join(" ")?(v.value="âœ… Perfect! The sentence is in the correct order.",c.value=!0,a("complete",!0)):(v.value="âŒ Not quite. Try rearranging the words again.",c.value=!1,a("complete",!1))};return(k,b)=>(r(),i("div",Du,[e("p",Pu,d(s.step.prompt),1),e("div",{class:J(["bg-gray-50 p-6 rounded-xl border border-gray-200 min-h-[100px] flex flex-wrap gap-3 items-center",{"bg-blue-50 border-blue-200":l.value}]),onDragover:b[1]||(b[1]=qe(C=>l.value=!0,["prevent"])),onDragleave:b[2]||(b[2]=C=>l.value=!1),onDrop:b[3]||(b[3]=C=>l.value=!1)},[(r(!0),i(de,null,ve(g.value,(C,x)=>(r(),i("div",{key:`${x}-${C}`,draggable:!c.value,onDragstart:m=>_(x),onDragover:b[0]||(b[0]=qe(()=>{},["prevent"])),onDrop:m=>w(x),class:J(["px-4 py-2 rounded-full font-medium shadow-sm transition-all duration-200 select-none",{"bg-green-100 text-green-800 border border-green-200 cursor-default":c.value,"bg-white text-gray-800 border border-gray-200 cursor-grab active:cursor-grabbing hover:shadow-md hover:border-blue-300 hover:text-blue-600 active:scale-95":!c.value}])},d(C),43,Wu))),128)),g.value.length===0?(r(),i("span",ju," Loading words... ")):B("",!0)],34),b[5]||(b[5]=e("p",{class:"text-sm text-gray-500 italic flex items-center gap-2 mb-6"},[e("span",{class:"text-lg"},"ðŸ’¡"),Se(" Hint: Drag words to reorder them. ")],-1)),e("div",zu,[b[4]||(b[4]=e("span",{class:"text-gray-500 text-sm font-semibold uppercase tracking-wider block mb-1"}," Preview ",-1)),e("p",qu,d(g.value.join(" ")),1)]),e("div",{class:J(["step-feedback mb-4",c.value?"success":"error"])},d(v.value),3),e("button",{onClick:P,disabled:c.value,class:J(["px-6 py-3 rounded-full font-bold text-white shadow-md transition-transform active:scale-95",{"bg-green-500 cursor-default":c.value,"bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700":!c.value}])},d(c.value?"âœ“ Correct!":"Check Sentence"),11,Ru)]))}},Fu={class:"interactive-step step-animate-in"},Bu={class:"text-lg text-gray-600 mb-8 leading-relaxed"},Nu={class:"text-sm font-bold text-gray-500 uppercase tracking-wider mb-3"},Ou={class:"flex flex-wrap gap-2"},Hu=["draggable","onDragstart","onClick"],Uu={key:0,class:"text-gray-400 italic text-sm self-center"},Gu={class:"flex flex-col items-center mt-8"},Qu={class:"relative w-full max-w-sm"},Yu={class:"text-sm font-bold text-indigo-400 uppercase tracking-wider mb-4"},Ju={class:"flex flex-wrap gap-2 justify-center w-full"},Zu={key:0,class:"text-indigo-300 text-sm italic py-4 border-2 border-dashed border-indigo-200 rounded-lg w-full text-center pointer-events-none"},Xu=["draggable","onDragstart","onClick"],Ku={class:"flex justify-start mt-4"},ed=["disabled"],td={__name:"LanguageNounBagStep",props:{step:{type:Object,required:!0}},emits:["complete"],setup(s,{emit:t}){const n=s,a=t,g=f([]),o=f([]),v=f(""),c=f("idle"),l=f(null),_=O(()=>n.step.targetPos||"noun"),w=O(()=>n.step.availableLabel||"Available Words"),P=O(()=>n.step.bagLabel?n.step.bagLabel:{noun:"Noun Bag",verb:"Verb Collection",adj:"Adjective Box",adv:"Adverb Container"}[_.value]||"Word Bag"),k=O(()=>n.step.emptyAvailableMessage||"All words are in the bag."),b=O(()=>n.step.emptyBagMessage||"Drag words here"),C=O(()=>n.step.checkButtonLabel||"Check Selection"),x=O(()=>n.step.words.filter($=>$.pos===_.value));ke(()=>n.step,()=>{g.value=[...n.step.words],o.value=[],v.value="",c.value="idle",l.value=null},{immediate:!0});const m=$=>{if(c.value==="correct")return;const W=[...g.value],[N]=W.splice($,1);g.value=W,o.value=[...o.value,N],v.value="",c.value="idle"},T=$=>{if(c.value==="correct")return;const W=[...o.value],[N]=W.splice($,1);o.value=W,g.value=[...g.value,N],v.value="",c.value="idle"},L=()=>{const $=o.value.filter(R=>R.pos===_.value),W=o.value.filter(R=>R.pos!==_.value),N=x.value.every(R=>$.some(ee=>ee.text===R.text)),ie=W.length===0;N&&ie?(v.value=n.step.successMessage||`âœ… Perfect! All ${_.value}s are in the bag.`,c.value="correct",a("complete",!0)):W.length>0?(v.value=n.step.extraWordsMessage||`âŒ You included non-${_.value}s in the bag. Remove them.`,c.value="incorrect",a("complete",!1)):(v.value=n.step.missingWordsMessage||`âŒ You haven't added all ${_.value}s yet.`,c.value="incorrect",a("complete",!1))},E=($,W,N)=>{if(c.value==="correct"){$.preventDefault();return}l.value={source:W,index:N},$.dataTransfer.effectAllowed="move"},M=$=>{!l.value||c.value==="correct"||(l.value.source==="available"&&$==="bag"?m(l.value.index):l.value.source==="bag"&&$==="available"&&T(l.value.index),l.value=null)};return($,W)=>{var N,ie,S,R;return r(),i("div",Fu,[e("p",Bu,d(s.step.prompt),1),e("div",{class:J(["bg-gray-50 p-4 rounded-xl border-2 transition-all duration-200 min-h-[120px]",{"border-blue-300 bg-blue-50 ring-2 ring-blue-100":((N=l.value)==null?void 0:N.source)==="bag","border-gray-200":((ie=l.value)==null?void 0:ie.source)!=="bag"}]),onDragover:W[0]||(W[0]=qe(()=>{},["prevent"])),onDrop:W[1]||(W[1]=ee=>M("available"))},[e("h3",Nu,d(w.value),1),e("div",Ou,[(r(!0),i(de,null,ve(g.value,(ee,se)=>(r(),i("div",{key:`${se}-${ee.text}`,draggable:c.value!=="correct",onDragstart:ce=>E(ce,"available",se),onClick:ce=>m(se),class:J(["px-4 py-2 rounded-full border border-gray-300 bg-white text-gray-700 font-medium transition-all active:scale-95 select-none cursor-grab active:cursor-grabbing",{"hover:bg-gray-100 hover:border-gray-400 hover:shadow-sm":c.value!=="correct","opacity-50 cursor-not-allowed":c.value==="correct"}])},d(ee.text),43,Hu))),128)),g.value.length===0?(r(),i("span",Uu,d(k.value),1)):B("",!0)])],34),e("div",Gu,[e("div",Qu,[W[5]||(W[5]=e("div",{class:"absolute -top-4 left-1/2 transform -translate-x-1/2 w-16 h-8 border-4 border-gray-400 rounded-t-xl z-0"},null,-1)),e("div",{class:J(["relative z-10 bg-indigo-50 border-4 rounded-2xl p-6 min-h-[160px] shadow-lg flex flex-col items-center transition-all duration-200",{"border-indigo-400 bg-indigo-100 ring-4 ring-indigo-200 scale-[1.02]":((S=l.value)==null?void 0:S.source)==="available","border-indigo-200":((R=l.value)==null?void 0:R.source)!=="available"}]),onDragover:W[2]||(W[2]=qe(()=>{},["prevent"])),onDrop:W[3]||(W[3]=ee=>M("bag"))},[e("h3",Yu,d(P.value),1),e("div",Ju,[o.value.length===0?(r(),i("div",Zu,d(b.value),1)):B("",!0),(r(!0),i(de,null,ve(o.value,(ee,se)=>(r(),i("div",{key:`bag-${se}-${ee.text}`,draggable:c.value!=="correct",onDragstart:ce=>E(ce,"bag",se),onClick:ce=>T(se),class:J(["px-4 py-2 rounded-full border border-indigo-300 bg-indigo-100 text-indigo-800 font-medium transition-all active:scale-95 select-none cursor-grab active:cursor-grabbing group relative",{"hover:bg-red-50 hover:text-red-600 hover:border-red-200":c.value!=="correct","opacity-80 cursor-not-allowed":c.value==="correct"}])},[Se(d(ee.text)+" ",1),W[4]||(W[4]=e("span",{class:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 font-bold text-xs pointer-events-none text-red-500"}," âœ• ",-1))],42,Xu))),128))])],34),W[6]||(W[6]=e("div",{class:"flex justify-between px-8 -mt-3 relative z-20"},[e("div",{class:"w-6 h-6 bg-gray-800 rounded-full shadow-md"}),e("div",{class:"w-6 h-6 bg-gray-800 rounded-full shadow-md"})],-1))])]),e("div",{class:J(["step-feedback mt-6",c.value==="correct"?"success":c.value==="incorrect"?"error":""])},d(v.value),3),e("div",Ku,[e("button",{onClick:L,disabled:c.value==="correct",class:J(["px-8 py-3 rounded-full font-bold text-white shadow-md transition-transform active:scale-95",{"bg-green-500 cursor-default":c.value==="correct","bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700":c.value!=="correct"}])},d(c.value==="correct"?"Correct!":C.value),11,ed)])])}}},sd={class:"interactive-step step-animate-in"},ad={class:"text-center mb-8"},nd={class:"text-lg text-gray-600 leading-relaxed max-w-xl mx-auto"},od={class:"relative mb-8"},rd={class:"absolute -top-3 left-4 px-3 py-1 bg-white text-xs font-bold text-gray-500 uppercase tracking-wider"},ld={class:"bg-gradient-to-br from-gray-50 to-gray-100 border-2 border-gray-200 rounded-2xl p-6"},id={class:"text-xl text-gray-800 font-medium leading-relaxed"},cd={class:"mt-3 flex items-center gap-2"},ud={class:"flex justify-center mb-8"},dd={class:"relative"},vd={class:"absolute -right-24 top-1/2 -translate-y-1/2 px-3 py-1 rounded-full bg-fuchsia-100 text-fuchsia-700 font-bold text-sm whitespace-nowrap"},gd={class:"relative mb-8"},md={key:0,class:"space-y-4"},fd={class:"min-h-[60px] bg-white rounded-xl border-2 border-dashed border-gray-300 p-4 flex flex-wrap gap-2 items-center"},pd={key:0,class:"text-gray-400 italic"},hd=["onClick"],bd={class:"flex flex-wrap gap-2 justify-center"},yd=["onClick","disabled"],xd={class:"flex justify-center gap-2 mt-4"},wd=["onClick"],kd={key:1,class:"text-center"},_d={class:"mt-3 flex items-center justify-center gap-2"},Cd={key:0,class:"mb-8 p-4 bg-amber-50 rounded-xl border border-amber-200"},$d={class:"flex items-start gap-3"},Sd={class:"font-semibold text-amber-800 mb-1"},Id={class:"text-amber-700 text-sm"},Ad={class:"flex justify-start gap-3"},Td=["disabled"],Md={key:1,class:"mt-4 p-4 bg-blue-50 rounded-xl border border-blue-200"},Ld={class:"text-blue-800"},Ed={__name:"LanguageToneTransformer",props:{step:{type:Object,required:!0}},emits:["complete"],setup(s,{emit:t}){const n={props:["tone"],template:`
    <div class="flex items-center gap-2 text-sm">
      <div class="flex gap-0.5">
        <div v-for="i in 5" :key="i"
             class="w-2 h-4 rounded-sm transition-all"
             :class="i <= getToneLevel(tone) ? getToneBarColor(tone) : 'bg-gray-200'"
             :style="{ height: (12 + i * 3) + 'px' }">
        </div>
      </div>
      <span :class="getToneLabelColor(tone)" class="font-medium">{{ getToneEmoji(tone) }} {{ tone }}</span>
    </div>
  `,methods:{getToneLevel(S){return{formal:5,neutral:3,casual:2,sarcastic:4,enthusiastic:5,romantic:4}[S]||3},getToneBarColor(S){return{formal:"bg-blue-500",neutral:"bg-gray-500",casual:"bg-green-500",sarcastic:"bg-purple-500",enthusiastic:"bg-orange-500",romantic:"bg-pink-500"}[S]||"bg-gray-500"},getToneLabelColor(S){return{formal:"text-blue-600",neutral:"text-gray-600",casual:"text-green-600",sarcastic:"text-purple-600",enthusiastic:"text-orange-600",romantic:"text-pink-600"}[S]||"text-gray-600"},getToneEmoji(S){return{formal:"ðŸŽ©",neutral:"ðŸ˜",casual:"ðŸ˜Ž",sarcastic:"ðŸ˜",enthusiastic:"ðŸŽ‰",romantic:"ðŸ’•"}[S]||"ðŸ’¬"}}},a=s,g=t,o=f([]),v=f([]),c=f(""),l=f(!1),_=f(0),w=f(!1),P=O(()=>{var se;const S=((se=a.step.correctAnswer)==null?void 0:se.split(" "))||[],R=a.step.distractors||[];return[...S,...R].sort(()=>Math.random()-.5)});ke(()=>a.step,()=>{o.value=[],v.value=[],c.value="",l.value=!1,_.value=0,w.value=!1},{immediate:!0});const k=S=>{v.value.includes(S)||l.value||(o.value.push(P.value[S]),v.value.push(S),c.value="")},b=S=>{if(l.value)return;const R=o.value[S],ee=P.value.findIndex((se,ce)=>se===R&&v.value.includes(ce));o.value.splice(S,1),v.value=v.value.filter(se=>P.value[se]!==R||se!==ee),c.value=""},C=S=>{if(!l.value&&o.value.length>0){const R=o.value.length-1;o.value[R]=o.value[R].replace(/[.,!?]+$/,"")+S}},x=()=>{o.value=[],v.value=[],c.value=""},m=()=>{w.value=!0},T=()=>{_.value++;const S=o.value.join(" ").toLowerCase().replace(/\s+/g," ").trim(),R=a.step.correctAnswer.toLowerCase().replace(/\s+/g," ").trim(),ee=(a.step.alternatives||[]).map(ce=>ce.toLowerCase().replace(/\s+/g," ").trim());S===R||ee.includes(S)?(l.value=!0,c.value=`âœ¨ Brilliant! You've mastered the ${E(a.step.targetTone)} tone!`,g("complete",!0)):(c.value=`Not quite the right tone. ${L()}`,g("complete",!1))},L=()=>({formal:"Try using more polite, professional language.",casual:"Make it sound more relaxed and friendly!",sarcastic:"Add some ironic or mocking undertones.",enthusiastic:"Show more excitement and energy!",romantic:"Make it more affectionate and tender."})[a.step.targetTone]||"Try matching the tone more closely.",E=S=>({formal:"Formal",neutral:"Neutral",casual:"Casual",sarcastic:"Sarcastic",enthusiastic:"Enthusiastic",romantic:"Romantic"})[S]||S,M=S=>({formal:"text-blue-600",casual:"text-green-600",sarcastic:"text-purple-600",enthusiastic:"text-orange-600",romantic:"text-pink-600"})[S]||"text-gray-600",$=S=>({formal:"text-blue-800",casual:"text-green-800",sarcastic:"text-purple-800",enthusiastic:"text-orange-800",romantic:"text-pink-800"})[S]||"text-gray-800",W=()=>l.value?"bg-gradient-to-br from-green-50 to-emerald-50 border-green-300":{formal:"bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200",casual:"bg-gradient-to-br from-green-50 to-teal-50 border-green-200",sarcastic:"bg-gradient-to-br from-purple-50 to-violet-50 border-purple-200",enthusiastic:"bg-gradient-to-br from-orange-50 to-amber-50 border-orange-200",romantic:"bg-gradient-to-br from-pink-50 to-rose-50 border-pink-200"}[a.step.targetTone]||"bg-gray-50 border-gray-200",N=S=>({formal:"Use polite phrases, complete sentences, and respectful vocabulary. Avoid contractions and slang.",casual:"Be relaxed! Use contractions, simple words, and friendly expressions.",sarcastic:"Say the opposite of what you mean, use exaggeration, or add ironic praise.",enthusiastic:"Show excitement! Use exclamation marks, positive superlatives, and energetic words.",romantic:"Express affection with tender words, poetic language, and emotional expressions."})[S]||"Match the target tone as closely as possible.",ie=O(()=>c.value?l.value?"success":"error":"");return(S,R)=>(r(),i("div",sd,[e("div",ad,[R[0]||(R[0]=e("div",{class:"inline-flex items-center gap-3 px-5 py-2 rounded-full bg-gradient-to-r from-violet-100 to-fuchsia-100 border border-violet-200 mb-4"},[e("span",{class:"text-2xl"},"ðŸŽ­"),e("span",{class:"font-bold text-violet-700"},"Tone Transformer")],-1)),e("p",nd,d(s.step.prompt||"Transform the sentence to match the target tone"),1)]),e("div",od,[e("div",rd," Original ("+d(E(s.step.originalTone))+") ",1),e("div",ld,[e("p",id,' "'+d(s.step.originalSentence)+'" ',1),e("div",cd,[Me(n,{tone:s.step.originalTone},null,8,["tone"])])])]),e("div",ud,[e("div",dd,[R[1]||(R[1]=e("div",{class:"w-16 h-16 rounded-full bg-gradient-to-br from-violet-500 to-fuchsia-500 flex items-center justify-center shadow-lg transform-arrow"},[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"})])],-1)),e("div",vd," Transform to: "+d(E(s.step.targetTone)),1)])]),e("div",gd,[e("div",{class:J(["absolute -top-3 left-4 px-3 py-1 bg-white text-xs font-bold uppercase tracking-wider",M(s.step.targetTone)])}," Target Tone: "+d(E(s.step.targetTone)),3),e("div",{class:J(["border-2 rounded-2xl p-6 transition-all duration-300",W()])},[l.value?(r(),i("div",kd,[e("p",{class:J(["text-xl font-medium leading-relaxed",$(s.step.targetTone)])},' "'+d(o.value.join(" "))+'" ',3),e("div",_d,[Me(n,{tone:s.step.targetTone},null,8,["tone"])])])):(r(),i("div",md,[R[3]||(R[3]=e("p",{class:"text-sm text-gray-500 mb-4"},"Click on words to build your transformed sentence:",-1)),e("div",fd,[o.value.length===0?(r(),i("span",pd," Your sentence will appear here... ")):B("",!0),(r(!0),i(de,null,ve(o.value,(ee,se)=>(r(),i("div",{key:`selected-${se}`,onClick:ce=>b(se),class:"px-3 py-1.5 rounded-full bg-violet-100 text-violet-800 font-medium cursor-pointer hover:bg-red-100 hover:text-red-600 transition-colors group"},[Se(d(ee)+" ",1),R[2]||(R[2]=e("span",{class:"ml-1 opacity-0 group-hover:opacity-100 transition-opacity"},"Ã—",-1))],8,hd))),128))]),e("div",bd,[(r(!0),i(de,null,ve(P.value,(ee,se)=>(r(),i("button",{key:`word-${se}`,onClick:ce=>k(se),disabled:v.value.includes(se),class:J(["px-4 py-2 rounded-full font-medium transition-all duration-200 transform hover:scale-105",v.value.includes(se)?"bg-gray-200 text-gray-400 cursor-not-allowed opacity-50":"bg-white border-2 border-gray-200 text-gray-700 hover:border-violet-400 hover:bg-violet-50 hover:shadow-md cursor-pointer"])},d(ee),11,yd))),128))]),e("div",xd,[(r(),i(de,null,ve([".","!","?",",","..."],ee=>e("button",{key:ee,onClick:se=>C(ee),class:"w-10 h-10 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-600 font-bold transition-colors"},d(ee),9,wd)),64)),e("button",{onClick:x,class:"px-4 h-10 rounded-lg bg-red-50 hover:bg-red-100 text-red-600 font-medium transition-colors"}," Clear ")])]))],2)]),!l.value&&s.step.showGuide!==!1?(r(),i("div",Cd,[e("div",$d,[R[4]||(R[4]=e("span",{class:"text-xl"},"ðŸ’¡",-1)),e("div",null,[e("p",Sd,"Tone Guide: "+d(E(s.step.targetTone)),1),e("p",Id,d(N(s.step.targetTone)),1)])])])):B("",!0),e("div",{class:J(["step-feedback mb-4",ie.value])},d(c.value),3),e("div",Ad,[e("button",{onClick:T,disabled:l.value||o.value.length===0,class:J(["px-8 py-3 rounded-full font-bold text-white shadow-md transition-all active:scale-95",l.value?"bg-green-500 cursor-default":"bg-gradient-to-r from-violet-600 to-fuchsia-600 hover:from-violet-700 hover:to-fuchsia-700"])},d(l.value?"âœ“ Perfect Transformation!":"Check Tone"),11,Td),!l.value&&_.value>0?(r(),i("button",{key:0,onClick:m,class:"px-6 py-3 rounded-full font-medium text-violet-600 bg-violet-50 hover:bg-violet-100 transition-colors"}," Show Hint ")):B("",!0)]),w.value&&!l.value?(r(),i("div",Md,[e("p",Ld,[R[5]||(R[5]=e("span",{class:"font-bold"},"Hint:",-1)),Se(" "+d(s.step.hint||`Try starting with: "${s.step.correctAnswer.split(" ").slice(0,3).join(" ")}..."`),1)])])):B("",!0)]))}},Dd=Ie(Ed,[["__scopeId","data-v-8cf2fb6e"]]),Pd={class:"interactive-step step-animate-in"},Wd={class:"text-center mb-8"},jd={class:"text-lg text-gray-600 leading-relaxed max-w-xl mx-auto"},zd={class:"flex justify-between mb-4 px-4"},qd={class:"flex items-center gap-2"},Rd={class:"text-2xl"},Vd={class:"font-bold text-gray-700"},Fd={class:"flex items-center gap-2"},Bd={class:"font-bold text-gray-700"},Nd={class:"text-2xl"},Od=["d","stroke"],Hd=["d"],Ud={class:"flex justify-between gap-8"},Gd={class:"flex-1 space-y-4"},Qd=["onMousedown","onTouchstart"],Yd={class:"idiom-content"},Jd={class:"font-semibold text-gray-800"},Zd={key:0,class:"text-sm text-gray-500 italic mt-1"},Xd={class:"flex-1 space-y-4"},Kd=["onMouseup","onTouchend","onMouseenter"],ev={class:"idiom-content"},tv={class:"font-semibold text-gray-800"},sv={key:0,class:"text-sm text-gray-500 italic mt-1"},av={class:"text-green-800"},nv={class:"mt-6 flex items-center gap-4"},ov={class:"flex-1 h-3 bg-gray-200 rounded-full overflow-hidden"},rv={class:"text-sm font-bold text-gray-600"},lv={class:"flex justify-start gap-3 mt-4"},iv={__name:"LanguageIdiomBridge",props:{step:{type:Object,required:!0}},emits:["complete"],setup(s,{emit:t}){const n=s,a=t,g=f(null),o=f(null),v=f({}),c=f({}),l=f([]),_=f([]),w=f([]),P=f(null),k=f(null),b=f(null),C=f(""),x=f([]),m=(Q,H)=>{H&&(v.value[Q]=H)},T=(Q,H)=>{H&&(c.value[Q]=H)},L=O(()=>_.value.filter(Q=>Q.correct)),E=O(()=>L.value.length===n.step.sourceIdioms.length),M=O(()=>C.value?C.value.includes("âœ“")||C.value.includes("ðŸŽ‰")?"success":"error":""),$=Q=>_.value.some(H=>H.sourceIdx===Q),W=Q=>_.value.some(H=>H.targetIdx===Q),N=Q=>_.value.some(H=>H.sourceIdx===Q&&H.correct),ie=Q=>_.value.some(H=>H.sourceIdx===Q&&!H.correct),S=Q=>_.value.some(H=>H.targetIdx===Q&&H.correct),R=Q=>_.value.some(H=>H.targetIdx===Q&&!H.correct);ke(()=>n.step,()=>{let Q=[...n.step.targetIdioms],H=0;do{Q.sort(()=>Math.random()-.5),H++;const q=Q.filter((te,U)=>n.step.sourceIdioms[U]&&te.matchId===n.step.sourceIdioms[U].matchId).length;if(Q.length<4){if(q<Q.length||H>5)break}else if(q<=Math.max(1,Q.length*.3)||H>10)break}while(!0);l.value=Q,_.value=[],w.value=[],x.value=[],C.value="",P.value=null,k.value=null},{immediate:!0});const ee=(Q,H,q)=>{if($(Q)){const te=_.value.findIndex(U=>U.sourceIdx===Q);te!==-1&&(_.value.splice(te,1),w.value.splice(te,1))}P.value=Q,C.value="",se(q)},se=Q=>{if(P.value===null)return;const H=v.value[P.value];if(!H||!o.value)return;const q=o.value.getBoundingClientRect(),te=H.getBoundingClientRect(),U=te.right-q.left,fe=te.top+te.height/2-q.top;let me,ae;Q.touches?(me=Q.touches[0].clientX-q.left,ae=Q.touches[0].clientY-q.top):(me=Q.clientX-q.left,ae=Q.clientY-q.top);const p=U+(me-U)/2;k.value=`M ${U} ${fe} C ${p} ${fe}, ${p} ${ae}, ${me} ${ae}`},ce=Q=>{if(P.value===null)return;const H=P.value,q=n.step.sourceIdioms[H],te=l.value[Q];if(W(Q)){P.value=null,k.value=null,C.value="âš ï¸ This idiom is already connected!";return}const U=q.matchId===te.matchId,fe=v.value[H],me=c.value[Q],ae=o.value.getBoundingClientRect(),p=fe.getBoundingClientRect(),D=me.getBoundingClientRect(),F=p.right-ae.left,oe=p.top+p.height/2-ae.top,A=D.left-ae.left,z=D.top+D.height/2-ae.top,Z=F+(A-F)/2,pe=`M ${F} ${oe} C ${Z} ${oe}, ${Z} ${z}, ${A} ${z}`;_.value.push({sourceIdx:H,targetIdx:Q,correct:U}),w.value.push({path:pe,correct:U,animate:!0}),U?(C.value="âœ“ Perfect match!",x.value.push({id:q.matchId,meaning:q.meaning||te.meaning||"These idioms share the same meaning!"}),L.value.length===n.step.sourceIdioms.length&&(C.value="ðŸŽ‰ All idioms matched! You've built the complete bridge!",a("complete",!0))):C.value="âœ— These idioms have different meanings. Try again!",P.value=null,k.value=null},ge=()=>{_.value=[],w.value=[],x.value=[],C.value="",P.value=null,k.value=null},_e=Q=>{P.value!==null&&se(Q)},Y=()=>{P.value!==null&&(P.value=null,k.value=null)};nt(()=>{document.addEventListener("mousemove",_e),document.addEventListener("mouseup",Y),document.addEventListener("touchmove",_e),document.addEventListener("touchend",Y)}),mt(()=>{document.removeEventListener("mousemove",_e),document.removeEventListener("mouseup",Y),document.removeEventListener("touchmove",_e),document.removeEventListener("touchend",Y)});const V=Q=>({English:"ðŸ‡¬ðŸ‡§",Spanish:"ðŸ‡ªðŸ‡¸",French:"ðŸ‡«ðŸ‡·",German:"ðŸ‡©ðŸ‡ª",Italian:"ðŸ‡®ðŸ‡¹",Russian:"ðŸ‡·ðŸ‡º",Chinese:"ðŸ‡¨ðŸ‡³",Japanese:"ðŸ‡¯ðŸ‡µ",Korean:"ðŸ‡°ðŸ‡·",Portuguese:"ðŸ‡µðŸ‡¹",Arabic:"ðŸ‡¸ðŸ‡¦"})[Q]||"ðŸŒ";return(Q,H)=>(r(),i("div",Pd,[e("div",Wd,[H[2]||(H[2]=e("div",{class:"inline-flex items-center gap-3 px-5 py-2 rounded-full bg-gradient-to-r from-amber-100 to-orange-100 border border-amber-200 mb-4"},[e("span",{class:"text-2xl"},"ðŸŒ‰"),e("span",{class:"font-bold text-amber-700"},"Idiom Bridge")],-1)),e("p",jd,d(s.step.prompt||"Connect idioms with the same meaning across languages"),1)]),e("div",zd,[e("div",qd,[e("span",Rd,d(V(s.step.sourceLanguage)),1),e("span",Vd,d(s.step.sourceLanguage||"English"),1)]),e("div",Fd,[e("span",Bd,d(s.step.targetLanguage||"Spanish"),1),e("span",Nd,d(V(s.step.targetLanguage)),1)])]),e("div",{class:"relative bridge-container",ref_key:"bridgeContainer",ref:g},[(r(),i("svg",{class:"absolute inset-0 w-full h-full pointer-events-none z-10",ref_key:"svgCanvas",ref:o},[(r(!0),i(de,null,ve(w.value,(q,te)=>(r(),i("path",{key:`conn-${te}`,d:q.path,stroke:q.correct?"#10b981":"#ef4444","stroke-width":"3",fill:"none",class:J(["connection-line",{"animate-draw":q.animate}])},null,10,Od))),128)),k.value?(r(),i("path",{key:0,d:k.value,stroke:"#8b5cf6","stroke-width":"3","stroke-dasharray":"8 4",fill:"none",class:"active-connection"},null,8,Hd)):B("",!0)],512)),e("div",Ud,[e("div",Gd,[(r(!0),i(de,null,ve(s.step.sourceIdioms,(q,te)=>(r(),i("div",{key:`source-${te}`,ref_for:!0,ref:U=>m(te,U),onMousedown:U=>ee(te,"source",U),onTouchstart:qe(U=>ee(te,"source",U),["prevent"]),class:J(["idiom-card source-card",{connected:$(te),correct:N(te),incorrect:ie(te),active:P.value===te}])},[e("div",Yd,[e("p",Jd,d(q.text),1),q.literal?(r(),i("p",Zd," (Literally: "+d(q.literal)+") ",1)):B("",!0)]),e("div",{class:J(["connection-dot right-dot",{"dot-active":P.value===te}])},null,2)],42,Qd))),128))]),H[3]||(H[3]=et('<div class="flex flex-col items-center justify-center px-4" data-v-e0711625><div class="bridge-pillar" data-v-e0711625></div><div class="bridge-deck" data-v-e0711625><div class="bridge-cable left-cable" data-v-e0711625></div><div class="bridge-cable right-cable" data-v-e0711625></div></div><div class="bridge-pillar" data-v-e0711625></div></div>',1)),e("div",Xd,[(r(!0),i(de,null,ve(l.value,(q,te)=>(r(),i("div",{key:`target-${te}`,ref_for:!0,ref:U=>T(te,U),onMouseup:U=>ce(te),onTouchend:U=>ce(te),class:J(["idiom-card target-card",{connected:W(te),correct:S(te),incorrect:R(te),hovering:b.value===te}]),onMouseenter:U=>b.value=P.value!==null?te:null,onMouseleave:H[0]||(H[0]=U=>b.value=null)},[e("div",{class:J(["connection-dot left-dot",{"dot-active":b.value===te}])},null,2),e("div",ev,[e("p",tv,d(q.text),1),q.literal?(r(),i("p",sv," (Literally: "+d(q.literal)+") ",1)):B("",!0)])],42,Kd))),128))])])],512),Me(js,{name:"meaning-reveal",tag:"div",class:"mt-6 space-y-2"},{default:Pe(()=>[(r(!0),i(de,null,ve(x.value,q=>(r(),i("div",{key:q.id,class:"p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-200"},[e("p",av,[H[4]||(H[4]=e("span",{class:"font-bold"},"Shared meaning:",-1)),Se(" "+d(q.meaning),1)])]))),128))]),_:1}),e("div",nv,[e("div",ov,[e("div",{class:"h-full bg-gradient-to-r from-amber-400 to-orange-500 rounded-full transition-all duration-500",style:xe({width:`${L.value.length/s.step.sourceIdioms.length*100}%`})},null,4)]),e("span",rv,d(L.value.length)+" / "+d(s.step.sourceIdioms.length),1)]),e("div",{class:J(["step-feedback mt-4",M.value])},d(C.value),3),e("div",lv,[E.value?B("",!0):(r(),i("button",{key:0,onClick:ge,class:"px-6 py-3 rounded-full font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 transition-colors"}," Reset All ")),E.value?(r(),i("button",{key:1,onClick:H[1]||(H[1]=q=>Q.$emit("complete",!0)),class:"px-8 py-3 rounded-full font-bold text-white bg-gradient-to-r from-green-500 to-emerald-600 shadow-md hover:shadow-lg transition-all"}," Continue â†’ ")):B("",!0)])]))}},cv=Ie(iv,[["__scopeId","data-v-e0711625"]]),uv={class:"interactive-step step-animate-in"},dv={class:"text-center mb-6 relative"},vv={key:0,class:"absolute top-12 right-0 w-72 bg-white p-5 rounded-xl shadow-xl border border-indigo-100 z-50 text-left"},gv={class:"text-lg text-gray-600 leading-relaxed max-w-xl mx-auto"},mv={class:"text-center mb-4"},fv={class:"inline-block px-6 py-3 rounded-2xl bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold text-xl shadow-lg"},pv={class:"absolute inset-0 w-full h-full pointer-events-none"},hv=["cx","cy","r","opacity"],bv=["x1","y1","x2","y2"],yv=["x1","y1","x2","y2"],xv=["onMousedown","onTouchstart","onMouseenter"],wv={class:"word-content"},kv={class:"word-text"},_v={key:0,class:"word-type"},Cv={key:0,class:"connection-badge"},$v={class:"star-core"},Sv={key:0,class:"mt-6 flex flex-wrap justify-center gap-3"},Iv={class:"font-medium"},Av={class:"mt-6"},Tv={class:"flex items-center gap-4 mb-4"},Mv={class:"flex-1 h-3 bg-gray-200 rounded-full overflow-hidden"},Lv={class:"text-sm font-bold text-gray-600"},Ev={class:"flex justify-start gap-3 mt-4"},Dv={__name:"LanguageWordConstellation",props:{step:{type:Object,required:!0}},emits:["complete"],setup(s,{emit:t}){const n=s,a=t,g=f(null),o=gt({}),v=f([]),c=f(!1),l=f(null),_=f(null),w=f(null),P=f(null),k=f(""),b=f(!0),C=f(!1),x=f([]),m=()=>{const H=[];for(let q=0;q<50;q++)H.push({id:q,x:Math.random()*100+"%",y:Math.random()*100+"%",r:Math.random()*1.5+.5,opacity:Math.random()*.5+.3,delay:Math.random()*3});x.value=H},T=[{type:"synonym",label:"Synonym",icon:"â‰ˆ",class:"bg-blue-100 text-blue-700"},{type:"antonym",label:"Antonym",icon:"â†”",class:"bg-red-100 text-red-700"},{type:"related",label:"Related",icon:"â†’",class:"bg-green-100 text-green-700"},{type:"category",label:"Category",icon:"âŠ‚",class:"bg-purple-100 text-purple-700"}],L=O(()=>typeof n.step.centralWord=="object"&&n.step.centralWord!==null?n.step.centralWord.text||"Center":n.step.centralWord),E=O(()=>v.value.filter(H=>(n.step.requiredConnections||[]).some(te=>te.from===H.from&&te.to===H.to||te.from===H.to&&te.to===H.from))),M=O(()=>{var q;const H=((q=n.step.requiredConnections)==null?void 0:q.length)||n.step.words.length;return E.value.length/H*100}),$=O(()=>{var q;const H=((q=n.step.requiredConnections)==null?void 0:q.length)||n.step.words.length;return E.value.length>=H}),W=O(()=>k.value?k.value.includes("âœ“")||k.value.includes("ðŸŒŸ")?"success":"error":"");ke(()=>n.step,()=>{v.value=[],k.value="",c.value=!1,m()},{immediate:!0}),nt(()=>{m()});const N=(H,q)=>{const te=n.step.words.length,U=q/te*2*Math.PI-Math.PI/2,fe=38,me=50+fe*Math.cos(U),ae=50+fe*Math.sin(U);return{left:`${me}%`,top:`${ae}%`,transform:"translate(-50%, -50%)"}},ie=()=>({left:"50%",top:"50%",transform:"translate(-50%, -50%)"}),S=H=>{if(!g.value)return{x:0,y:0};const q=o[H];if(!q)return{x:g.value.offsetWidth/2,y:g.value.offsetHeight/2};const te=g.value.getBoundingClientRect(),U=q.getBoundingClientRect();return{x:U.left+U.width/2-te.left,y:U.top+U.height/2-te.top}},R=H=>v.value.some(q=>q.from===H||q.to===H),ee=H=>v.value.filter(q=>q.from===H||q.to===H).length,se=(H,q)=>v.value.some(te=>te.from===H&&te.to===q||te.from===q&&te.to===H),ce=(H,q)=>{c.value=!0,l.value=H.id,_.value=S(H.id);const te=g.value.getBoundingClientRect();q.touches?w.value={x:q.touches[0].clientX-te.left,y:q.touches[0].clientY-te.top}:w.value={x:q.clientX-te.left,y:q.clientY-te.top}},ge=H=>{if(!c.value||!g.value)return;const q=g.value.getBoundingClientRect();w.value={x:H.clientX-q.left,y:H.clientY-q.top}},_e=H=>{if(!c.value||!g.value)return;const q=g.value.getBoundingClientRect();w.value={x:H.touches[0].clientX-q.left,y:H.touches[0].clientY-q.top}},Y=()=>{c.value&&(P.value&&P.value!==l.value&&V(l.value,P.value),c.value=!1,l.value=null,_.value=null,w.value=null)},V=(H,q)=>{if(se(H,q)){k.value="âš ï¸ These words are already connected!";return}if((n.step.requiredConnections||[]).some(fe=>fe.from===H&&fe.to===q||fe.from===q&&fe.to===H))v.value.push({from:H,to:q}),k.value="âœ“ Connection discovered!",$.value&&(k.value="ðŸŒŸ Constellation complete! You found all the word relationships!",a("complete",!0));else{k.value="âœ— These words don't have a direct relationship. Try another pair!";const fe=o[H],me=o[q];fe&&fe.classList.add("shake"),me&&me.classList.add("shake"),setTimeout(()=>{fe&&fe.classList.remove("shake"),me&&me.classList.remove("shake")},500)}},Q=()=>{v.value=[],k.value=""};return(H,q)=>{var te;return r(),i("div",uv,[e("div",dv,[q[6]||(q[6]=e("div",{class:"inline-flex items-center gap-3 px-5 py-2 rounded-full bg-gradient-to-r from-indigo-100 to-purple-100 border border-indigo-200 mb-4"},[e("span",{class:"text-2xl"},"âœ¨"),e("span",{class:"font-bold text-indigo-700"},"Word Constellation")],-1)),e("button",{onClick:q[0]||(q[0]=U=>C.value=!C.value),class:"absolute right-0 top-0 p-2 text-indigo-400 hover:text-indigo-600 transition-colors",title:"How to play"},q[4]||(q[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])),C.value?(r(),i("div",vv,[q[5]||(q[5]=et('<h4 class="font-bold text-indigo-700 mb-2 flex items-center gap-2" data-v-626106ed><span data-v-626106ed>ðŸŽ®</span> How to Play </h4><ul class="space-y-2 text-sm text-gray-600" data-v-626106ed><li class="flex gap-2" data-v-626106ed><span class="text-indigo-500 font-bold" data-v-626106ed>1.</span><span data-v-626106ed>Look for words related to the <strong data-v-626106ed>Central Word</strong>.</span></li><li class="flex gap-2" data-v-626106ed><span class="text-indigo-500 font-bold" data-v-626106ed>2.</span><span data-v-626106ed><strong data-v-626106ed>Drag</strong> from one word to another to connect them.</span></li><li class="flex gap-2" data-v-626106ed><span class="text-indigo-500 font-bold" data-v-626106ed>3.</span><span data-v-626106ed>Find all connections to reveal the full constellation!</span></li></ul>',2)),e("button",{onClick:q[1]||(q[1]=U=>C.value=!1),class:"mt-3 w-full py-1 bg-indigo-50 text-indigo-600 rounded-lg text-xs font-bold hover:bg-indigo-100"},"Got it!")])):B("",!0),e("p",gv,d(s.step.prompt||"Drag to connect words that are synonyms, antonyms, or related to the central concept."),1)]),e("div",mv,[e("span",fv,d(L.value),1)]),e("div",{class:"constellation-canvas",ref_key:"canvas",ref:g,onMousemove:ge,onMouseup:Y,onTouchmove:_e,onTouchend:Y},[(r(),i("svg",pv,[(r(!0),i(de,null,ve(x.value,U=>(r(),i("circle",{key:U.id,cx:U.x,cy:U.y,r:U.r,fill:"white",opacity:U.opacity,class:"twinkle",style:xe({animationDelay:U.delay+"s"})},null,12,hv))),128)),(r(!0),i(de,null,ve(E.value,U=>(r(),i("line",{key:`line-${U.from}-${U.to}`,x1:S(U.from).x,y1:S(U.from).y,x2:S(U.to).x,y2:S(U.to).y,stroke:"url(#connectionGradient)","stroke-width":"3","stroke-linecap":"round",class:"constellation-line"},null,8,bv))),128)),c.value&&_.value&&w.value?(r(),i("line",{key:0,x1:_.value.x,y1:_.value.y,x2:w.value.x,y2:w.value.y,stroke:"#a5b4fc","stroke-width":"2","stroke-dasharray":"6 4","stroke-linecap":"round"},null,8,yv)):B("",!0),q[7]||(q[7]=e("defs",null,[e("linearGradient",{id:"connectionGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%"},[e("stop",{offset:"0%","stop-color":"#818cf8"}),e("stop",{offset:"50%","stop-color":"#c084fc"}),e("stop",{offset:"100%","stop-color":"#818cf8"})])],-1))])),(r(!0),i(de,null,ve(s.step.words,(U,fe)=>(r(),i("div",{key:U.id,ref_for:!0,ref:me=>o[U.id]=me,class:J(["word-node",{connected:R(U.id),dragging:l.value===U.id,hovering:P.value===U.id&&c.value&&l.value!==U.id,central:U.id==="center"}]),style:xe(N(U,fe)),onMousedown:me=>ce(U,me),onTouchstart:qe(me=>ce(U,me),["prevent"]),onMouseenter:me=>P.value=U.id,onMouseleave:q[2]||(q[2]=me=>P.value=null)},[q[8]||(q[8]=e("div",{class:"word-glow"},null,-1)),e("div",wv,[e("span",kv,d(U.text),1),U.type&&b.value?(r(),i("span",_v,d(U.type),1)):B("",!0)]),ee(U.id)>0?(r(),i("div",Cv,d(ee(U.id)),1)):B("",!0)],46,xv))),128)),e("div",{class:"central-star",style:xe(ie())},[q[9]||(q[9]=e("div",{class:"star-rays"},null,-1)),e("div",$v,[e("span",null,d(L.value),1)])],4)],544),s.step.showLegend!==!1?(r(),i("div",Sv,[(r(),i(de,null,ve(T,U=>e("div",{key:U.type,class:J(["flex items-center gap-2 px-3 py-1.5 rounded-full text-sm",U.class])},[e("span",null,d(U.icon),1),e("span",Iv,d(U.label),1)],2)),64))])):B("",!0),e("div",Av,[e("div",Tv,[e("div",Mv,[e("div",{class:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full transition-all duration-500",style:xe({width:`${M.value}%`})},null,4)]),e("span",Lv,d(E.value.length)+" / "+d(((te=s.step.requiredConnections)==null?void 0:te.length)||s.step.words.length),1)]),e("div",{class:J(["step-feedback",W.value])},d(k.value),3)]),e("div",Ev,[E.value.length>0&&!$.value?(r(),i("button",{key:0,onClick:Q,class:"px-6 py-3 rounded-full font-medium text-gray-600 bg-gray-100 hover:bg-gray-200 transition-colors"}," Reset ")):B("",!0),$.value?(r(),i("button",{key:1,onClick:q[3]||(q[3]=U=>H.$emit("complete",!0)),class:"px-8 py-3 rounded-full font-bold text-white bg-gradient-to-r from-indigo-600 to-purple-600 shadow-md hover:shadow-lg transition-all"}," Constellation Complete! â†’ ")):B("",!0)])])}}},Pv=Ie(Dv,[["__scopeId","data-v-626106ed"]]),Wv={class:"interactive-step step-animate-in"},jv={class:"text-center mb-6"},zv={class:"text-lg text-gray-600 leading-relaxed max-w-xl mx-auto"},qv={class:"mb-8"},Rv={class:"target-pattern-card"},Vv={class:"waveform-container mb-4"},Fv={class:"flex justify-center gap-2 mb-3"},Bv={class:"text-lg text-gray-800 font-medium text-center"},Nv={class:"text-sm text-gray-500 text-center mt-2"},Ov={class:"space-y-4 mb-6"},Hv=["onClick"],Uv={class:"mini-waveform"},Gv={class:"flex-1"},Qv={class:"text-gray-800 font-medium"},Yv={key:0,class:"text-sm text-green-600 mt-1"},Jv=["onClick"],Zv={key:0,class:"selection-indicator"},Xv={key:0,class:"mb-6 p-4 bg-blue-50 rounded-xl border border-blue-200"},Kv={class:"flex items-start gap-3"},eg={class:"text-blue-700 text-sm"},tg={class:"flex justify-start gap-3 mt-4"},sg=["disabled"],ag={__name:"LanguageRhythmMatch",props:{step:{type:Object,required:!0}},emits:["complete"],setup(s,{emit:t}){const n=s,a=t;let g=null;const o=f(null),v=f(!1),c=f(""),l=f(!1),_=O(()=>c.value?l.value?"success":"error":"");ke(()=>n.step,()=>{o.value=null,v.value=!1,c.value="",l.value=!1},{immediate:!0});const w=x=>{console.log("Selected option:",x),!v.value&&(o.value=x,c.value="")},P=x=>parseInt(n.step.correctIndex)===x,k=()=>{if(console.log("Check Answer clicked"),console.log("Selected Option:",o.value),console.log("Correct Index:",n.step.correctIndex),o.value===null){console.log("No option selected");return}v.value=!0;const x=parseInt(n.step.correctIndex),m=parseInt(o.value);console.log("Parsed Correct Index:",x),console.log("Parsed Selected Index:",m),l.value=!isNaN(x)&&m===x,console.log("Is Correct:",l.value),l.value?(c.value="ðŸŽµ Perfect! You matched the rhythm correctly!",a("complete",!0)):(c.value="âŒ Not quite. Listen to the patterns again - the stress falls on different syllables.",a("complete",!1))},b=x=>{const m=x.join(""),T={"01":"Iambic (da-DUM)",10:"Trochaic (DUM-da)","001":"Anapestic (da-da-DUM)",100:"Dactylic (DUM-da-da)","0101":"Iambic dimeter",1010:"Trochaic dimeter","010101":"Iambic trimeter","01010101":"Iambic tetrameter","0101010101":"Iambic pentameter"};return m.match(/^(01)+$/)?`Iambic (${x.length/2} feet)`:m.match(/^(10)+$/)?`Trochaic (${x.length/2} feet)`:m.match(/^(001)+$/)?`Anapestic (${x.length/3} feet)`:m.match(/^(100)+$/)?`Dactylic (${x.length/3} feet)`:T[m]||"Custom rhythm pattern"},C=async x=>{try{g||(g=new(window.AudioContext||window.webkitAudioContext));const m=300,T=g.currentTime;x.forEach((L,E)=>{const M=g.createOscillator(),$=g.createGain();M.connect($),$.connect(g.destination),L===1?(M.frequency.value=600,$.gain.value=.5):(M.frequency.value=400,$.gain.value=.2),M.type="sine";const W=T+E*m/1e3,N=.15;$.gain.setValueAtTime($.gain.value,W),$.gain.exponentialRampToValueAtTime(.01,W+N),M.start(W),M.stop(W+N)})}catch{console.log("Audio not supported")}};return(x,m)=>(r(),i("div",Wv,[e("div",jv,[m[2]||(m[2]=e("div",{class:"inline-flex items-center gap-3 px-5 py-2 rounded-full bg-gradient-to-r from-cyan-100 to-teal-100 border border-cyan-200 mb-4"},[e("span",{class:"text-2xl"},"ðŸŽµ"),e("span",{class:"font-bold text-cyan-700"},"Rhythm Match")],-1)),e("p",zv,d(s.step.prompt||"Match sentences with the same stress pattern (rhythm)"),1)]),m[10]||(m[10]=et('<div class="flex justify-center gap-6 mb-6" data-v-b7477a30><div class="flex items-center gap-2" data-v-b7477a30><div class="w-4 h-8 rounded bg-cyan-500" data-v-b7477a30></div><span class="text-sm text-gray-600" data-v-b7477a30>Stressed syllable</span></div><div class="flex items-center gap-2" data-v-b7477a30><div class="w-4 h-4 rounded bg-cyan-300" data-v-b7477a30></div><span class="text-sm text-gray-600" data-v-b7477a30>Unstressed syllable</span></div></div>',1)),e("div",qv,[m[4]||(m[4]=e("div",{class:"text-center mb-3"},[e("span",{class:"text-sm font-bold text-gray-500 uppercase tracking-wider"},"Target Rhythm Pattern")],-1)),e("div",Rv,[e("div",Vv,[(r(!0),i(de,null,ve(s.step.targetPattern,(T,L)=>(r(),i("div",{key:L,class:J(["waveform-bar",T===1?"stressed":"unstressed"]),style:xe({animationDelay:L*.1+"s"})},null,6))),128))]),e("div",Fv,[(r(!0),i(de,null,ve(s.step.targetPattern,(T,L)=>(r(),i("span",{key:`notation-${L}`,class:"text-2xl"},d(T===1?"â—":"â—‹"),1))),128))]),e("p",Bv,' "'+d(s.step.targetSentence)+'" ',1),e("p",Nv,d(b(s.step.targetPattern)),1),e("button",{onClick:m[0]||(m[0]=T=>C(s.step.targetPattern)),class:"mt-4 mx-auto flex items-center gap-2 px-4 py-2 rounded-full bg-cyan-100 hover:bg-cyan-200 text-cyan-700 font-medium transition-colors"},m[3]||(m[3]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),Se(" Hear Rhythm ")]))])]),e("div",Ov,[m[7]||(m[7]=e("p",{class:"text-center text-gray-600 font-medium"},"Which sentence has the same rhythm?",-1)),(r(!0),i(de,null,ve(s.step.options,(T,L)=>(r(),i("div",{key:L,onClick:E=>w(L),class:J(["option-card",{selected:o.value===L,correct:v.value&&P(L),incorrect:v.value&&o.value===L&&!P(L)}])},[e("div",Uv,[(r(!0),i(de,null,ve(T.pattern,(E,M)=>(r(),i("div",{key:M,class:J(["mini-bar",E===1?"stressed":"unstressed"])},null,2))),128))]),e("div",Gv,[e("p",Qv,d(T.sentence),1),v.value&&P(L)?(r(),i("p",Yv," Pattern: "+d(T.pattern.map(E=>E===1?"â—":"â—‹").join(" ")),1)):B("",!0)]),e("button",{onClick:qe(E=>C(T.pattern),["stop"]),class:"flex-shrink-0 w-10 h-10 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center transition-colors"},m[5]||(m[5]=[e("svg",{class:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"})],-1)]),8,Jv),o.value===L?(r(),i("div",Zv,m[6]||(m[6]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)]))):B("",!0)],10,Hv))),128))]),Me(Re,{name:"slide-fade"},{default:Pe(()=>[v.value&&s.step.explanation?(r(),i("div",Xv,[e("div",Kv,[m[9]||(m[9]=e("span",{class:"text-xl"},"ðŸ’¡",-1)),e("div",null,[m[8]||(m[8]=e("p",{class:"font-semibold text-blue-800 mb-1"},"Understanding Rhythm",-1)),e("p",eg,d(s.step.explanation),1)])])])):B("",!0)]),_:1}),e("div",{class:J(["step-feedback",_.value])},d(c.value),3),e("div",tg,[v.value?(r(),i("button",{key:1,onClick:m[1]||(m[1]=T=>x.$emit("complete",l.value)),class:J(["px-8 py-3 rounded-full font-bold text-white shadow-md transition-all",l.value?"bg-gradient-to-r from-green-500 to-emerald-600":"bg-gradient-to-r from-cyan-600 to-teal-600"])},d(l.value?"Continue â†’":"Try Another â†’"),3)):(r(),i("button",{key:0,onClick:k,disabled:o.value===null,class:J(["px-8 py-3 rounded-full font-bold text-white shadow-md transition-all active:scale-95",o.value!==null?"bg-gradient-to-r from-cyan-600 to-teal-600 hover:from-cyan-700 hover:to-teal-700":"bg-gray-300 cursor-not-allowed"])}," Check Rhythm ",10,sg))])]))}},ng=Ie(ag,[["__scopeId","data-v-b7477a30"]]),og={class:"interactive-step step-animate-in"},rg={class:"text-center mb-6"},lg={class:"text-lg text-gray-600 leading-relaxed max-w-xl mx-auto"},ig={class:"flex items-center justify-center gap-4 mb-6"},cg={class:"text-2xl"},ug={class:"font-bold text-gray-700"},dg={class:"font-bold text-gray-700"},vg={class:"text-2xl"},gg={class:"case-file mb-8"},mg={class:"case-header"},fg={class:"case-number"},pg={class:"word-comparison"},hg={class:"language-badge"},bg={class:"word-display"},yg={class:"word-text"},xg={key:0,class:"word-meaning"},wg={key:0,class:"word-mystery"},kg={class:"comparison-center"},_g={key:0},Cg={key:1},$g={key:2},Sg={key:0,class:"comparison-label"},Ig={class:"language-badge"},Ag={class:"word-display"},Tg={class:"word-text"},Mg={key:0,class:"word-meaning"},Lg={key:0,class:"word-mystery"},Eg={key:0,class:"guess-buttons"},Dg={key:0,class:"explanation-box"},Pg={class:"explanation-text"},Wg={key:0,class:"examples-grid"},jg={key:0,class:"example-item"},zg={class:"example-lang"},qg={class:"example-text"},Rg={key:1,class:"example-item"},Vg={class:"example-lang"},Fg={class:"example-text"},Bg={class:"progress-tracker mb-6"},Ng={class:"progress-dots"},Og={key:0},Hg={key:1},Ug={key:2},Gg={class:"progress-score"},Qg={class:"score-correct"},Yg={class:"score-total"},Jg={class:"flex justify-start gap-3 mt-4"},Zg={class:"results-modal"},Xg={class:"results-header"},Kg={class:"text-4xl"},em={class:"results-score"},tm={class:"score-circle"},sm={class:"score-number"},am={class:"score-label"},nm={class:"score-message"},om={class:"results-breakdown"},rm={class:"result-words"},lm={class:"result-type"},im={class:"result-status"},cm={__name:"LanguageFalseFriends",props:{step:{type:Object,required:!0}},emits:["complete"],setup(s,{emit:t}){const n=s,a=f(0),g=f(!1),o=f({}),v=f(""),c=f(!1),l=O(()=>n.step.words[a.value]||{}),_=O(()=>Object.values(o.value).filter(L=>L==="correct").length),w=O(()=>a.value>=n.step.words.length-1&&g.value),P=O(()=>v.value?v.value.includes("âœ“")||v.value.includes("ðŸŽ‰")?"success":"error":"");ke(()=>n.step,()=>{a.value=0,g.value=!1,o.value={},v.value="",c.value=!1},{immediate:!0});const k=L=>{const E=L===l.value.isFalseFriend;g.value=!0,o.value[a.value]=E?"correct":"incorrect",E?v.value=l.value.isFalseFriend?"âœ“ Correct! This is indeed a false friend - the words look similar but mean different things!":"âœ“ Correct! These are true cognates with the same meaning.":v.value=l.value.isFalseFriend?"âœ— Actually, this is a false friend! Despite looking similar, they have different meanings.":"âœ— Actually, these are true cognates - they share the same meaning across both languages."},b=()=>{a.value<n.step.words.length-1?(a.value++,g.value=!1,v.value=""):c.value=!0},C=()=>g.value?o.value[a.value]||"pending":"investigating",x=()=>g.value?o.value[a.value]==="correct"?"Solved!":"Missed!":"Investigating...",m=()=>{const L=_.value/n.step.words.length;return L>=.9?"Master Detective! You have an excellent eye for false friends!":L>=.7?"Great detective work! You caught most of the tricky words.":L>=.5?"Good effort! Keep practicing to spot more false friends.":"These sneaky words fooled you! Study the explanations to learn the differences."},T=L=>({English:"ðŸ‡¬ðŸ‡§",Spanish:"ðŸ‡ªðŸ‡¸",French:"ðŸ‡«ðŸ‡·",German:"ðŸ‡©ðŸ‡ª",Italian:"ðŸ‡®ðŸ‡¹",Russian:"ðŸ‡·ðŸ‡º",Portuguese:"ðŸ‡µðŸ‡¹",Polish:"ðŸ‡µðŸ‡±",Dutch:"ðŸ‡³ðŸ‡±",Swedish:"ðŸ‡¸ðŸ‡ª"})[L]||"ðŸŒ";return(L,E)=>(r(),i("div",og,[e("div",rg,[E[5]||(E[5]=e("div",{class:"inline-flex items-center gap-3 px-5 py-2 rounded-full bg-gradient-to-r from-rose-100 to-orange-100 border border-rose-200 mb-4"},[e("span",{class:"text-2xl"},"ðŸ”"),e("span",{class:"font-bold text-rose-700"},"False Friends Detective")],-1)),e("p",lg,d(s.step.prompt||"Identify words that look similar but have different meanings!"),1)]),e("div",ig,[e("span",cg,d(T(s.step.language1)),1),e("span",ug,d(s.step.language1),1),E[6]||(E[6]=e("span",{class:"text-2xl text-rose-500"},"âš¡",-1)),e("span",dg,d(s.step.language2),1),e("span",vg,d(T(s.step.language2)),1)]),e("div",gg,[e("div",mg,[e("span",fg,"Case #"+d(a.value+1),1),e("span",{class:J(["case-status",C()])},d(x()),3)]),e("div",pg,[e("div",{class:J(["word-card",{revealed:g.value}])},[e("div",hg,d(s.step.language1),1),e("div",bg,[e("span",yg,d(l.value.word1),1),g.value?(r(),i("span",xg,d(l.value.meaning1),1)):B("",!0)]),g.value?B("",!0):(r(),i("div",wg,"?"))],2),e("div",kg,[e("div",{class:J(["comparison-icon",{"false-friend":g.value&&l.value.isFalseFriend}])},[g.value?l.value.isFalseFriend?(r(),i("span",Cg,"âš ï¸")):(r(),i("span",$g,"âœ“")):(r(),i("span",_g,"ðŸ¤”"))],2),g.value?(r(),i("div",Sg,d(l.value.isFalseFriend?"FALSE FRIEND!":"True cognate"),1)):B("",!0)]),e("div",{class:J(["word-card",{revealed:g.value}])},[e("div",Ig,d(s.step.language2),1),e("div",Ag,[e("span",Tg,d(l.value.word2),1),g.value?(r(),i("span",Mg,d(l.value.meaning2),1)):B("",!0)]),g.value?B("",!0):(r(),i("div",Lg,"?"))],2)]),g.value?B("",!0):(r(),i("div",Eg,[e("button",{onClick:E[0]||(E[0]=M=>k(!0)),class:"guess-btn false-friend-btn"},E[7]||(E[7]=[e("span",{class:"text-2xl mb-1"},"âš ï¸",-1),e("span",{class:"font-bold"},"False Friend",-1),e("span",{class:"text-sm opacity-75"},"Different meanings",-1)])),e("button",{onClick:E[1]||(E[1]=M=>k(!1)),class:"guess-btn true-cognate-btn"},E[8]||(E[8]=[e("span",{class:"text-2xl mb-1"},"âœ“",-1),e("span",{class:"font-bold"},"True Cognate",-1),e("span",{class:"text-sm opacity-75"},"Same meaning",-1)]))])),Me(Re,{name:"slide-up"},{default:Pe(()=>[g.value&&l.value.explanation?(r(),i("div",Dg,[E[9]||(E[9]=e("div",{class:"explanation-header"},[e("span",{class:"text-lg"},"ðŸ’¡"),e("span",{class:"font-bold"},"Detective Notes")],-1)),e("p",Pg,d(l.value.explanation),1),l.value.example1||l.value.example2?(r(),i("div",Wg,[l.value.example1?(r(),i("div",jg,[e("span",zg,d(s.step.language1)+":",1),e("span",qg,'"'+d(l.value.example1)+'"',1)])):B("",!0),l.value.example2?(r(),i("div",Rg,[e("span",Vg,d(s.step.language2)+":",1),e("span",Fg,'"'+d(l.value.example2)+'"',1)])):B("",!0)])):B("",!0)])):B("",!0)]),_:1})]),e("div",Bg,[e("div",Ng,[(r(!0),i(de,null,ve(s.step.words,(M,$)=>(r(),i("div",{key:$,class:J(["progress-dot",{current:$===a.value,correct:o.value[$]==="correct",incorrect:o.value[$]==="incorrect",pending:!o.value[$]&&$!==a.value}])},[o.value[$]==="correct"?(r(),i("span",Og,"âœ“")):o.value[$]==="incorrect"?(r(),i("span",Hg,"âœ—")):(r(),i("span",Ug,d($+1),1))],2))),128))]),e("div",Gg,[e("span",Qg,d(_.value)+" correct",1),E[10]||(E[10]=e("span",{class:"score-divider"},"/",-1)),e("span",Yg,d(s.step.words.length)+" total",1)])]),e("div",{class:J(["step-feedback",P.value])},d(v.value),3),e("div",Jg,[g.value&&!w.value?(r(),i("button",{key:0,onClick:b,class:"px-8 py-3 rounded-full font-bold text-white bg-gradient-to-r from-rose-500 to-orange-500 shadow-md hover:shadow-lg transition-all"}," Next Case â†’ ")):B("",!0),w.value?(r(),i("button",{key:1,onClick:E[2]||(E[2]=M=>c.value=!0),class:"px-8 py-3 rounded-full font-bold text-white bg-gradient-to-r from-green-500 to-emerald-600 shadow-md hover:shadow-lg transition-all"},d(_.value>=s.step.words.length/2?"Case Closed! â†’":"Review Results â†’"),1)):B("",!0)]),Me(Re,{name:"modal"},{default:Pe(()=>[c.value?(r(),i("div",{key:0,class:"results-overlay",onClick:E[4]||(E[4]=qe(M=>c.value=!1,["self"]))},[e("div",Zg,[e("div",Xg,[e("span",Kg,d(_.value>=s.step.words.length/2?"ðŸ†":"ðŸ“š"),1),E[11]||(E[11]=e("h3",null,"Investigation Complete!",-1))]),e("div",em,[e("div",tm,[e("span",sm,d(_.value),1),e("span",am,"/ "+d(s.step.words.length),1)]),e("p",nm,d(m()),1)]),e("div",om,[(r(!0),i(de,null,ve(s.step.words,(M,$)=>(r(),i("div",{key:$,class:J(["result-item",o.value[$]])},[e("span",rm,d(M.word1)+" â†” "+d(M.word2),1),e("span",lm,d(M.isFalseFriend?"âš ï¸ False Friend":"âœ“ Cognate"),1),e("span",im,d(o.value[$]==="correct"?"âœ“":"âœ—"),1)],2))),128))]),e("button",{onClick:E[3]||(E[3]=M=>L.$emit("complete",_.value>=s.step.words.length/2)),class:"results-close-btn"}," Continue ")])])):B("",!0)]),_:1})]))}},um=Ie(cm,[["__scopeId","data-v-8ce386f3"]]),dm={key:0,class:"game-full-container"},vm={key:1,class:"w-full h-full overflow-y-auto"},gm={class:"bg-white p-4 sm:p-8 min-h-full"},mm={class:"text-center mb-6 sm:mb-8"},fm={class:"flex items-center justify-center gap-2 mt-3"},pm={class:"text-sm sm:text-base font-semibold text-slate-900"},hm={class:"mb-6 sm:mb-8"},bm={class:"bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 shadow-lg rounded-2xl p-4 sm:p-6 text-center"},ym={class:"text-lg sm:text-2xl font-bold text-slate-900 mb-2"},xm={class:"text-sm sm:text-base text-purple-600"},wm={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 sm:gap-6"},km=["onClick","disabled"],_m={class:"flex flex-col items-center justify-center h-full p-2 sm:p-4"},Cm=["src","alt"],$m={class:"text-xs sm:text-sm font-medium text-slate-700"},Sm={key:2,class:"exercise-scroll-container"},Im={class:"exercise-content"},Am={key:0,class:"text-center mb-6 sm:mb-8"},Tm={class:"w-10 h-10 sm:w-12 sm:h-12 mx-auto mb-3 rounded-xl bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold text-sm sm:text-base shadow-lg"},Mm={class:"text-xl sm:text-2xl md:text-3xl font-bold text-slate-900 mb-2"},Lm={key:0,class:"text-slate-500 text-sm sm:text-base max-w-xl mx-auto"},Em={key:1,class:"exercise-card"},Dm={class:"mb-4 sm:mb-6"},Pm={class:"inline-flex items-center px-3 py-1 rounded-full bg-gradient-to-r from-purple-100 to-pink-100 text-purple-700 font-semibold text-xs sm:text-sm"},Wm={class:"text-lg sm:text-xl md:text-2xl font-bold text-slate-900 leading-relaxed mb-6 sm:mb-8"},jm={class:"space-y-2 sm:space-y-3"},zm=["onClick","disabled"],qm={class:"option-text"},Rm={key:0,class:"option-check"},Vm={class:"feedback-icon"},Fm={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Bm={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Nm={class:"font-bold text-sm sm:text-base"},Om={key:0,class:"text-xs sm:text-sm mt-1"},Hm={key:2,class:"exercise-card text-center"},Um={class:"text-lg sm:text-xl md:text-2xl font-bold text-slate-900 leading-relaxed mb-6 sm:mb-8"},Gm={class:"flex justify-center gap-4 sm:gap-6"},Qm=["disabled"],Ym=["disabled"],Jm={class:"feedback-icon"},Zm={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Xm={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Km={class:"font-bold text-sm sm:text-base"},e0={key:0,class:"text-xs sm:text-sm mt-1"},t0={key:4,class:"exercise-card"},s0={class:"mb-4"},a0={class:"inline-flex items-center px-3 py-1 rounded-full bg-slate-100 text-slate-600 font-semibold text-xs sm:text-sm"},n0={key:0,class:"text-lg sm:text-xl font-bold text-slate-900 leading-relaxed mb-4"},o0=["disabled"],r0={class:"feedback-icon"},l0={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i0={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},c0={class:"font-bold"},u0={key:0,class:"text-sm mt-1"},d0={key:5,class:"mt-6 flex justify-end"},v0=["disabled"],g0={key:3,class:"flex-1 flex items-center justify-center"},m0={__name:"InteractivePanel",props:{currentExercise:Object,exerciseIndex:Number,totalExercises:Number,userId:String,lessonId:String,stepIndex:Number},emits:["submit","next-exercise"],setup(s,{emit:t}){const n=s,a=t,{userAnswer:g,answerWasCorrect:o,showCorrectAnswer:v,submitAnswer:c,resetExerciseState:l}=Jt(),_=["histogram","map","block-coding","data_analysis","fraction_visual","geometry_poly","chem_mixing","chem_matching","english_sentence_fix","english_sentence_order","language_noun_bag","geometry","language_tone_transformer","language_idiom_bridge","language_word_constellation","language_rhythm_match","language_false_friends"],w=["multiple-choice","multiple_choice","abc","quiz","dialogue-completion","mcq","choice"],P=["true-false","true_false","boolean","tf"],k=O(()=>{var pe,Ae,We,ot,He;if(!n.currentExercise)return"short-answer";const A=n.currentExercise,z=[A.exerciseType,(pe=A.content)==null?void 0:pe.type,(Ae=A.data)==null?void 0:Ae.type,A.type].filter(Boolean);if(A.type==="exercise"){if((We=A.content)!=null&&We.type)return A.content.type;if((ot=A.data)!=null&&ot.type)return A.data.type}const Z=z.find(rt=>_.includes(rt));return Z||(A.options&&Array.isArray(A.options)&&A.options.length>0||(He=A.content)!=null&&He.options&&Array.isArray(A.content.options)?"multiple-choice":z[0]||A.type||"short-answer")}),b=O(()=>{var Z,pe;const A=(Z=k.value)==null?void 0:Z.toLowerCase();if(_.includes(A))return!1;if(w.some(Ae=>A==null?void 0:A.includes(Ae)))return!0;const z=n.currentExercise;return!!(z!=null&&z.options&&Array.isArray(z.options)&&z.options.length>=2||(pe=z==null?void 0:z.content)!=null&&pe.options&&Array.isArray(z.content.options))}),C=O(()=>P.some(A=>{var z,Z;return(Z=(z=k.value)==null?void 0:z.toLowerCase())==null?void 0:Z.includes(A)})),x=O(()=>_.includes(k.value)),m=O(()=>{if(!n.currentExercise)return{};const A=n.currentExercise;return A.content&&typeof A.content=="object"?A.content:A.data&&typeof A.data=="object"&&!Array.isArray(A.data)?A.data:A}),T=O(()=>{var A,z,Z,pe;return((A=n.currentExercise)==null?void 0:A.title)||((Z=(z=n.currentExercise)==null?void 0:z.content)==null?void 0:Z.title)||((pe=m.value)==null?void 0:pe.title)||"Exercise"}),L=O(()=>{var A,z,Z,pe;return((A=n.currentExercise)==null?void 0:A.instructions)||((z=n.currentExercise)==null?void 0:z.description)||((pe=(Z=n.currentExercise)==null?void 0:Z.content)==null?void 0:pe.description)||""}),E=O(()=>{const A=k.value;return A==="quiz"?"Quiz Question":w.includes(A)?"Multiple Choice":"Question"}),M=O(()=>{var A,z,Z,pe,Ae,We;return((A=n.currentExercise)==null?void 0:A.question)||((Z=(z=n.currentExercise)==null?void 0:z.content)==null?void 0:Z.question)||((Ae=(pe=n.currentExercise)==null?void 0:pe.data)==null?void 0:Ae.question)||((We=n.currentExercise)==null?void 0:We.prompt)||"Select the correct answer"}),$=O(()=>{var z,Z;const A=n.currentExercise;return A!=null&&A.options&&Array.isArray(A.options)?A.options:(z=A==null?void 0:A.content)!=null&&z.options&&Array.isArray(A.content.options)?A.content.options:(Z=A==null?void 0:A.data)!=null&&Z.options&&Array.isArray(A.data.options)?A.data.options:[]}),W=A=>typeof A=="string"?A:typeof A=="number"?String(A):A!=null&&A.text?A.text:A!=null&&A.label?A.label:A!=null&&A.value?A.value:String(A),N=O(()=>{var Z;const A=n.currentExercise;if(typeof(A==null?void 0:A.correctAnswer)=="number")return A.correctAnswer;if(typeof((Z=A==null?void 0:A.content)==null?void 0:Z.correctAnswer)=="number")return A.content.correctAnswer;if(typeof(A==null?void 0:A.correctAnswerIndex)=="number")return A.correctAnswerIndex;if((A==null?void 0:A.correctAnswer)!==void 0){const pe=$.value.findIndex(Ae=>W(Ae)===String(A.correctAnswer)||Ae===A.correctAnswer);if(pe!==-1)return pe}const z=$.value.findIndex(pe=>(pe==null?void 0:pe.isCorrect)===!0);return z!==-1?z:0}),ie=O(()=>b.value||C.value?g.value!==null&&g.value!==void 0:g.value!==null&&g.value!==void 0&&g.value!==""),S=A=>{v.value||(g.value=A)},R=A=>{const z=g.value===A,Z=A===N.value;return v.value?Z?"option-correct":z&&!Z?"option-incorrect":"option-disabled":z?"option-selected":"option-default"},ee=A=>{const z=g.value===A,Z=A===N.value;return v.value?Z?"letter-correct":z&&!Z?"letter-incorrect":"letter-disabled":z?"letter-selected":"letter-default"},se=()=>{c(n.currentExercise),a("submit")},ce=()=>{a("next-exercise")},ge=A=>{A&&(o.value=!0,v.value=!0)},_e=f({side_b:null}),Y=A=>{o.value=A.isCorrect,v.value=!0,A.isCorrect&&setTimeout(()=>a("next-exercise"),1500)},V=O(()=>n.currentExercise?n.currentExercise.type==="game"||!!n.currentExercise.gameType||["basket-catch","whack-a-mole"].includes(n.currentExercise.type):!1),Q=O(()=>V.value?n.currentExercise.gameType||n.currentExercise.type||"basket-catch":null),H=O(()=>V.value?{...n.currentExercise,...n.currentExercise.gameData}:null),q=A=>{o.value=A.completed||A.stars>=2,v.value=!0,setTimeout(()=>a("next-exercise"),1500)},te=()=>{l(),v.value=!1},U=O(()=>{var A,z,Z;return((A=n.currentExercise)==null?void 0:A.type)==="selection_game"||((Z=(z=n.currentExercise)==null?void 0:z.content)==null?void 0:Z.type)==="selection_game"}),fe=O(()=>U.value?m.value||n.currentExercise:{questions:[]}),{score:me,currentQuestion:ae,questions:p,selectedItemId:D,feedback:F,handleSelection:oe}=to(fe);return ke(()=>n.currentExercise,()=>{l(),g.value=null},{immediate:!0}),(A,z)=>(r(),i("div",{class:J(["interactive-panel-wrapper",{"is-game-mode":V.value}])},[V.value?(r(),i("div",dm,[Me(Hr,{"game-data":H.value,"game-type":Q.value,"user-id":s.userId,"lesson-id":s.lessonId,"step-index":s.stepIndex,onGameComplete:q,onGameExit:te},null,8,["game-data","game-type","user-id","lesson-id","step-index"])])):U.value&&be(ae)?(r(),i("div",vm,[e("div",gm,[e("div",mm,[z[9]||(z[9]=e("h1",{class:"text-xl sm:text-2xl font-bold text-slate-900 mb-2"}," Shape Recognition Lesson ",-1)),z[10]||(z[10]=e("p",{class:"text-sm sm:text-base text-purple-600"}," Click on the correct shape! ",-1)),e("div",fm,[z[8]||(z[8]=e("svg",{class:"w-5 h-5 sm:w-6 sm:h-6 text-yellow-500 fill-yellow-500",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})],-1)),e("span",pm," Score: "+d(be(me))+" / "+d(be(p).length),1)])]),e("div",hm,[e("div",bm,[e("h2",ym,d(be(ae).prompt),1),e("p",xm,d(be(ae).hint||"Click on the shape below"),1)])]),e("div",wm,[(r(!0),i(de,null,ve(be(ae).items,(Z,pe)=>(r(),i("button",{key:Z.id,onClick:Ae=>be(oe)(Z),disabled:be(F)!==null,class:J(["relative w-full aspect-square rounded-2xl border-4 transition-all duration-200",[be(D)===Z.id&&be(F)==="correct"?"border-green-500 bg-green-50":be(D)===Z.id&&be(F)==="incorrect"?"border-red-500 bg-red-50":"border-purple-200 bg-white hover:border-purple-400 hover:shadow-lg",be(F)!==null?"cursor-not-allowed":"cursor-pointer"]])},[e("div",_m,[Z.image?(r(),i("img",{key:0,src:Z.image,alt:Z.name,class:"w-16 h-16 sm:w-24 sm:h-24 object-contain mb-2"},null,8,Cm)):B("",!0),e("p",$m,d(Z.name),1)])],10,km))),128))])])])):s.currentExercise?(r(),i("div",Sm,[e("div",Im,[x.value?B("",!0):(r(),i("header",Am,[e("div",Tm,d(s.exerciseIndex+1),1),e("h2",Mm,d(T.value),1),L.value?(r(),i("p",Lm,d(L.value),1)):B("",!0)])),b.value?(r(),i("div",Em,[e("div",Dm,[e("span",Pm,d(E.value),1)]),e("h3",Wm,d(M.value),1),e("div",jm,[(r(!0),i(de,null,ve($.value,(Z,pe)=>(r(),i("button",{key:pe,onClick:Ae=>S(pe),disabled:be(v),class:J(["option-btn",R(pe)])},[e("div",{class:J(["option-letter",ee(pe)])},d(String.fromCharCode(65+pe)),3),e("span",qm,d(W(Z)),1),be(g)===pe?(r(),i("div",Rm,z[11]||(z[11]=[e("svg",{class:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M5 13l4 4L19 7"})],-1)]))):B("",!0)],10,zm))),128))]),Me(Re,{name:"slide-fade"},{default:Pe(()=>[be(v)?(r(),i("div",{key:0,class:J(["feedback-box mt-6",be(o)?"feedback-success":"feedback-error"])},[e("div",Vm,[be(o)?(r(),i("svg",Fm,z[12]||(z[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"},null,-1)]))):(r(),i("svg",Bm,z[13]||(z[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M6 18L18 6M6 6l12 12"},null,-1)])))]),e("div",null,[e("h4",Nm,d(be(o)?"Correct! ðŸŽ‰":"Not quite right"),1),be(o)?B("",!0):(r(),i("p",Om,[z[14]||(z[14]=Se(" The correct answer is: ")),e("strong",null,d(String.fromCharCode(65+N.value)),1)]))])],2)):B("",!0)]),_:1})])):C.value?(r(),i("div",Hm,[z[20]||(z[20]=e("div",{class:"mb-4 sm:mb-6"},[e("span",{class:"inline-flex items-center px-3 py-1 rounded-full bg-gradient-to-r from-cyan-100 to-blue-100 text-cyan-700 font-semibold text-xs sm:text-sm"}," True or False ")],-1)),e("h3",Um,d(M.value),1),e("div",Gm,[e("button",{onClick:z[0]||(z[0]=Z=>g.value=!0),disabled:be(v),class:J(["tf-btn",be(g)===!0?"tf-true-selected":"tf-default"])},z[15]||(z[15]=[e("span",{class:"text-3xl mb-1"},"ðŸ‘",-1),e("span",{class:"text-sm sm:text-base font-bold"},"True",-1)]),10,Qm),e("button",{onClick:z[1]||(z[1]=Z=>g.value=!1),disabled:be(v),class:J(["tf-btn",be(g)===!1?"tf-false-selected":"tf-default"])},z[16]||(z[16]=[e("span",{class:"text-3xl mb-1"},"ðŸ‘Ž",-1),e("span",{class:"text-sm sm:text-base font-bold"},"False",-1)]),10,Ym)]),Me(Re,{name:"slide-fade"},{default:Pe(()=>[be(v)?(r(),i("div",{key:0,class:J(["feedback-box mt-6 mx-auto max-w-sm",be(o)?"feedback-success":"feedback-error"])},[e("div",Jm,[be(o)?(r(),i("svg",Zm,z[17]||(z[17]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"},null,-1)]))):(r(),i("svg",Xm,z[18]||(z[18]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M6 18L18 6M6 6l12 12"},null,-1)])))]),e("div",null,[e("h4",Km,d(be(o)?"Correct! ðŸŽ‰":"Not Quite"),1),be(o)?B("",!0):(r(),i("p",e0,[z[19]||(z[19]=Se(" The statement is actually ")),e("strong",null,d(s.currentExercise.correctAnswer?"True":"False"),1)]))])],2)):B("",!0)]),_:1})])):x.value?(r(),i(de,{key:3},[k.value==="histogram"?(r(),$e(hl,{key:0,title:m.value.title||T.value,description:m.value.description||L.value,data:m.value.data,correctValue:m.value.correctValue,min:m.value.min||0,max:m.value.max||1e5,step:m.value.step||100,onComplete:ge,onNext:z[2]||(z[2]=Z=>a("next-exercise"))},null,8,["title","description","data","correctValue","min","max","step"])):k.value==="map"?(r(),$e(Ol,{key:1,title:m.value.title||T.value,description:m.value.description||L.value,image:m.value.image,markers:m.value.markers,onComplete:ge,onNext:z[3]||(z[3]=Z=>a("next-exercise"))},null,8,["title","description","image","markers"])):k.value==="block-coding"?(r(),$e(mi,{key:2,type:m.value.subtype||m.value.type||"maze",title:m.value.title||T.value,description:m.value.description||L.value,availableBlocks:m.value.availableBlocks,config:m.value.config,onComplete:ge,onNext:z[4]||(z[4]=Z=>a("next-exercise"))},null,8,["type","title","description","availableBlocks","config"])):k.value==="geometry"?(r(),$e(Fi,{key:3,geometryData:m.value,userAnswer:_e.value,"onUpdate:userAnswer":z[5]||(z[5]=Z=>_e.value=Z),onSubmit:Y,onNextExercise:z[6]||(z[6]=Z=>a("next-exercise"))},null,8,["geometryData","userAnswer"])):k.value==="data_analysis"?(r(),$e(cc,{key:4,step:m.value,onComplete:ge},null,8,["step"])):k.value==="fraction_visual"?(r(),$e(wc,{key:5,step:m.value,onComplete:ge},null,8,["step"])):k.value==="geometry_poly"?(r(),$e(jc,{key:6,step:m.value,onComplete:ge},null,8,["step"])):k.value==="chem_mixing"?(r(),$e(lu,{key:7,step:m.value,onComplete:ge},null,8,["step"])):k.value==="chem_matching"?(r(),$e(yu,{key:8,step:m.value,onComplete:ge},null,8,["step"])):k.value==="english_sentence_fix"?(r(),$e(Eu,{key:9,step:m.value,onComplete:ge},null,8,["step"])):k.value==="english_sentence_order"?(r(),$e(Vu,{key:10,step:m.value,onComplete:ge},null,8,["step"])):k.value==="language_noun_bag"?(r(),$e(td,{key:11,step:m.value,onComplete:ge},null,8,["step"])):k.value==="language_tone_transformer"?(r(),$e(Dd,{key:12,step:m.value,onComplete:ge},null,8,["step"])):k.value==="language_idiom_bridge"?(r(),$e(cv,{key:13,step:m.value,onComplete:ge},null,8,["step"])):k.value==="language_word_constellation"?(r(),$e(Pv,{key:14,step:m.value,onComplete:ge},null,8,["step"])):k.value==="language_rhythm_match"?(r(),$e(ng,{key:15,step:m.value,onComplete:ge},null,8,["step"])):k.value==="language_false_friends"?(r(),$e(um,{key:16,step:m.value,onComplete:ge},null,8,["step"])):B("",!0)],64)):(r(),i("div",t0,[e("div",s0,[e("span",a0,d(k.value||"Exercise"),1)]),M.value?(r(),i("h3",n0,d(M.value),1)):B("",!0),Xe(e("textarea",{"onUpdate:modelValue":z[7]||(z[7]=Z=>zs(g)?g.value=Z:null),placeholder:"Type your answer here...",disabled:be(v),class:"w-full p-3 sm:p-4 rounded-xl border-2 border-slate-200 bg-slate-50 focus:bg-white focus:border-purple-500 focus:ring-0 transition-all outline-none resize-none h-32 text-base text-slate-800 placeholder-slate-400"},null,8,o0),[[tt,be(g)]]),Me(Re,{name:"slide-fade"},{default:Pe(()=>[be(v)?(r(),i("div",{key:0,class:J(["feedback-box mt-4",be(o)?"feedback-success":"feedback-error"])},[e("div",r0,[be(o)?(r(),i("svg",l0,z[21]||(z[21]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"},null,-1)]))):(r(),i("svg",i0,z[22]||(z[22]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M6 18L18 6M6 6l12 12"},null,-1)])))]),e("div",null,[e("h4",c0,d(be(o)?"Great job!":"Here's the answer:"),1),be(o)?B("",!0):(r(),i("p",u0,d(s.currentExercise.correctAnswer),1))])],2)):B("",!0)]),_:1})])),x.value?B("",!0):(r(),i("footer",d0,[be(v)?(r(),i("button",{key:1,onClick:ce,class:"btn-success"}," Continue â†’ ")):(r(),i("button",{key:0,onClick:se,disabled:!ie.value,class:"btn-primary"}," Check Answer ",8,v0))]))])])):(r(),i("div",g0,z[23]||(z[23]=[e("div",{class:"text-center"},[e("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-purple-600 mx-auto mb-4"}),e("p",{class:"text-slate-500 text-sm"},"Loading exercise...")],-1)])))],2))}},f0=Ie(m0,[["__scopeId","data-v-d00732f2"]]),p0={name:"AIHelpPanel",props:{aiSuggestions:{type:Array,default:()=>[]},aiChatInput:{type:String,default:""},aiChatHistory:{type:Array,default:()=>[]},aiIsLoading:{type:Boolean,default:!1},aiUsage:{type:Object,default:null}},emits:["send-message","ask-ai","clear-chat"],data(){return{localChatInput:"",showAllMessages:!1}},computed:{recentMessages(){return!this.aiChatHistory||!Array.isArray(this.aiChatHistory)?[]:this.showAllMessages?this.aiChatHistory:this.aiChatHistory.slice(-3)}},watch:{aiChatInput:{handler(s){this.localChatInput=s},immediate:!0}},methods:{sendMessage(){var s;!((s=this.localChatInput)!=null&&s.trim())||this.aiIsLoading||(this.$emit("send-message",this.localChatInput.trim()),this.localChatInput="")},clearChat(){this.$emit("clear-chat")},formatUsage(s){if(!s)return"";const t=s.messages||0,n=s.plan==="free"?50:"âˆž";return`${t}/${n} messages`},formatMessageTime(s){if(!(s!=null&&s.timestamp))return"";try{return new Date(s.timestamp).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}catch{return""}}}},h0={class:"ai-help-panel"},b0={class:"ai-help-header"},y0={key:0,class:"usage-display"},x0={class:"usage-text"},w0={key:0,class:"quick-suggestions"},k0={class:"suggestions-grid"},_0=["onClick","disabled"],C0={class:"ai-chat-input"},$0=["disabled"],S0=["disabled"],I0={key:0,class:"loading-spinner"},A0={key:1},T0={key:1,class:"ai-chat-history"},M0={class:"chat-header"},L0={class:"chat-messages"},E0={class:"message-header"},D0={key:0},P0={key:1},W0={class:"message-time"},j0={class:"message-content"},z0={key:0,class:"show-more-container"},q0={key:2,class:"ai-empty-state"};function R0(s,t,n,a,g,o){var v;return r(),i("div",h0,[e("div",b0,[t[5]||(t[5]=e("h4",null,"ðŸ¤– AI Assistant",-1)),n.aiUsage?(r(),i("div",y0,[e("span",x0,d(o.formatUsage(n.aiUsage)),1)])):B("",!0)]),t[11]||(t[11]=e("p",{class:"ai-help-description"},"Select an answer on the left, and I will help you with explanations!",-1)),(n.aiSuggestions||[]).length?(r(),i("div",w0,[t[6]||(t[6]=e("p",{class:"suggestions-title"},[e("strong",null,"Popular questions:")],-1)),e("div",k0,[(r(!0),i(de,null,ve(n.aiSuggestions||[],(c,l)=>(r(),i("button",{key:`suggestion-${l}`,onClick:_=>s.$emit("ask-ai",c),class:"suggestion-btn",disabled:n.aiIsLoading},d(c),9,_0))),128))])])):B("",!0),e("div",C0,[Xe(e("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>g.localChatInput=c),onKeyup:t[1]||(t[1]=jt((...c)=>o.sendMessage&&o.sendMessage(...c),["enter"])),placeholder:"Ask about this exercise...",disabled:n.aiIsLoading,class:"chat-input-field"},null,40,$0),[[tt,g.localChatInput]]),e("button",{onClick:t[2]||(t[2]=(...c)=>o.sendMessage&&o.sendMessage(...c)),disabled:!((v=g.localChatInput)!=null&&v.trim())||n.aiIsLoading,class:"send-btn"},[n.aiIsLoading?(r(),i("span",I0,"â³")):(r(),i("span",A0,"ðŸ“¤"))],8,S0)]),(n.aiChatHistory||[]).length?(r(),i("div",T0,[e("div",M0,[t[7]||(t[7]=e("h5",null,"ðŸ’¬ Chat history",-1)),e("button",{onClick:t[3]||(t[3]=(...c)=>o.clearChat&&o.clearChat(...c)),class:"clear-chat-btn",title:"Clear history"}," ðŸ—‘ï¸ ")]),e("div",L0,[(r(!0),i(de,null,ve(o.recentMessages,c=>(r(),i("div",{key:(c==null?void 0:c.id)||`ai-msg-${Math.random()}`,class:J(["chat-message",(c==null?void 0:c.type)||"unknown"])},[e("div",E0,[(c==null?void 0:c.type)==="user"?(r(),i("strong",D0,t[8]||(t[8]=[e("span",{class:"user-icon"},"ðŸ‘¤",-1),Se(" You: ")]))):(r(),i("strong",P0,t[9]||(t[9]=[e("span",{class:"ai-icon"},"ðŸ¤–",-1),Se(" AI: ")]))),e("span",W0,d(o.formatMessageTime(c)),1)]),e("div",j0,d((c==null?void 0:c.content)||"No content"),1)],2))),128))]),(n.aiChatHistory||[]).length>3?(r(),i("div",z0,[e("button",{onClick:t[4]||(t[4]=c=>g.showAllMessages=!g.showAllMessages),class:"show-more-btn"},d(g.showAllMessages?"Show less":`Show all (${(n.aiChatHistory||[]).length})`),1)])):B("",!0)])):(r(),i("div",q0,t[10]||(t[10]=[e("div",{class:"empty-icon"},"ðŸ¤”",-1),e("p",null,"Ask a question, and I will help you understand the exercise!",-1)])))])}const V0=Ie(p0,[["render",R0],["__scopeId","data-v-f45a66e5"]]),F0={name:"CompletionScreen",props:{lesson:{type:Object,required:!0},readableTime:{type:String,required:!0},stars:{type:Number,required:!0},mistakeCount:{type:Number,required:!0},earnedPoints:{type:Number,required:!0},medalLabel:{type:String,required:!0},medalIcon:{type:String,required:!0},progressInsight:{type:String,default:""},totalSteps:{type:Number,default:1}},emits:["return-to-catalogue","share","homework"],computed:{medalBgClass(){return this.mistakeCount===0?"bg-amber-100":this.mistakeCount<=2?"bg-slate-100":"bg-orange-100"},accuracyPercentage(){if(this.totalSteps===0)return 100;const s=this.totalSteps-this.mistakeCount;return Math.max(0,Math.round(s/this.totalSteps*100))}}},B0={class:"fixed inset-0 z-1000 bg-white flex flex-col"},N0={class:"flex-1 flex flex-col items-center justify-center px-6 py-10 overflow-y-auto"},O0={class:"w-full max-w-md text-center flex flex-col gap-8"},H0={class:"flex flex-col gap-4"},U0={class:"text-2xl sm:text-3xl font-bold text-slate-900 mt-2"},G0={class:"flex justify-center gap-10 py-4"},Q0={class:"text-center"},Y0={class:"text-3xl font-bold text-slate-900"},J0={class:"text-center"},Z0={class:"text-3xl font-bold text-slate-900"},X0={class:"text-center"},K0={class:"text-3xl font-bold text-slate-900"},ef={class:"bg-slate-50 rounded-2xl p-5"},tf={class:"flex items-center justify-between mb-3"},sf={class:"text-sm font-bold text-slate-900"},af={class:"h-2.5 bg-slate-200 rounded-full overflow-hidden"},nf={key:0,class:"text-sm text-emerald-600 mt-3 font-medium"},of={key:1,class:"text-sm text-slate-400 mt-3"},rf={key:0,class:"bg-slate-50 rounded-2xl p-5 text-left"},lf={class:"text-sm text-slate-600 leading-relaxed"},cf={class:"px-6 pb-8 pt-4 border-t border-slate-100 bg-white"},uf={class:"max-w-md mx-auto space-y-4"},df={class:"flex gap-4"};function vf(s,t,n,a,g,o){return r(),i("div",B0,[t[9]||(t[9]=e("div",{class:"flex items-center justify-center px-4 py-4 border-b border-slate-100"},[e("span",{class:"text-xs font-medium text-slate-400 uppercase tracking-wider"},"Lesson Complete")],-1)),e("div",N0,[e("div",O0,[e("div",H0,[e("div",{class:J(["w-24 h-24 mx-auto rounded-full flex items-center justify-center text-5xl",o.medalBgClass])},d(n.medalIcon),3),e("h1",U0,d(n.medalLabel),1)]),e("div",G0,[e("div",Q0,[e("div",Y0,d(n.readableTime),1),t[3]||(t[3]=e("div",{class:"text-xs text-slate-400 uppercase tracking-wide mt-1"},"time",-1))]),t[6]||(t[6]=e("div",{class:"w-px bg-slate-200"},null,-1)),e("div",J0,[e("div",Z0,d(n.stars),1),t[4]||(t[4]=e("div",{class:"text-xs text-slate-400 uppercase tracking-wide mt-1"},"stars",-1))]),t[7]||(t[7]=e("div",{class:"w-px bg-slate-200"},null,-1)),e("div",X0,[e("div",K0,d(n.earnedPoints),1),t[5]||(t[5]=e("div",{class:"text-xs text-slate-400 uppercase tracking-wide mt-1"},"points",-1))])]),e("div",ef,[e("div",tf,[t[8]||(t[8]=e("span",{class:"text-sm font-medium text-slate-600"},"Accuracy",-1)),e("span",sf,d(o.accuracyPercentage)+"%",1)]),e("div",af,[e("div",{class:J(["h-full rounded-full transition-all duration-700",o.accuracyPercentage>=80?"bg-emerald-500":o.accuracyPercentage>=50?"bg-amber-500":"bg-red-400"]),style:xe({width:o.accuracyPercentage+"%"})},null,6)]),n.mistakeCount===0?(r(),i("p",nf,"Perfect! No mistakes")):(r(),i("p",of,d(n.mistakeCount)+" mistake"+d(n.mistakeCount>1?"s":""),1))]),n.progressInsight?(r(),i("div",rf,[e("p",lf,d(n.progressInsight),1)])):B("",!0)])]),e("div",cf,[e("div",uf,[e("button",{onClick:t[0]||(t[0]=v=>s.$emit("return-to-catalogue")),class:"w-full py-4 bg-slate-900 text-white font-semibold rounded-xl hover:bg-slate-800 transition-colors text-lg"}," Continue "),e("div",df,[e("button",{onClick:t[1]||(t[1]=v=>s.$emit("homework")),class:"flex-1 py-3.5 bg-slate-100 text-slate-700 font-medium rounded-xl hover:bg-slate-200 transition-colors"}," Homework "),e("button",{onClick:t[2]||(t[2]=v=>s.$emit("share")),class:"flex-1 py-3.5 bg-slate-100 text-slate-700 font-medium rounded-xl hover:bg-slate-200 transition-colors"}," Share ")]),e("div",null,[qs(s.$slots,"extra-actions",{},void 0,!0)])])])])}const gf=Ie(F0,[["render",vf],["__scopeId","data-v-fa3a10d5"]]),mf={name:"FloatingAIAssistant",props:{aiUsage:{type:Object,default:()=>({messages:0,current:0,limit:50,remaining:50,percentage:0,unlimited:!1,plan:"free"})},quickSuggestions:{type:Array,default:()=>[]},aiChatHistory:{type:Array,default:()=>[]},floatingAIInput:{type:String,default:""},aiIsLoading:{type:Boolean,default:!1}},emits:["close","send-message","ask-ai","clear-chat"],data(){return{localFloatingInput:"",showAllMessages:!1}},computed:{recentMessages(){return!this.aiChatHistory||!Array.isArray(this.aiChatHistory)?[]:this.showAllMessages?this.aiChatHistory:this.aiChatHistory.slice(-5)},userStatus(){var s,t;return((t=(s=this.$store)==null?void 0:s.getters)==null?void 0:t["user/userStatus"])||"free"},currentMessageCount(){return!this.aiUsage||typeof this.aiUsage!="object"?0:this.aiUsage.current||this.aiUsage.messages||0},messageLimit(){return!this.aiUsage||typeof this.aiUsage!="object"?50:this.aiUsage.limit||50},isUnlimited(){var s;return((s=this.aiUsage)==null?void 0:s.unlimited)||this.messageLimit===-1},remainingMessages(){var s;return this.isUnlimited?-1:((s=this.aiUsage)==null?void 0:s.remaining)||Math.max(0,this.messageLimit-this.currentMessageCount)},usagePercentage(){var s;return this.isUnlimited||this.messageLimit<=0?0:((s=this.aiUsage)==null?void 0:s.percentage)||Math.min(100,Math.round(this.currentMessageCount/this.messageLimit*100))},isMessageLimitReached(){return this.isUnlimited?!1:this.currentMessageCount>=this.messageLimit},isNearLimit(){if(this.isUnlimited)return!1;const s=Math.floor(this.messageLimit*.9);return this.currentMessageCount>=s&&!this.isMessageLimitReached},formattedUsage(){if(!this.aiUsage)return"0/50";const s=this.currentMessageCount;if(this.isUnlimited)return`${s}/âˆž`;const t=this.messageLimit;return`${s}/${t}`}},watch:{floatingAIInput:{handler(s){this.localFloatingInput=s},immediate:!0},aiChatHistory:{handler(){this.$nextTick(()=>{this.scrollToBottom()})},deep:!0}},mounted(){this.scrollToBottom()},methods:{sendMessage(){var s;if(!((s=this.localFloatingInput)!=null&&s.trim())||this.aiIsLoading||this.isMessageLimitReached){this.isMessageLimitReached;return}this.$emit("send-message",this.localFloatingInput.trim()),this.localFloatingInput=""},clearChat(){this.$emit("clear-chat")},formatTime(s){if(!(s!=null&&s.timestamp))return"";try{return new Date(s.timestamp).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}catch{return""}},scrollToBottom(){const s=this.$refs.chatMessages;s&&(s.scrollTop=s.scrollHeight)}}},ff={class:"floating-ai-assistant"},pf={class:"ai-header"},hf={class:"ai-body"},bf={key:0,class:"usage-display"},yf={key:0,class:"usage-bar"},xf={key:1,class:"quick-suggestions"},wf={class:"suggestions-list"},kf=["onClick","disabled"],_f={class:"ai-chat-area"},Cf={class:"chat-messages",ref:"chatMessages"},$f={key:0,class:"empty-chat-state"},Sf={class:"message-avatar"},If={key:0},Af={key:1},Tf={class:"message-bubble"},Mf={class:"message-content"},Lf={class:"message-time"},Ef={key:1,class:"loading-message"},Df={class:"chat-input"},Pf=["disabled"],Wf=["disabled","title"],jf={key:0,class:"loading-spinner"},zf={key:1},qf={key:0,class:"limit-warning"},Rf={key:0,class:"limit-reached"},Vf={key:1,class:"limit-near"},Ff={key:2,class:"chat-controls"};function Bf(s,t,n,a,g,o){var v;return r(),i("div",ff,[e("div",pf,[t[6]||(t[6]=e("h4",null,"ðŸ¤– AI Assistant",-1)),e("button",{onClick:t[0]||(t[0]=c=>s.$emit("close")),class:"close-ai-btn"},"âœ•")]),e("div",hf,[o.formattedUsage?(r(),i("div",bf,[e("p",null,"ðŸ“Š Used: "+d(o.formattedUsage),1),o.usagePercentage>0&&!o.isUnlimited?(r(),i("div",yf,[e("div",{class:"usage-fill",style:xe({width:o.usagePercentage+"%"})},null,4)])):B("",!0)])):B("",!0),(n.quickSuggestions||[]).length?(r(),i("div",xf,[t[7]||(t[7]=e("p",{class:"suggestions-label"},"ðŸ’¡ Quick questions:",-1)),e("div",wf,[(r(!0),i(de,null,ve(n.quickSuggestions||[],(c,l)=>(r(),i("button",{key:`quick-${l}`,onClick:_=>s.$emit("ask-ai",c),class:"quick-suggestion-btn",disabled:n.aiIsLoading||o.isMessageLimitReached},d(c),9,kf))),128))])])):B("",!0),e("div",_f,[e("div",Cf,[(n.aiChatHistory||[]).length?B("",!0):(r(),i("div",$f,t[8]||(t[8]=[e("div",{class:"empty-icon"},"ðŸ’­",-1),e("p",null,"Ask a question about the current step!",-1)]))),(r(!0),i(de,null,ve(o.recentMessages,c=>(r(),i("div",{key:(c==null?void 0:c.id)||`float-msg-${Math.random()}`,class:J(["chat-message",(c==null?void 0:c.type)||"unknown"])},[e("div",Sf,[(c==null?void 0:c.type)==="user"?(r(),i("span",If,"ðŸ‘¤")):(r(),i("span",Af,"ðŸ¤–"))]),e("div",Tf,[e("div",Mf,d((c==null?void 0:c.content)||"No content"),1),e("div",Lf,d(o.formatTime(c)),1)])],2))),128)),n.aiIsLoading?(r(),i("div",Ef,t[9]||(t[9]=[e("div",{class:"message-avatar"},[e("span",null,"ðŸ¤–")],-1),e("div",{class:"message-bubble loading"},[e("div",{class:"typing-indicator"},[e("span"),e("span"),e("span")])],-1)]))):B("",!0)],512),e("div",Df,[Xe(e("input",{"onUpdate:modelValue":t[1]||(t[1]=c=>g.localFloatingInput=c),onKeyup:t[2]||(t[2]=jt((...c)=>o.sendMessage&&o.sendMessage(...c),["enter"])),placeholder:"Ask about the current step...",disabled:n.aiIsLoading||o.isMessageLimitReached,class:"chat-input-field",ref:"chatInput"},null,40,Pf),[[tt,g.localFloatingInput]]),e("button",{onClick:t[3]||(t[3]=(...c)=>o.sendMessage&&o.sendMessage(...c)),disabled:!((v=g.localFloatingInput)!=null&&v.trim())||n.aiIsLoading||o.isMessageLimitReached,class:"send-btn",title:o.isMessageLimitReached?"Message limit reached":"Send message"},[n.aiIsLoading?(r(),i("span",jf,"â³")):(r(),i("span",zf,"ðŸ“¤"))],8,Wf)]),o.isNearLimit||o.isMessageLimitReached?(r(),i("div",qf,[o.isMessageLimitReached?(r(),i("div",Rf,t[10]||(t[10]=[Se(" ðŸš« Message limit reached. "),e("a",{href:"/pay/start",class:"upgrade-link"},"Upgrade subscription",-1)]))):o.isNearLimit?(r(),i("div",Vf," âš ï¸ Remaining "+d(o.remainingMessages)+" messages ",1)):B("",!0)])):B("",!0)]),(n.aiChatHistory||[]).length>3?(r(),i("div",Ff,[e("button",{onClick:t[4]||(t[4]=c=>g.showAllMessages=!g.showAllMessages),class:"toggle-messages-btn"},d(g.showAllMessages?"Show less":"Show all"),1),e("button",{onClick:t[5]||(t[5]=(...c)=>o.clearChat&&o.clearChat(...c)),class:"clear-chat-btn"}," ðŸ—‘ï¸ Clear ")])):B("",!0)])])}const Nf=Ie(mf,[["render",Bf],["__scopeId","data-v-44c7540d"]]),Of={name:"LessonPage",components:{VocabularyModal:Ea,LessonIntro:en,LessonHeader:mn,ContentPanel:eo,InteractivePanel:f0,AIHelpPanel:V0,CompletionScreen:gf,FloatingAIAssistant:Nf},setup(){var Rt,Vt;const s=Yt(),t=Qt(),n=30,a=70,g=16,o=O(()=>t.query.guest==="true"||!localStorage.getItem("authToken")),v=f(!1);let c=null;const l=Os(),_=Vs(),w=Jt(),P=Fs(),k=Bs(),b=Ns();ke(o,h=>{l.isGuestMode&&(l.isGuestMode.value=h)},{immediate:!0}),(Rt=k.initializeSpeech)==null||Rt.call(k),(Vt=b.initializeAI)==null||Vt.call(b);const C=f(!1),x=f(50),m=f(50),T=f(0),L=f(0),E=f(60),M=f(40),$=f("horizontal"),W=f(0),N=f(null),ie=f(typeof window<"u"?window.innerWidth:1024),S=O(()=>{const h=ie.value;return h>=768&&h<=1366}),R=O(()=>S.value||Ae.value),ee=f(0),se=f(2),ce=f(!1),ge=f(""),_e=f(!1),Y=f(null),V=f(!1),Q=f(!1),H=f("explanation"),q=f(!1),te=f(""),U=f(""),fe=f(""),me=f(""),ae=f(!1),p=f(!1),D=f(!1),F=f({currentExerciseId:null,initialized:!1}),oe=f(null),A=f(!1),z=O(()=>typeof window<"u"&&window.innerWidth<=640?{}:R.value?$.value==="vertical"?{height:"30%"}:{width:"30%"}:$.value==="vertical"?{height:`${x.value}%`}:{width:`${x.value}%`}),Z=O(()=>typeof window<"u"&&window.innerWidth<=640?{}:R.value?$.value==="vertical"?{height:"70%"}:{width:"70%"}:$.value==="vertical"?{height:`${m.value}%`}:{width:`${m.value}%`});O(()=>({currentStep:l.currentIndex.value,completedSteps:Array.from({length:l.currentIndex.value},(h,K)=>K),mistakes:l.mistakeCount.value,stars:l.stars.value,elapsedSeconds:l.elapsedSeconds.value}));const pe=O(()=>l.currentIndex.value>=l.steps.value.length-1),Ae=O(()=>{const h=l.currentStep.value;return(h==null?void 0:h.type)==="game"||!!(h!=null&&h.gameType)}),We=O(()=>{var h,K;return((K=(h=l.currentUser)==null?void 0:h.value)==null?void 0:K.token)||localStorage.getItem("authToken")}),ot=h=>{var K,ue,he,we;R.value||(h.preventDefault(),C.value=!0,$.value=window.innerWidth<=1023?"vertical":"horizontal",$.value==="horizontal"?T.value=h.clientX||((ue=(K=h.touches)==null?void 0:K[0])==null?void 0:ue.clientX)||0:L.value=h.clientY||((we=(he=h.touches)==null?void 0:he[0])==null?void 0:we.clientY)||0,E.value=x.value,M.value=m.value,document.body.classList.add("is-resizing"),document.body.style.cursor=$.value==="horizontal"?"col-resize":"row-resize",document.addEventListener("mousemove",He,{passive:!1}),document.addEventListener("mouseup",Ke),document.addEventListener("touchmove",He,{passive:!1}),document.addEventListener("touchend",Ke))},He=h=>{if(!C.value)return;h.preventDefault();const K=performance.now();if(K-W.value<g){N.value||(N.value=requestAnimationFrame(()=>{rt(h),N.value=null}));return}W.value=K,rt(h)},rt=h=>{var De,ze,Mt,Ft;const K=document.querySelector(".split-content");if(!K)return;let ue=0,he=0;if($.value==="horizontal"?(ue=(h.clientX||((ze=(De=h.touches)==null?void 0:De[0])==null?void 0:ze.clientX)||T.value)-T.value,he=K.offsetWidth):(ue=(h.clientY||((Ft=(Mt=h.touches)==null?void 0:Mt[0])==null?void 0:Ft.clientY)||L.value)-L.value,he=K.offsetHeight),he===0)return;const we=ue/he*100;let Ee=E.value+we,Oe=100-Ee;const Je=$.value==="vertical"?25:n,Ze=$.value==="vertical"?75:a;Ee<Je?(Ee=Je,Oe=100-Je):Ee>Ze&&(Ee=Ze,Oe=100-Ze),Oe<Je?(Oe=Je,Ee=100-Je):Oe>Ze&&(Oe=Ze,Ee=100-Ze),x.value=Ee,m.value=Oe},Ke=()=>{if(C.value){C.value=!1,N.value&&(cancelAnimationFrame(N.value),N.value=null),document.removeEventListener("mousemove",He),document.removeEventListener("mouseup",Ke),document.removeEventListener("touchmove",He),document.removeEventListener("touchend",Ke),document.body.classList.remove("is-resizing"),document.body.style.cursor="";try{localStorage.setItem("lessonPageSplitSizes",JSON.stringify({left:x.value,right:m.value,timestamp:Date.now()}))}catch{}}},st=()=>{x.value=60,m.value=40},it=()=>{try{const h=localStorage.getItem("lessonPageSplitSizes");if(h){const{left:K,right:ue,timestamp:he}=JSON.parse(h),we=Date.now()-30*24*60*60*1e3;he&&he>we?(x.value=Math.max(n,Math.min(a,K||60)),m.value=Math.max(n,Math.min(a,ue||40))):(localStorage.removeItem("lessonPageSplitSizes"),st())}else st()}catch{st()}},dt=()=>{st();try{localStorage.removeItem("lessonPageSplitSizes")}catch{}},Ye=()=>{const h=window.innerWidth,K=window.innerHeight,ue=h>K;ie.value=h;let he="horizontal";h<=640&&!ue||h<=1023&&!ue?he="vertical":(K<=500&&ue||h>1023,he="horizontal");const we=$.value==="vertical",Ee=he==="vertical";we!==Ee&&($.value=he,Ee?(x.value=50,m.value=50):(x.value=60,m.value=40))},vt=()=>{var K;if((K=l.lesson.value)!=null&&K._id)try{sessionStorage.setItem("returnToLesson",l.lesson.value._id)}catch{}const h=document.getElementById("hero");h?(h.scrollIntoView({behavior:"smooth"}),setTimeout(()=>{window.dispatchEvent(new Event("open-Login-modal"))},600)):window.dispatchEvent(new Event("open-Login-modal")),l.showExitModal&&(l.showExitModal.value=!1)},kt=()=>{v.value=!0;try{sessionStorage.setItem("guestBannerDismissed","true")}catch{}},je=()=>{var h;if(o.value)try{const K=JSON.parse(localStorage.getItem("guestProgress")||"{}"),ue=(h=l.lesson.value)==null?void 0:h._id;ue&&(K[ue]={currentStep:l.currentIndex.value,completedSteps:Array.from({length:l.currentIndex.value+1},(he,we)=>we),mistakes:l.mistakeCount.value,stars:l.stars.value,elapsedSeconds:l.elapsedSeconds.value,timestamp:Date.now(),completed:l.lessonCompleted.value||!1},localStorage.setItem("guestProgress",JSON.stringify(K)))}catch{}},ft=()=>{var h;if(!o.value)return null;try{const K=JSON.parse(localStorage.getItem("guestProgress")||"{}"),ue=(h=l.lesson.value)==null?void 0:h._id;if(ue&&K[ue])return K[ue]}catch{}return null},pt=()=>{o.value&&(c=setInterval(()=>{l.started.value&&!l.lessonCompleted.value&&je()},3e4))},_t=()=>{c&&(clearInterval(c),c=null)},ht=()=>{s.push("/profile/catalogue").catch(h=>{window.location.href="/profile/catalogue"})},Ct=()=>{var h;if(o.value){vt();return}if((h=l.lesson.value)!=null&&h._id)try{s.push({name:"LessonHomeworkPage",params:{lessonId:l.lesson.value._id},query:{title:l.lesson.value.title||l.lesson.value.lessonName,subject:l.lesson.value.subject||"general"}}).catch(()=>{s.push({name:"HomeworkList"}).catch(()=>{window.location.href="/profile/homeworks"})})}catch{window.location.href="/profile/homeworks"}else try{s.push({name:"HomeworkList"}).catch(()=>{window.location.href="/profile/homeworks"})}catch{window.location.href="/profile/homeworks"}},$t=async()=>{var h;if(!(o.value||!l.lesson.value))try{const K=(h=l.currentUser.value)==null?void 0:h.uid,ue=l.lesson.value;await fetch(`/api/users/${K}/study-list`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${We.value}`},body:JSON.stringify({topicId:ue.topicId,topicName:ue.topic,lessonId:ue._id,addedAt:new Date})})}catch(K){console.error("Failed to add to courses",K)}},St=async()=>{await l.startLesson(),$t()},It=async()=>{try{o.value?je():l.saveProgress&&l.saveProgress().catch(()=>{}),l.cleanup&&l.cleanup(),l.showExitModal.value=!1,ht()}catch{l.showExitModal.value=!1,s.push("/profile/catalogue")}},ct=()=>{q.value=!0,ut()},at=()=>{q.value=!1,ut()},ut=()=>{te.value="",U.value="",fe.value="",me.value="",ae.value=!1,p.value=!1},j=()=>{const h=te.value.trim().length>0;return p.value=!h,h},ne=()=>{var h,K,ue;return{lessonName:((h=l.lesson.value)==null?void 0:h.lessonName)||"Unknown lesson",lessonId:((K=l.lesson.value)==null?void 0:K._id)||"N/A",currentStep:l.currentIndex.value+1,totalSteps:((ue=l.steps.value)==null?void 0:ue.length)||0,userAgent:navigator.userAgent,timestamp:new Date().toLocaleString("en-US"),url:window.location.href,isGuestMode:o.value}},le=()=>{const h=ne();let K=`ðŸš¨ LESSON PROBLEM REPORT

`;return K+=`ðŸ“š Lesson: ${h.lessonName}
`,K+=`ðŸ†” Lesson ID: ${h.lessonId}
`,K+=`ðŸ“ Current Step: ${h.currentStep}/${h.totalSteps}
`,K+=`ðŸ‘¤ Mode: ${h.isGuestMode?"Guest":"Registered"}
`,K+=`ðŸ• Time: ${h.timestamp}

`,U.value&&(K+=`âš ï¸ Problem Type: ${{content:"Content Error",technical:"Technical Problem",interface:"Interface Issue",exercise:"Exercise Error",audio:"Audio Problem",other:"Other"}[U.value]}

`),K+=`ðŸ“ Problem Description:
${te.value}

`,fe.value&&(K+=`ðŸ“¸ Screenshot: ${fe.value}

`),me.value&&(K+=`ðŸ“ž Contact: ${me.value}

`),K+=`ðŸ”§ TECHNICAL INFORMATION:
`,K+=`ðŸŒ URL: ${h.url}
`,K+=`ðŸ’» Browser: ${h.userAgent}
`,K},Ce=async()=>{if(j())try{ae.value=!0;const h=le(),ue=`https://t.me/aced_live?text=${encodeURIComponent(h)}`;if(!o.value)try{await fetch("/api/analytics/problem-report",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${We.value}`},body:JSON.stringify({lessonId:ne().lessonId,problemType:U.value,description:te.value,hasScreenshot:!!fe.value,hasContact:!!me.value,isGuestMode:o.value,userAgent:navigator.userAgent,timestamp:new Date().toISOString()})})}catch{}window.open(ue,"_blank"),at(),D.value=!0,setTimeout(()=>{D.value=!1},5e3)}catch{alert("Error submitting report. Please try again.")}finally{ae.value=!1}},Ue=()=>{D.value=!1},Ge=h=>{var ue;let K=h;if(K||(K=l.currentStep.value),!!K){if(K.type!=="vocabulary"){const he=(ue=l.steps.value)==null?void 0:ue.filter(we=>we.type==="vocabulary");if(he&&he.length>0)K=he[0];else return}_.initializeVocabularyModal(K)}},u=h=>{h>=0&&h<_.vocabularyModal.words.length&&(_.cardAnimation.isFlipping=!1,_.cardAnimation.showDefinition=!1,setTimeout(()=>{_.vocabularyModal.currentIndex=h},50))},y=()=>_.showVocabDefinition(),I=()=>_.hideVocabDefinition(),X=()=>_.markWordAsLearned(),G=()=>_.nextVocabWord(),re=()=>_.previousVocabWord(),ye=()=>_.skipVocabularyModal(),Ve=()=>_.restartVocabulary(),Qe=()=>{_.vocabularyModal&&(_.vocabularyModal.isVisible=!1)},Le=h=>{var K,ue;if(!(!h||typeof h!="string"))try{if("speechSynthesis"in window){window.speechSynthesis.cancel();const he=new SpeechSynthesisUtterance(h.trim());he.lang="en-US",he.rate=.8,he.pitch=1,window.speechSynthesis.speak(he)}else(K=k.pronounceWord)==null||K.call(k,h)}catch{(ue=k.pronounceWord)==null||ue.call(k,h)}},Ne=()=>{var he,we,Ee,Oe,Je,Ze;const h=l.currentStep.value;if(!h)return null;if(h.type==="game"||h.gameType||h.data&&h.data.gameConfig){const De=h.gameType||h.gameConfig&&h.gameConfig.type||h.gameConfig&&h.gameConfig.gameType||h.data&&h.data.gameType||h.data&&h.data.type||(h.type==="whack-a-mole"?"whack-a-mole":null)||(h.type==="basket-catch"?"basket-catch":null)||"basket-catch";return{...h,_id:h._id||`game_${l.currentIndex.value}`,id:h.id||`game_${l.currentIndex.value}`,type:"game",title:h.title||"Game",description:h.instructions||h.description||"",gameType:De,gameConfig:{...h.gameConfig||{},...h.data||{},gameType:De,questions:((he=h.gameConfig)==null?void 0:he.questions)||((we=h.data)==null?void 0:we.questions)||h.questions||[]},questions:h.questions||((Ee=h.gameConfig)==null?void 0:Ee.questions)||((Oe=h.data)==null?void 0:Oe.questions)||[],instructions:h.instructions||h.description||"Play the game!"}}if(["exercise","quiz","practice"].includes(h.type)&&Array.isArray(h.data)){const De=w.currentExerciseIndex.value||0,ze=h.data[De];if(ze){const Mt=ze.id||`${h.id}_${De}`;return F.value.currentExerciseId!==Mt&&(F.value={currentExerciseId:Mt,initialized:!1},lt(()=>{w.initializeCurrentExerciseData(ze),F.value.initialized=!0,ze.type==="drag-drop"&&At()})),ze}}if(h.type==="exercise"&&h.content&&h.content.type){const De=h.id||h._id||`${h.content.type}_${l.currentIndex.value}`,ze={_id:h._id,id:h.id,type:"exercise",order:h.order,title:h.title,instructions:h.instructions,description:h.instructions||h.description,difficulty:h.difficulty,estimatedDuration:h.estimatedDuration,scoring:h.scoring,content:h.content,data:h.content.data||h.content,exerciseType:h.content.type};return F.value.currentExerciseId!==De&&(F.value={currentExerciseId:De,initialized:!1},lt(()=>{w.initializeCurrentExerciseData(ze),F.value.initialized=!0})),ze}if(h.type==="exercise"&&h.data&&typeof h.data=="object"&&!Array.isArray(h.data)&&h.data.type){const De=h.id||`${h.data.type}_${l.currentIndex.value}`,ze={...h.data,...h,exerciseType:h.data.type,data:h.data,content:h.data};return F.value.currentExerciseId!==De&&(F.value={currentExerciseId:De,initialized:!1},lt(()=>{w.initializeCurrentExerciseData(ze),F.value.initialized=!0})),ze}if(["data_analysis","fraction_visual","geometry_poly","chem_mixing","chem_matching","english_sentence_fix","english_sentence_order","language_noun_bag","histogram","map","block-coding","language_tone_transformer","language_idiom_bridge","language_word_constellation","language_rhythm_match","language_false_friends"].includes(h.type)){const De=h.id||h._id||`${h.type}_${l.currentIndex.value}`,ze={...h,exerciseType:h.type,content:h.content||h,data:((Je=h.content)==null?void 0:Je.data)||h.data||h};return F.value.currentExerciseId!==De&&(F.value={currentExerciseId:De,initialized:!1},lt(()=>{w.initializeCurrentExerciseData(ze),F.value.initialized=!0})),ze}const ue=w.getCurrentExercise(h);if(ue){const De=ue.id||`${ue.type}_${(Ze=ue.question)==null?void 0:Ze.substring(0,20)}`;F.value.currentExerciseId!==De&&(F.value={currentExerciseId:De,initialized:!1},lt(()=>{w.initializeCurrentExerciseData(ue),F.value.initialized=!0,ue.type==="drag-drop"&&lt(()=>{At()})}))}return ue},Fe=()=>w.getCurrentQuiz(l.currentStep.value),Be=()=>w.getTotalExercises(l.currentStep.value),bt=()=>w.getTotalQuizzes(l.currentStep.value),zt=({item:h,event:K})=>{var ue;w.handleDragItemStart({item:h,event:K}),(ue=k.playClickSound)==null||ue.call(k)},Xt=h=>{w.handleDragOverZone(h)},Kt=()=>{w.handleDragLeaveZone()},es=({zoneId:h,item:K})=>{var ue;w.handleDropInZone({zoneId:h,item:K}),(ue=k.playSuccessSound)==null||ue.call(k),o.value?je():l.saveProgress&&l.saveProgress().catch(()=>{})},ts=({zoneId:h,itemIndex:K,item:ue})=>{var he;w.handleRemoveDroppedItem({zoneId:h,itemIndex:K,item:ue}),(he=k.playClickSound)==null||he.call(k)},At=()=>{const h=Ne();!h||h.type!=="drag-drop"||(w.availableDragItems.value.length===0||w.dropZones.value.length===0)&&w.initializeDragDropItems(h)},ss=h=>{w.updateUserAnswer(h,Ne())},as=({index:h,value:K})=>{w.updateFillBlankAnswer(h,K)},ns=h=>{w.handleMatchingSelection(h)},os=h=>{w.removeMatchingPair(h)},rs=async()=>{var Ee,Oe,Je,Ze;const h=l.currentStep.value;if(!h)return;if(ce.value){ls();return}const K=Ne(),ue=Fe();let he=!1,we=null;if(h.type==="exercise"||h.type==="practice"?(we=K,we&&(he=w.validateCurrentAnswer(we))):h.type==="quiz"&&(we=ue,we&&(he=w.validateQuizAnswer(we))),ee.value++,he)w.answerWasCorrect.value=!0,l.stars.value++,l.earnedPoints.value+=10,ee.value===1?(l.earnedPoints.value+=5,w.confirmation.value=w.getRandomSuccessMessage()+" ðŸŒŸ Bonus for first attempt!"):w.confirmation.value=w.getRandomSuccessMessage()+" ðŸ’ª Great, on the second attempt!",(Ee=k.playSuccessSound)==null||Ee.call(k),_e.value=!1;else if(w.answerWasCorrect.value=!1,ee.value<se.value){_e.value=!0,w.confirmation.value=w.getSecondChanceMessage(we),(Oe=k.playErrorSound)==null||Oe.call(k);return}else l.mistakeCount.value++,l.earnedPoints.value=Math.max(0,l.earnedPoints.value-2),ce.value=!0,ge.value=w.getCorrectAnswerDisplay(we),w.confirmation.value=w.getFinalFailureMessage(we,ge.value),_e.value=!1,(Je=k.playErrorSound)==null||Je.call(k),l.mistakeCount.value>=2&&await((Ze=b.generateSmartHintForMistakes)==null?void 0:Ze.call(b,we,l.mistakeCount.value,{lessonId:l.lesson.value._id,userAnswer:w.getCurrentUserAnswer(),correctAnswer:ge.value}));o.value?je():await l.saveProgress()},Tt=()=>{ee.value=0,_e.value=!1,ce.value=!1,ge.value="",w.confirmation.value="",w.answerWasCorrect.value=!1,F.value={currentExerciseId:null,initialized:!1}},ls=()=>{var h,K;Tt(),(h=w.isLastExercise)!=null&&h.call(w,l.currentStep.value)||(K=w.isLastQuiz)!=null&&K.call(w,l.currentStep.value)?l.goNext():l.currentStep.value.type==="exercise"||l.currentStep.value.type==="practice"?w.goToNextExercise(l.currentStep.value,l.goNext):l.currentStep.value.type==="quiz"&&w.goToNextQuiz(l.currentStep.value,l.goNext),o.value&&je()},is=()=>{Tt(),w.goToNextExercise(l.currentStep.value,l.goNext),o.value&&je()},cs=()=>{Tt(),w.goToNextQuiz(l.currentStep.value,l.goNext),o.value&&je()},us=()=>{Tt(),l.goNext(),o.value&&je()},ds=()=>{Tt(),l.goPrevious(),o.value&&je()},vs=h=>w.showHint(h),gs=()=>w.clearSmartHint(),ms=b.toggleExplanationHelp,fs=b.askAboutExplanation,ps=b.sendAIMessage,hs=b.askAI,bs=b.clearAIChat,ys=b.toggleFloatingAI,xs=b.closeFloatingAI,ws=b.sendFloatingAIMessage,ks=()=>{A.value=!0,lt(()=>{setTimeout(()=>{A.value=!1},5e3)})},_s=async()=>{var h,K,ue,he;if(o.value){vt();return}try{if(V.value=!0,!((K=(h=l.currentUser)==null?void 0:h.value)!=null&&K.uid))throw new Error("User not found");const we=await fetch(`/api/homework/migrate-from-lessons/${l.currentUser.value.uid}`,{method:"POST",headers:{Authorization:`Bearer ${We.value}`,"Content-Type":"application/json"}}),Ee=await we.json();if(!we.ok)throw new Error(Ee.error||"Migration failed");if(Ee.success){const Oe=`âœ… Migration completed! Created ${((ue=Ee.data)==null?void 0:ue.homeworkCreated)||0} assignments and added ${((he=Ee.data)==null?void 0:he.vocabularyAdded)||0} words to vocabulary.`;alert(Oe),Q.value=!1}else throw new Error(Ee.error||"Migration failed")}catch(we){alert("âŒ Migration error: "+we.message)}finally{V.value=!1}},Cs=()=>{Q.value=!0},$s=()=>{Q.value=!1},qt=h=>{h.ctrlKey&&h.shiftKey&&h.key==="R"&&(h.preventDefault(),!q.value&&l.started.value&&!l.lessonCompleted.value&&ct()),h.ctrlKey&&h.altKey&&h.key==="R"&&(h.preventDefault(),dt())};return nt(()=>{document.addEventListener("keydown",qt),window.addEventListener("resize",Ye),window.addEventListener("orientationchange",Ye),window.visualViewport&&window.visualViewport.addEventListener("resize",Ye),it(),Ye();try{sessionStorage.getItem("guestBannerDismissed")&&(v.value=!0)}catch{}o.value&&(ft(),pt()),window.resetSplitSizes=dt,window.loadSavedSizes=it}),mt(()=>{document.removeEventListener("keydown",qt),window.removeEventListener("resize",Ye),window.removeEventListener("orientationchange",Ye),window.visualViewport&&window.visualViewport.removeEventListener("resize",Ye),C.value&&Ke(),N.value&&cancelAnimationFrame(N.value),document.body.classList.remove("is-resizing"),document.body.style.cursor="",_t(),o.value&&l.started.value&&je(),delete window.resetSplitSizes,delete window.loadSavedSizes}),ke(()=>l.lessonCompleted.value,(h,K)=>{h&&!K&&(ks(),o.value&&je())}),ke(()=>l.currentStep.value,(h,K)=>{if((h==null?void 0:h.id)!==(K==null?void 0:K.id)&&(w.currentExerciseIndex.value=0,F.value={currentExerciseId:null,initialized:!1}),h&&h.type==="exercise"){const ue=Ne();ue&&ue.type==="drag-drop"&&lt(()=>{At()})}},{immediate:!1}),ke(()=>[l.currentStep.value,w.currentExerciseIndex.value],([h])=>{if(h&&h.type==="exercise"){const K=Ne();K&&K.type==="drag-drop"&&lt(()=>{At()})}},{immediate:!0}),ke(()=>l.currentIndex.value,(h,K)=>{o.value&&l.started.value&&h!==K&&je()}),{isGuestMode:o,guestBannerDismissed:v,handleGuestRegister:vt,dismissGuestBanner:kt,saveGuestProgress:je,loadGuestProgress:ft,isResizing:C,currentLeftWidth:x,currentRightWidth:m,resizeDirection:$,leftPanelStyle:z,rightPanelStyle:Z,resizeDisabled:R,isTablet:S,startResize:ot,handleResize:He,stopResize:Ke,resetSplitSizes:dt,loadSavedSizes:it,handleWindowResize:Ye,loading:l.loading,error:l.error,lesson:l.lesson,started:l.started,currentIndex:l.currentIndex,steps:l.steps,progressPercentage:l.progressPercentage,currentStep:l.currentStep,isInteractiveStep:l.isInteractiveStep,isGameStep:Ae,showPaywallModal:P.showPaywallModal,showExitModal:l.showExitModal,lessonCompleted:l.lessonCompleted,readableTime:l.readableTime,stars:l.stars,mistakeCount:l.mistakeCount,earnedPoints:l.earnedPoints,medalLabel:l.medalLabel,getMedalIcon:l.getMedalIcon,progressInsight:l.progressInsight,estimatedTime:l.estimatedTime,previousProgress:l.previousProgress,formattedTime:l.formattedTime,userAnswer:w.userAnswer,confirmation:w.confirmation,answerWasCorrect:w.answerWasCorrect,currentHint:w.currentHint,smartHint:b.smartHint,fillBlankAnswers:w.fillBlankAnswers,matchingPairs:w.matchingPairs,selectedMatchingItem:w.selectedMatchingItem,orderingItems:w.orderingItems,dragDropPlacements:w.dragDropPlacements,availableDragItems:w.availableDragItems,dropZones:w.dropZones,currentExerciseIndex:w.currentExerciseIndex,currentQuizIndex:w.currentQuizIndex,attemptCount:ee,maxAttempts:se,showCorrectAnswer:ce,correctAnswerText:ge,isOnSecondChance:_e,showMigrationPanel:Q,migrationLoading:V,extractionResults:Y,currentTab:H,consecutiveCorrect:l.consecutiveCorrect,showExplanationHelp:b.showExplanationHelp,explanationQuestion:b.explanationQuestion,explanationAIResponse:b.explanationAIResponse,isLoadingExplanation:b.isLoadingExplanation,aiSuggestions:b.aiSuggestions,aiChatInput:b.aiChatInput,aiChatHistory:b.aiChatHistory,aiIsLoading:b.aiIsLoading,aiUsage:b.aiUsage,showFloatingAI:b.showFloatingAI,floatingAIInput:b.floatingAIInput,quickSuggestions:b.quickSuggestions,vocabularyModal:_.vocabularyModal,cardAnimation:_.cardAnimation,currentVocabWord:_.currentWord,vocabProgress:_.progress,isLastVocabWord:_.isLastWord,showProblemReportModal:q,problemDescription:te,problemType:U,screenshotUrl:fe,contactInfo:me,isSubmitting:ae,showValidationError:p,showSuccessMessage:D,confettiCanvas:oe,showConfetti:A,isLastStep:pe,retryLoad:l.retryLoad,startLesson:St,continuePreviousProgress:l.continuePreviousProgress,confirmExit:l.confirmExit,cancelExit:l.cancelExit,shareResult:l.shareResult,goToVocabulary:l.goToVocabulary,getLessonProgress:l.getLessonProgress,exitLesson:It,handleReturnToCatalogue:ht,handleGoToHomework:Ct,getCurrentExercise:Ne,getCurrentQuiz:Fe,getTotalExercises:Be,getTotalQuizzes:bt,handleAnswerChanged:ss,updateFillBlankAnswer:as,handleSubmitOrNext:rs,goToNextExercise:is,goToNextQuiz:cs,goNext:us,goPrevious:ds,showHint:vs,clearSmartHint:gs,handleMatchingItemSelected:ns,handleRemoveMatchingPair:os,handleDragItemStart:zt,handleDragOverZone:Xt,handleDragLeaveZone:Kt,handleDropInZone:es,handleRemoveDroppedItem:ts,ensureDragDropInitialization:At,toggleExplanationHelp:ms,askAboutExplanation:fs,sendAIMessage:ps,askAI:hs,clearAIChat:bs,toggleFloatingAI:ys,closeFloatingAI:xs,sendFloatingAIMessage:ws,initializeVocabularyModal:Ge,jumpToVocabWord:u,showVocabDefinition:y,hideVocabDefinition:I,markWordAsLearned:X,nextVocabWord:G,previousVocabWord:re,skipVocabularyModal:ye,closeVocabularyModal:Qe,restartVocabulary:Ve,pronounceWord:Le,migrateLessonContent:_s,showMigrationPanelModal:Cs,closeMigrationPanel:$s,openProblemReportModal:ct,closeProblemReportModal:at,submitProblemReport:Ce,closeSuccessMessage:Ue}}},Hf={class:"lesson-page"},Uf={key:0,class:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-slate-50 p-4"},Gf={class:"text-slate-600 font-medium"},Qf={key:1,class:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-slate-50 p-6 text-center"},Yf={class:"text-xl font-bold text-slate-800 mb-2"},Jf={class:"text-slate-500 mb-6 max-w-sm"},Zf={class:"flex flex-col sm:flex-row gap-3 w-full max-w-xs"},Xf={key:0,class:"fixed inset-0 z-1000 bg-black/40 flex items-center justify-center p-4"},Kf={class:"bg-white rounded-2xl w-full max-w-xs p-6 text-center"},ep={class:"space-y-2"},tp={key:0,class:"fixed inset-0 z-1000 bg-black/40 flex items-center justify-center p-4"},sp={class:"bg-white rounded-2xl w-full max-w-xs p-6 text-center"},ap={class:"space-y-2"},np={class:"bg-white rounded-2xl w-full max-w-md max-h-[85vh] overflow-hidden flex flex-col"},op={class:"flex items-center justify-between px-5 py-4 border-b border-slate-100"},rp={class:"flex-1 overflow-y-auto px-5 py-4 space-y-4"},lp={key:0,class:"mt-1 text-xs text-red-500"},ip={class:"px-5 py-4 border-t border-slate-100 flex gap-3"},cp=["disabled"],up={key:0,class:"fixed top-4 right-4 z-2000 max-w-sm w-full"},dp={class:"bg-white rounded-2xl shadow-xl border border-emerald-100 p-4 flex items-start gap-4"},vp={key:4,class:"lesson-container-new"},gp={class:"sticky top-0 z-40 bg-white/95 backdrop-blur-md border-b border-slate-200 px-3 sm:px-4 py-2.5 sm:py-3"},mp={class:"flex items-center justify-between gap-2 sm:gap-4"},fp={class:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1"},pp={class:"min-w-0 flex-1 hidden sm:block"},hp={class:"text-sm font-semibold text-slate-800 truncate"},bp={class:"text-xs text-slate-400 truncate"},yp={class:"flex items-center gap-2 shrink-0"},xp={class:"w-20 sm:w-28 h-2 bg-slate-100 rounded-full overflow-hidden"},wp={class:"text-xs font-semibold text-slate-500 tabular-nums"},kp={class:"flex items-center gap-1.5 sm:gap-2 shrink-0"},_p={class:"flex items-center gap-1 px-2.5 py-1.5 bg-amber-50 rounded-lg"},Cp={class:"text-xs font-bold text-amber-700"},$p={class:"flex items-center gap-1 px-2.5 py-1.5 bg-indigo-50 rounded-lg"},Sp={class:"text-xs font-bold text-indigo-700"},Ip={key:0,class:"interactive-container"},Ap={key:0,class:"fixed bottom-4 right-4 z-100 max-w-sm w-full"},Tp={class:"bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden"},Mp={class:"px-5 py-4"},Lp={class:"flex gap-3"},Ep=["disabled"],Dp={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Pp={key:1,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},Wp={key:8,ref:"confettiCanvas",class:"confetti-canvas"};function jp(s,t,n,a,g,o){var k,b,C,x;const v=yt("VocabularyModal"),c=yt("LessonIntro"),l=yt("ContentPanel"),_=yt("InteractivePanel"),w=yt("CompletionScreen"),P=yt("FloatingAIAssistant");return r(),i("div",Hf,[a.loading?(r(),i("div",Uf,[t[22]||(t[22]=e("div",{class:"w-12 h-12 border-4 border-slate-200 border-t-indigo-600 rounded-full animate-spin mb-4"},null,-1)),e("p",Gf,d(s.$t("loadingStates.lesson")),1)])):a.error?(r(),i("div",Qf,[t[25]||(t[25]=e("div",{class:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4"},[e("svg",{class:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),e("h3",Yf,d(s.$t("loadingStates.errorLoading")),1),e("p",Jf,d(a.error),1),e("div",Zf,[e("button",{onClick:t[0]||(t[0]=(...m)=>a.retryLoad&&a.retryLoad(...m)),class:"flex-1 py-3 px-6 bg-indigo-600 text-white font-semibold rounded-xl hover:bg-indigo-700 transition-colors flex items-center justify-center gap-2"},t[23]||(t[23]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),Se(" Try Again ")])),e("button",{onClick:t[1]||(t[1]=(...m)=>a.handleReturnToCatalogue&&a.handleReturnToCatalogue(...m)),class:"flex-1 py-3 px-6 bg-slate-100 text-slate-700 font-semibold rounded-xl hover:bg-slate-200 transition-colors flex items-center justify-center gap-2"},t[24]||(t[24]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),Se(" Back ")]))])])):B("",!0),(r(),$e(Lt,{to:"body"},[a.showPaywallModal?(r(),i("div",Xf,[e("div",Kf,[t[26]||(t[26]=e("div",{class:"w-16 h-16 mx-auto mb-4 bg-slate-100 rounded-full flex items-center justify-center"},[e("svg",{class:"w-8 h-8 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})])],-1)),t[27]||(t[27]=e("h3",{class:"text-lg font-bold text-slate-900 mb-2"},"Premium Content",-1)),t[28]||(t[28]=e("p",{class:"text-slate-500 text-sm mb-6"},"Upgrade to access this lesson",-1)),e("div",ep,[e("button",{onClick:t[2]||(t[2]=m=>s.$router.push("/pay/start")),class:"w-full py-3 bg-slate-900 text-white font-semibold rounded-xl hover:bg-slate-800 transition-colors"}," Get Premium "),e("button",{onClick:t[3]||(t[3]=(...m)=>a.handleReturnToCatalogue&&a.handleReturnToCatalogue(...m)),class:"w-full py-3 text-slate-500 font-medium hover:text-slate-700 transition-colors"}," Go Back ")])])])):B("",!0)])),(r(),$e(Lt,{to:"body"},[a.showExitModal?(r(),i("div",tp,[e("div",sp,[t[29]||(t[29]=e("h3",{class:"text-lg font-bold text-slate-900 mb-2"},"Leave Lesson?",-1)),t[30]||(t[30]=e("p",{class:"text-slate-500 text-sm mb-6"},"Your progress will be saved",-1)),e("div",ap,[e("button",{onClick:t[4]||(t[4]=(...m)=>a.exitLesson&&a.exitLesson(...m)),class:"w-full py-3 bg-slate-900 text-white font-semibold rounded-xl hover:bg-slate-800 transition-colors"}," Leave "),e("button",{onClick:t[5]||(t[5]=(...m)=>a.cancelExit&&a.cancelExit(...m)),class:"w-full py-3 text-slate-500 font-medium hover:text-slate-700 transition-colors"}," Stay ")])])])):B("",!0)])),(r(),$e(Lt,{to:"body"},[a.showProblemReportModal?(r(),i("div",{key:0,class:"fixed inset-0 z-1000 bg-black/40 flex items-center justify-center p-4",onClick:t[12]||(t[12]=qe((...m)=>a.closeProblemReportModal&&a.closeProblemReportModal(...m),["self"]))},[e("div",np,[e("div",op,[t[32]||(t[32]=e("h3",{class:"font-semibold text-slate-900"},"Report Issue",-1)),e("button",{onClick:t[6]||(t[6]=(...m)=>a.closeProblemReportModal&&a.closeProblemReportModal(...m)),class:"w-8 h-8 flex items-center justify-center rounded-full text-slate-400 hover:text-slate-600 hover:bg-slate-100 transition-colors"},t[31]||(t[31]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",rp,[e("div",null,[t[34]||(t[34]=e("label",{class:"block text-sm font-medium text-slate-700 mb-1.5"},"Type",-1)),Xe(e("select",{"onUpdate:modelValue":t[7]||(t[7]=m=>a.problemType=m),class:"w-full px-3 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-slate-800 focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent"},t[33]||(t[33]=[e("option",{value:""},"Select...",-1),e("option",{value:"content"},"Content Error",-1),e("option",{value:"technical"},"Technical",-1),e("option",{value:"exercise"},"Exercise",-1),e("option",{value:"other"},"Other",-1)]),512),[[Rs,a.problemType]])]),e("div",null,[t[35]||(t[35]=e("label",{class:"block text-sm font-medium text-slate-700 mb-1.5"},"Description *",-1)),Xe(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=m=>a.problemDescription=m),rows:"3",placeholder:"Describe the issue...",class:J(["w-full px-3 py-2.5 bg-slate-50 border rounded-xl text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent resize-none",a.showValidationError&&!a.problemDescription.trim()?"border-red-300":"border-slate-200"])},null,2),[[tt,a.problemDescription]]),a.showValidationError&&!a.problemDescription.trim()?(r(),i("p",lp,"Required")):B("",!0)]),e("div",null,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium text-slate-700 mb-1.5"},"Contact (optional)",-1)),Xe(e("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=m=>a.contactInfo=m),placeholder:"Email or @telegram",class:"w-full px-3 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent"},null,512),[[tt,a.contactInfo]])])]),e("div",ip,[e("button",{onClick:t[10]||(t[10]=(...m)=>a.closeProblemReportModal&&a.closeProblemReportModal(...m)),class:"flex-1 py-3 text-slate-600 font-medium rounded-xl hover:bg-slate-100 transition-colors"}," Cancel "),e("button",{onClick:t[11]||(t[11]=(...m)=>a.submitProblemReport&&a.submitProblemReport(...m)),disabled:a.isSubmitting,class:"flex-1 py-3 bg-slate-900 text-white font-semibold rounded-xl hover:bg-slate-800 transition-colors disabled:opacity-50"},d(a.isSubmitting?"Sending...":"Send"),9,cp)])])])):B("",!0)])),(r(),$e(Lt,{to:"body"},[Me(Re,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 translate-x-full","enter-to-class":"opacity-100 translate-x-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 translate-x-0","leave-to-class":"opacity-0 translate-x-full"},{default:Pe(()=>[a.showSuccessMessage?(r(),i("div",up,[e("div",dp,[t[38]||(t[38]=e("div",{class:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center shrink-0"},[e("svg",{class:"w-5 h-5 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),t[39]||(t[39]=e("div",{class:"flex-1 min-w-0"},[e("h4",{class:"text-sm font-semibold text-slate-800"},"Report Sent!"),e("p",{class:"text-sm text-slate-500 mt-0.5"},"Thank you for helping us improve.")],-1)),e("button",{onClick:t[13]||(t[13]=(...m)=>a.closeSuccessMessage&&a.closeSuccessMessage(...m)),class:"text-slate-400 hover:text-slate-600 transition-colors"},t[37]||(t[37]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])])):B("",!0)]),_:1})])),a.vocabularyModal.isVisible?(r(),$e(v,{key:2,"vocabulary-data":a.vocabularyModal,"card-animation":a.cardAnimation,"current-word":a.currentVocabWord,progress:a.vocabProgress,"is-last-word":a.isLastVocabWord,onShowDefinition:a.showVocabDefinition,onHideDefinition:a.hideVocabDefinition,onMarkLearned:a.markWordAsLearned,onNextWord:a.nextVocabWord,onPreviousWord:a.previousVocabWord,onSkip:a.skipVocabularyModal,onRestart:a.restartVocabulary,onClose:a.closeVocabularyModal,onPronounce:a.pronounceWord,onJumpToWord:a.jumpToVocabWord},null,8,["vocabulary-data","card-animation","current-word","progress","is-last-word","onShowDefinition","onHideDefinition","onMarkLearned","onNextWord","onPreviousWord","onSkip","onRestart","onClose","onPronounce","onJumpToWord"])):B("",!0),!a.started&&!a.showPaywallModal&&!a.loading&&!a.error?(r(),$e(c,{key:3,lesson:a.lesson,"estimated-time":a.estimatedTime,steps:a.steps,"previous-progress":a.previousProgress,onStart:a.startLesson,onContinue:a.continuePreviousProgress,onExit:a.confirmExit,onReportProblem:a.openProblemReportModal},null,8,["lesson","estimated-time","steps","previous-progress","onStart","onContinue","onExit","onReportProblem"])):a.started&&!a.showPaywallModal&&!a.loading&&!a.error?(r(),i("div",vp,[e("div",gp,[e("div",mp,[e("div",fp,[e("button",{onClick:t[14]||(t[14]=(...m)=>a.confirmExit&&a.confirmExit(...m)),class:"w-9 h-9 sm:w-10 sm:h-10 flex items-center justify-center rounded-lg bg-slate-100 text-slate-500 hover:bg-red-50 hover:text-red-500 transition-colors shrink-0","aria-label":"Exit lesson"},t[40]||(t[40]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),e("div",pp,[e("h2",hp,d(((k=a.lesson)==null?void 0:k.title)||"Lesson"),1),e("p",bp,d(((b=a.lesson)==null?void 0:b.subtitle)||""),1)]),e("div",yp,[e("div",xp,[e("div",{class:"h-full bg-linear-to-r from-indigo-500 to-blue-500 rounded-full transition-all duration-500",style:xe({width:a.progressPercentage+"%"})},null,4)]),e("span",wp,d(a.currentIndex+1)+"/"+d(a.steps.length),1)])]),e("div",kp,[e("div",_p,[t[41]||(t[41]=e("svg",{class:"w-4 h-4 text-amber-500",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z"})],-1)),e("span",Cp,d(a.consecutiveCorrect),1)]),e("div",$p,[t[42]||(t[42]=e("svg",{class:"w-4 h-4 text-indigo-500",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"})],-1)),e("span",Sp,d(a.earnedPoints),1)])])])]),e("div",{class:J(["split-content",{"is-game-active":a.isGameStep}]),ref:"splitContainer"},[e("div",{class:"split-panel content-side",style:xe(a.leftPanelStyle)},[Me(l,{"current-step":a.currentStep,"current-index":a.currentIndex,"is-interactive-step":a.isInteractiveStep,"is-game-step":a.isGameStep,"show-explanation-always":!0,"current-exercise":a.getCurrentExercise(a.currentStep),"current-quiz":a.getCurrentQuiz(a.currentStep),"exercise-index":a.currentExerciseIndex,"quiz-index":a.currentQuizIndex,"total-exercises":a.getTotalExercises(a.currentStep),"total-quizzes":a.getTotalQuizzes(a.currentStep),"show-explanation-help":a.showExplanationHelp,"explanation-question":a.explanationQuestion,"explanation-ai-response":a.explanationAIResponse,"is-loading-explanation":a.isLoadingExplanation,"is-last-step":a.isLastStep,onToggleExplanationHelp:a.toggleExplanationHelp,"onUpdate:explanationQuestion":t[15]||(t[15]=m=>a.explanationQuestion=m),onAskExplanation:a.askAboutExplanation,onInitVocabulary:a.initializeVocabularyModal,onPronounce:a.pronounceWord,onNext:a.goNext,onPrevious:a.goPrevious},null,8,["current-step","current-index","is-interactive-step","is-game-step","current-exercise","current-quiz","exercise-index","quiz-index","total-exercises","total-quizzes","show-explanation-help","explanation-question","explanation-ai-response","is-loading-explanation","is-last-step","onToggleExplanationHelp","onAskExplanation","onInitVocabulary","onPronounce","onNext","onPrevious"])],4),a.resizeDisabled?B("",!0):(r(),i("div",{key:0,class:J(["resize-handle",{"is-resizing":a.isResizing}]),onMousedown:t[16]||(t[16]=(...m)=>a.startResize&&a.startResize(...m)),onTouchstart:t[17]||(t[17]=(...m)=>a.startResize&&a.startResize(...m))},t[43]||(t[43]=[e("div",{class:"handle-bar"},null,-1)]),34)),e("div",{class:"split-panel interactive-side",style:xe(a.rightPanelStyle)},[a.isInteractiveStep||a.isGameStep?(r(),i("div",Ip,[(r(),$e(_,{key:((C=a.currentStep)==null?void 0:C.id)||((x=a.currentStep)==null?void 0:x._id)||a.currentIndex,"current-step":a.currentStep,"current-exercise":a.getCurrentExercise(a.currentStep),"current-quiz":a.getCurrentQuiz(a.currentStep),"exercise-index":a.currentExerciseIndex,"quiz-index":a.currentQuizIndex,"total-exercises":a.getTotalExercises(a.currentStep),"total-quizzes":a.getTotalQuizzes(a.currentStep),"user-answer":a.userAnswer,confirmation:a.confirmation,"answer-was-correct":a.answerWasCorrect,"current-hint":a.currentHint,"smart-hint":a.smartHint,"mistake-count":a.mistakeCount,"fill-blank-answers":a.fillBlankAnswers,"matching-pairs":a.matchingPairs,"selected-matching-item":a.selectedMatchingItem,"ordering-items":a.orderingItems,"drag-drop-placements":a.dragDropPlacements,"available-drag-items":a.availableDragItems,"drop-zones":a.dropZones,"attempt-count":a.attemptCount,"max-attempts":a.maxAttempts,"is-on-second-chance":a.isOnSecondChance,"show-correct-answer":a.showCorrectAnswer,"correct-answer-text":a.correctAnswerText,onAnswerChanged:a.handleAnswerChanged,onFillBlankUpdated:a.updateFillBlankAnswer,onSubmit:a.handleSubmitOrNext,onNextExercise:a.goToNextExercise,onNextQuiz:a.goToNextQuiz,onShowHint:a.showHint,onClearHint:a.clearSmartHint,onMatchingItemSelected:a.handleMatchingItemSelected,onRemoveMatchingPair:a.handleRemoveMatchingPair,onDragItemStart:a.handleDragItemStart,onDragOverZone:a.handleDragOverZone,onDragLeaveZone:a.handleDragLeaveZone,onDropInZone:a.handleDropInZone,onRemoveDroppedItem:a.handleRemoveDroppedItem},null,8,["current-step","current-exercise","current-quiz","exercise-index","quiz-index","total-exercises","total-quizzes","user-answer","confirmation","answer-was-correct","current-hint","smart-hint","mistake-count","fill-blank-answers","matching-pairs","selected-matching-item","ordering-items","drag-drop-placements","available-drag-items","drop-zones","attempt-count","max-attempts","is-on-second-chance","show-correct-answer","correct-answer-text","onAnswerChanged","onFillBlankUpdated","onSubmit","onNextExercise","onNextQuiz","onShowHint","onClearHint","onMatchingItemSelected","onRemoveMatchingPair","onDragItemStart","onDragOverZone","onDragLeaveZone","onDropInZone","onRemoveDroppedItem"]))])):B("",!0)],4)],2)])):B("",!0),a.lessonCompleted?(r(),$e(w,{key:5,lesson:a.lesson,"readable-time":a.readableTime,stars:a.stars,"mistake-count":a.mistakeCount,"earned-points":a.earnedPoints,"medal-label":a.medalLabel,"medal-icon":a.getMedalIcon(),"progress-insight":a.progressInsight,"total-steps":a.steps.length,"extraction-results":a.extractionResults,onReturnToCatalogue:a.handleReturnToCatalogue,onShare:a.shareResult,onHomework:a.handleGoToHomework,onVocabulary:a.goToVocabulary},{"extra-actions":Pe(()=>[e("button",{onClick:t[18]||(t[18]=(...m)=>a.openProblemReportModal&&a.openProblemReportModal(...m)),class:"w-full py-3 px-4 text-slate-500 hover:text-amber-600 font-medium rounded-xl hover:bg-amber-50 transition-colors flex items-center justify-center gap-2 text-sm"},t[44]||(t[44]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1),Se(" Report an issue with this lesson ")]))]),_:1},8,["lesson","readable-time","stars","mistake-count","earned-points","medal-label","medal-icon","progress-insight","total-steps","extraction-results","onReturnToCatalogue","onShare","onHomework","onVocabulary"])):B("",!0),(r(),$e(Lt,{to:"body"},[Me(Re,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 translate-y-full","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-full"},{default:Pe(()=>[a.showMigrationPanel?(r(),i("div",Ap,[e("div",Tp,[t[48]||(t[48]=e("div",{class:"px-5 py-4 border-b border-slate-100 bg-linear-to-r from-blue-50 to-indigo-50"},[e("div",{class:"flex items-center gap-3"},[e("div",{class:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})])]),e("h3",{class:"font-semibold text-slate-800"},"Content Update")])],-1)),e("div",Mp,[t[47]||(t[47]=e("p",{class:"text-sm text-slate-600 mb-4"},"Create assignments and vocabulary from completed lessons?",-1)),e("div",Lp,[e("button",{onClick:t[19]||(t[19]=(...m)=>a.migrateLessonContent&&a.migrateLessonContent(...m)),disabled:a.migrationLoading,class:"flex-1 py-2.5 px-4 bg-blue-600 text-white font-medium rounded-xl hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[a.migrationLoading?(r(),i("svg",Pp,t[46]||(t[46]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(r(),i("svg",Dp,t[45]||(t[45]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"},null,-1)]))),Se(" "+d(a.migrationLoading?"Processing...":"Update"),1)],8,Ep),e("button",{onClick:t[20]||(t[20]=(...m)=>a.closeMigrationPanel&&a.closeMigrationPanel(...m)),class:"py-2.5 px-4 text-slate-600 font-medium rounded-xl hover:bg-slate-100 transition-colors"}," Close ")])])])])):B("",!0)]),_:1})])),a.started&&!a.lessonCompleted?(r(),i("button",{key:6,onClick:t[21]||(t[21]=(...m)=>a.toggleFloatingAI&&a.toggleFloatingAI(...m)),class:J(["fixed bottom-6 right-6 w-14 h-14 rounded-full shadow-lg flex items-center justify-center text-2xl transition-all duration-200 hover:scale-110 hover:shadow-xl z-50",a.showFloatingAI?"bg-cyan-500 shadow-cyan-500/40":"bg-indigo-600 shadow-indigo-500/40"]),"aria-label":"AI Assistant"},t[49]||(t[49]=[e("svg",{class:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})],-1)]),2)):B("",!0),a.showFloatingAI&&a.started&&!a.lessonCompleted?(r(),$e(P,{key:7,"ai-usage":a.aiUsage,"quick-suggestions":a.quickSuggestions,"ai-chat-history":a.aiChatHistory,"floating-ai-input":a.floatingAIInput,"ai-is-loading":a.aiIsLoading,onClose:a.closeFloatingAI,onSendMessage:a.sendFloatingAIMessage,onAskAi:a.askAI,onClearChat:a.clearAIChat},null,8,["ai-usage","quick-suggestions","ai-chat-history","floating-ai-input","ai-is-loading","onClose","onSendMessage","onAskAi","onClearChat"])):B("",!0),a.showConfetti?(r(),i("canvas",Wp,null,512)):B("",!0)])}const qp=Ie(Of,[["render",jp],["__scopeId","data-v-f192632b"]]);export{qp as default};
